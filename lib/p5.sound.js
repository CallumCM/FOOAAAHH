(function(e){function t(o){if(n[o])return n[o].exports;var r=n[o]={i:o,l:!1,exports:{}};return e[o].call(r.exports,r,r.exports,t),r.l=!0,r.exports}var n={};return t.m=e,t.c=n,t.d=function(e,n,o){t.o(e,n)||Object.defineProperty(e,n,{enumerable:!0,get:o})},t.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},t.t=function(e,n){if(1&n&&(e=t(e)),8&n)return e;if(4&n&&"object"==typeof e&&e&&e.__esModule)return e;var o=Object.create(null);if(t.r(o),Object.defineProperty(o,"default",{enumerable:!0,value:e}),2&n&&"string"!=typeof e)for(var r in e)t.d(o,r,function(t){return e[t]}.bind(null,r));return o},t.n=function(e){var n=e&&e.__esModule?function(){return e["default"]}:function(){return e};return t.d(n,"a",n),n},t.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},t.p="",t(t.s=40)})([function(e,t,n){var o;o=function(){"use strict";function l(n,t){this.isUndef(n)||1===n?this.input=this.context.createGain():1<n&&(this.input=Array(n)),this.isUndef(t)||1===t?this.output=this.context.createGain():1<t&&(this.output=Array(n))}var n;return l.prototype.set=function(a,d,f){if(this.isObject(a))f=d;else if(this.isString(a)){var m={};m[a]=d,a=m}t:for(var o in a){d=a[o];var y=this;if(-1!==o.indexOf(".")){for(var h=o.split("."),s=0;s<h.length-1;s++)if((y=y[h[s]])instanceof l){h.splice(0,s+1);var _=h.join(".");y.set(_,d);continue t}o=h[h.length-1]}var p=y[o];this.isUndef(p)||(l.Signal&&p instanceof l.Signal||l.Param&&p instanceof l.Param?p.value!==d&&(this.isUndef(f)?p.value=d:p.rampTo(d,f)):p instanceof AudioParam?p.value!==d&&(p.value=d):p instanceof l?p.set(d):p!==d&&(y[o]=d))}return this},l.prototype.get=function(a){this.isUndef(a)?a=this._collectDefaults(this.constructor):this.isString(a)&&(a=[a]);for(var d={},e=0;e<a.length;e++){var f=a[e],m=this,y=d;if(-1!==f.indexOf(".")){for(var h=f.split("."),s=0,_;s<h.length-1;s++)_=h[s],y[_]=y[_]||{},y=y[_],m=m[_];f=h[h.length-1]}var g=m[f];this.isObject(a[f])?y[f]=g.get():l.Signal&&g instanceof l.Signal?y[f]=g.value:l.Param&&g instanceof l.Param?y[f]=g.value:g instanceof AudioParam?y[f]=g.value:g instanceof l?y[f]=g.get():this.isFunction(g)||this.isUndef(g)||(y[f]=g)}return d},l.prototype._collectDefaults=function(r){var t=[];if(this.isUndef(r.defaults)||(t=Object.keys(r.defaults)),!this.isUndef(r._super))for(var a=this._collectDefaults(r._super),n=0;n<a.length;n++)-1===t.indexOf(a[n])&&t.push(a[n]);return t},l.prototype.toString=function(){for(var o in l){var t=o[0].match(/^[A-Z]$/),e=l[o]===this.constructor;if(this.isFunction(l[o])&&t&&e)return o}return"Tone"},Object.defineProperty(l.prototype,"numberOfInputs",{get:function(){return this.input?this.isArray(this.input)?this.input.length:1:0}}),Object.defineProperty(l.prototype,"numberOfOutputs",{get:function(){return this.output?this.isArray(this.output)?this.output.length:1:0}}),l.prototype.dispose=function(){return this.isUndef(this.input)||(this.input instanceof AudioNode&&this.input.disconnect(),this.input=null),this.isUndef(this.output)||(this.output instanceof AudioNode&&this.output.disconnect(),this.output=null),this},l.prototype.connect=function(o,t,r){return Array.isArray(this.output)?(t=this.defaultArg(t,0),this.output[t].connect(o,0,r)):this.output.connect(o,t,r),this},l.prototype.disconnect=function(o,t,r){this.isArray(this.output)?this.isNumber(o)?this.output[o].disconnect():(t=this.defaultArg(t,0),this.output[t].disconnect(o,0,r)):this.output.disconnect.apply(this.output,arguments)},l.prototype.connectSeries=function(){if(1<arguments.length)for(var o=arguments[0],r=1,a;r<arguments.length;r++)a=arguments[r],o.connect(a),o=a;return this},l.prototype.chain=function(){if(0<arguments.length)for(var o=this,r=0,a;r<arguments.length;r++)a=arguments[r],o.connect(a),o=a;return this},l.prototype.fan=function(){if(0<arguments.length)for(var e=0;e<arguments.length;e++)this.connect(arguments[e]);return this},AudioNode.prototype.chain=l.prototype.chain,AudioNode.prototype.fan=l.prototype.fan,l.prototype.defaultArg=function(r,t){if(this.isObject(r)&&this.isObject(t)){var e={};for(var n in r)e[n]=this.defaultArg(t[n],r[n]);for(var o in t)e[o]=this.defaultArg(r[o],t[o]);return e}return this.isUndef(r)?t:r},l.prototype.optionsObject=function(r,t,e){var n={};if(1===r.length&&this.isObject(r[0]))n=r[0];else for(var a=0;a<t.length;a++)n[t[a]]=r[a];return this.isUndef(e)?n:this.defaultArg(n,e)},l.prototype.isUndef=function(e){return void 0===e},l.prototype.isFunction=function(e){return"function"==typeof e},l.prototype.isNumber=function(e){return"number"==typeof e},l.prototype.isObject=function(e){return"[object Object]"===Object.prototype.toString.call(e)&&e.constructor===Object},l.prototype.isBoolean=function(e){return"boolean"==typeof e},l.prototype.isArray=function(e){return Array.isArray(e)},l.prototype.isString=function(e){return"string"==typeof e},l.noOp=function(){},l.prototype._readOnly=function(n){if(Array.isArray(n))for(var t=0;t<n.length;t++)this._readOnly(n[t]);else Object.defineProperty(this,n,{writable:!1,enumerable:!0})},l.prototype._writable=function(n){if(Array.isArray(n))for(var t=0;t<n.length;t++)this._writable(n[t]);else Object.defineProperty(this,n,{writable:!0})},l.State={Started:"started",Stopped:"stopped",Paused:"paused"},l.prototype.equalPowerScale=function(n){var t=.5*Math.PI;return Math.sin(n*t)},l.prototype.dbToGain=function(e){return Math.pow(2,e/6)},l.prototype.gainToDb=function(e){return 20*(Math.log(e)/Math.LN10)},l.prototype.intervalToFrequencyRatio=function(e){return Math.pow(2,e/12)},l.prototype.now=function(){return l.context.now()},l.now=function(){return l.context.now()},l.extend=function(o,t){function r(){}l.prototype.isUndef(t)&&(t=l),r.prototype=t.prototype,o.prototype=new r,(o.prototype.constructor=o)._super=t},Object.defineProperty(l,"context",{get:function(){return n},set:function(e){n=l.Context&&e instanceof l.Context?e:new l.Context(e),l.Context&&l.Context.emit("init",n)}}),Object.defineProperty(l.prototype,"context",{get:function(){return l.context}}),l.setContext=function(e){l.context=e},Object.defineProperty(l.prototype,"blockTime",{get:function(){return 128/this.context.sampleRate}}),Object.defineProperty(l.prototype,"sampleTime",{get:function(){return 1/this.context.sampleRate}}),Object.defineProperty(l,"supported",{get:function(){var o=window.hasOwnProperty("AudioContext")||window.hasOwnProperty("webkitAudioContext"),t=window.hasOwnProperty("Promise"),e=window.hasOwnProperty("Worker");return o&&t&&e}}),l.version="r10",window.TONE_SILENCE_VERSION_LOGGING||console.log("%c * Tone.js "+l.version+" * ","background: #000; color: #fff"),l}.call(t,n,t,e),!(o!==void 0&&(e.exports=o))},function(e,t,n){var o,r;o=[n(0),n(2),n(10)],r=function(e){"use strict";return e.Multiply=function(n){this.createInsOuts(2,0),this._mult=this.input[0]=this.output=new e.Gain,this._param=this.input[1]=this.output.gain,this._param.value=this.defaultArg(n,0)},e.extend(e.Multiply,e.Signal),e.Multiply.prototype.dispose=function(){return e.prototype.dispose.call(this),this._mult.dispose(),this._mult=null,this._param=null,this},e.Multiply}.apply(t,o),!(r!==void 0&&(e.exports=r))},function(e,t,n){var o,r;o=[n(0),n(6),n(9),n(18),n(10)],r=function(e){"use strict";return e.Signal=function(){var n=this.optionsObject(arguments,["value","units"],e.Signal.defaults);this.output=this._gain=this.context.createGain(),n.param=this._gain.gain,e.Param.call(this,n),this.input=this._param=this._gain.gain,this.context.getConstant(1).chain(this._gain)},e.extend(e.Signal,e.Param),e.Signal.defaults={value:0,units:e.Type.Default,convert:!0},e.Signal.prototype.connect=e.SignalBase.prototype.connect,e.Signal.prototype.dispose=function(){return e.Param.prototype.dispose.call(this),this._param=null,this._gain.disconnect(),this._gain=null,this},e.Signal}.apply(t,o),!(r!==void 0&&(e.exports=r))},function(e,t,n){"use strict";(function(e){function o(){return c}function r(e,t){var n=e;return e instanceof p5.Element?n=e.elt:e instanceof Array&&e[0]instanceof p5.Element&&(n=e.map(function(t){return t.elt})),i()(c,n,t)}n.d(t,"b",function(){return o}),n.d(t,"c",function(){return r});var a=n(22),i=n.n(a),s=n(0),u=n.n(s),l=n(12),p=n.n(l);e.TONE_SILENCE_VERSION_LOGGING=!0;var c=new window.AudioContext;u.a.setContext(c),t.a=c}).call(this,n(26))},function(e,t,n){var o,r;o=[n(0),n(2),n(10)],r=function(e){"use strict";return e.Add=function(n){this.createInsOuts(2,0),this._sum=this.input[0]=this.input[1]=this.output=new e.Gain,this._param=this.input[1]=new e.Signal(n),this._param.connect(this._sum)},e.extend(e.Add,e.Signal),e.Add.prototype.dispose=function(){return e.prototype.dispose.call(this),this._sum.dispose(),this._sum=null,this._param.dispose(),this._param=null,this},e.Add}.apply(t,o),!(r!==void 0&&(e.exports=r))},function(e){e.exports={recorderProcessor:"recorder-processor",soundFileProcessor:"sound-file-processor",amplitudeProcessor:"amplitude-processor"}},function(e,t,n){var o,r;o=[n(0),n(15)],r=function(t){"use strict";return t.WaveShaper=function(n,e){this._shaper=this.input=this.output=this.context.createWaveShaper(),this._curve=null,Array.isArray(n)?this.curve=n:isFinite(n)||this.isUndef(n)?this._curve=new Float32Array(this.defaultArg(n,1024)):this.isFunction(n)&&(this._curve=new Float32Array(this.defaultArg(e,1024)),this.setMap(n))},t.extend(t.WaveShaper,t.SignalBase),t.WaveShaper.prototype.setMap=function(n){for(var e=0,o=this._curve.length,r;e<o;e++)r=2*(e/(o-1))-1,this._curve[e]=n(r,e);return this._shaper.curve=this._curve,this},Object.defineProperty(t.WaveShaper.prototype,"curve",{get:function(){return this._shaper.curve},set:function(t){this._curve=new Float32Array(t),this._shaper.curve=this._curve}}),Object.defineProperty(t.WaveShaper.prototype,"oversample",{get:function(){return this._shaper.oversample},set:function(t){if(-1===["none","2x","4x"].indexOf(t))throw new RangeError("Tone.WaveShaper: oversampling must be either 'none', '2x', or '4x'");this._shaper.oversample=t}}),t.WaveShaper.prototype.dispose=function(){return t.prototype.dispose.call(this),this._shaper.disconnect(),this._shaper=null,this._curve=null,this},t.WaveShaper}.apply(t,o),!(r!==void 0&&(e.exports=r))},function(e,t,n){var o,r;o=[n(0),n(2),n(19)],r=function(u){"use strict";return u.TimelineSignal=function(){var t=this.optionsObject(arguments,["value","units"],u.Signal.defaults);this._events=new u.Timeline(10),u.Signal.apply(this,t),t.param=this._param,u.Param.call(this,t),this._initial=this._fromUnits(this._param.value)},u.extend(u.TimelineSignal,u.Param),u.TimelineSignal.Type={Linear:"linear",Exponential:"exponential",Target:"target",Curve:"curve",Set:"set"},Object.defineProperty(u.TimelineSignal.prototype,"value",{get:function(){var n=this.now(),e=this.getValueAtTime(n);return this._toUnits(e)},set:function(n){var e=this._fromUnits(n);this._initial=e,this.cancelScheduledValues(),this._param.value=e}}),u.TimelineSignal.prototype.setValueAtTime=function(n,o){return n=this._fromUnits(n),o=this.toSeconds(o),this._events.add({type:u.TimelineSignal.Type.Set,value:n,time:o}),this._param.setValueAtTime(n,o),this},u.TimelineSignal.prototype.linearRampToValueAtTime=function(n,o){return n=this._fromUnits(n),o=this.toSeconds(o),this._events.add({type:u.TimelineSignal.Type.Linear,value:n,time:o}),this._param.linearRampToValueAtTime(n,o),this},u.TimelineSignal.prototype.exponentialRampToValueAtTime=function(o,r){r=this.toSeconds(r);var a=this._searchBefore(r);a&&0===a.value&&this.setValueAtTime(this._minOutput,a.time),o=this._fromUnits(o);var i=Math.max(o,this._minOutput);return this._events.add({type:u.TimelineSignal.Type.Exponential,value:i,time:r}),o<this._minOutput?(this._param.exponentialRampToValueAtTime(this._minOutput,r-this.sampleTime),this.setValueAtTime(0,r)):this._param.exponentialRampToValueAtTime(o,r),this},u.TimelineSignal.prototype.setTargetAtTime=function(n,o,r){return n=this._fromUnits(n),n=Math.max(this._minOutput,n),r=Math.max(this._minOutput,r),o=this.toSeconds(o),this._events.add({type:u.TimelineSignal.Type.Target,value:n,time:o,constant:r}),this._param.setTargetAtTime(n,o,r),this},u.TimelineSignal.prototype.setValueCurveAtTime=function(o,e,p,c){c=this.defaultArg(c,1);for(var d=Array(o.length),a=0;a<d.length;a++)d[a]=this._fromUnits(o[a])*c;e=this.toSeconds(e),p=this.toSeconds(p),this._events.add({type:u.TimelineSignal.Type.Curve,value:d,time:e,duration:p}),this._param.setValueAtTime(d[0],e);for(var f=1,m;f<d.length;f++)m=e+f/(d.length-1)*p,this._param.linearRampToValueAtTime(d[f],m);return this},u.TimelineSignal.prototype.cancelScheduledValues=function(t){return t=this.toSeconds(t),this._events.cancel(t),this._param.cancelScheduledValues(t),this},u.TimelineSignal.prototype.setRampPoint=function(o){o=this.toSeconds(o);var r=this._toUnits(this.getValueAtTime(o)),t=this._searchBefore(o);if(t&&t.time===o)this.cancelScheduledValues(o+this.sampleTime);else if(t&&t.type===u.TimelineSignal.Type.Curve&&t.time+t.duration>o)this.cancelScheduledValues(o),this.linearRampToValueAtTime(r,o);else{var a=this._searchAfter(o);a&&(this.cancelScheduledValues(o),a.type===u.TimelineSignal.Type.Linear?this.linearRampToValueAtTime(r,o):a.type===u.TimelineSignal.Type.Exponential&&this.exponentialRampToValueAtTime(r,o)),this.setValueAtTime(r,o)}return this},u.TimelineSignal.prototype.linearRampToValueBetween=function(n,e,t){return this.setRampPoint(e),this.linearRampToValueAtTime(n,t),this},u.TimelineSignal.prototype.exponentialRampToValueBetween=function(n,e,t){return this.setRampPoint(e),this.exponentialRampToValueAtTime(n,t),this},u.TimelineSignal.prototype._searchBefore=function(t){return this._events.get(t)},u.TimelineSignal.prototype._searchAfter=function(t){return this._events.getAfter(t)},u.TimelineSignal.prototype.getValueAtTime=function(o){o=this.toSeconds(o);var r=this._searchAfter(o),t=this._searchBefore(o),i=this._initial;if(null===t)i=this._initial;else if(t.type===u.TimelineSignal.Type.Target){var s=this._events.getBefore(t.time),l;l=null===s?this._initial:s.value,i=this._exponentialApproach(t.time,l,t.value,t.constant,o)}else i=t.type===u.TimelineSignal.Type.Curve?this._curveInterpolate(t.time,t.value,t.duration,o):null===r?t.value:r.type===u.TimelineSignal.Type.Linear?this._linearInterpolate(t.time,t.value,r.time,r.value,o):r.type===u.TimelineSignal.Type.Exponential?this._exponentialInterpolate(t.time,t.value,r.time,r.value,o):t.value;return i},u.TimelineSignal.prototype.connect=u.SignalBase.prototype.connect,u.TimelineSignal.prototype._exponentialApproach=function(o,e,t,r,n){return t+(e-t)*Math.exp(-(n-o)/r)},u.TimelineSignal.prototype._linearInterpolate=function(o,e,t,r,n){return e+(n-o)/(t-o)*(r-e)},u.TimelineSignal.prototype._exponentialInterpolate=function(o,e,r,i,n){return(e=Math.max(this._minOutput,e))*Math.pow(i/e,(n-o)/(r-o))},u.TimelineSignal.prototype._curveInterpolate=function(u,e,t,i){var n=e.length;if(u+t<=i)return e[n-1];if(i<=u)return e[0];var a=(i-u)/t,l=Math.floor((n-1)*a),s=Math.ceil((n-1)*a),r=e[l],o=e[s];return s===l?r:this._linearInterpolate(l,r,s,o,a*(n-1))},u.TimelineSignal.prototype.dispose=function(){u.Signal.prototype.dispose.call(this),u.Param.prototype.dispose.call(this),this._events.dispose(),this._events=null},u.TimelineSignal}.apply(t,o),!(r!==void 0&&(e.exports=r))},function(e,t,n){var o,r;o=[n(0),n(4),n(1),n(2)],r=function(n){"use strict";return n.Scale=function(o,t){this._outputMin=this.defaultArg(o,0),this._outputMax=this.defaultArg(t,1),this._scale=this.input=new n.Multiply(1),this._add=this.output=new n.Add(0),this._scale.connect(this._add),this._setRange()},n.extend(n.Scale,n.SignalBase),Object.defineProperty(n.Scale.prototype,"min",{get:function(){return this._outputMin},set:function(e){this._outputMin=e,this._setRange()}}),Object.defineProperty(n.Scale.prototype,"max",{get:function(){return this._outputMax},set:function(e){this._outputMax=e,this._setRange()}}),n.Scale.prototype._setRange=function(){this._add.value=this._outputMin,this._scale.value=this._outputMax-this._outputMin},n.Scale.prototype.dispose=function(){return n.prototype.dispose.call(this),this._add.dispose(),this._add=null,this._scale.dispose(),this._scale=null,this},n.Scale}.apply(t,o),!(r!==void 0&&(e.exports=r))},function(e,t,n){var o,r;o=[n(0),n(16),n(30),n(31),n(12)],r=function(n){return n.Type={Default:"number",Time:"time",Frequency:"frequency",TransportTime:"transportTime",Ticks:"ticks",NormalRange:"normalRange",AudioRange:"audioRange",Decibels:"db",Interval:"interval",BPM:"bpm",Positive:"positive",Cents:"cents",Degrees:"degrees",MIDI:"midi",BarsBeatsSixteenths:"barsBeatsSixteenths",Samples:"samples",Hertz:"hertz",Note:"note",Milliseconds:"milliseconds",Seconds:"seconds",Notation:"notation"},n.prototype.toSeconds=function(t){return this.isNumber(t)?t:this.isUndef(t)?this.now():this.isString(t)?new n.Time(t).toSeconds():t instanceof n.TimeBase?t.toSeconds():void 0},n.prototype.toFrequency=function(t){return this.isNumber(t)?t:this.isString(t)||this.isUndef(t)?new n.Frequency(t).valueOf():t instanceof n.TimeBase?t.toFrequency():void 0},n.prototype.toTicks=function(t){return this.isNumber(t)||this.isString(t)?new n.TransportTime(t).toTicks():this.isUndef(t)?n.Transport.ticks:t instanceof n.TimeBase?t.toTicks():void 0},n}.apply(t,o),!(r!==void 0&&(e.exports=r))},function(e,t,n){var o,r;o=[n(0),n(18),n(9)],r=function(e){"use strict";return window.GainNode&&!AudioContext.prototype.createGain&&(AudioContext.prototype.createGain=AudioContext.prototype.createGainNode),e.Gain=function(){var n=this.optionsObject(arguments,["gain","units"],e.Gain.defaults);this.input=this.output=this._gainNode=this.context.createGain(),this.gain=new e.Param({param:this._gainNode.gain,units:n.units,value:n.gain,convert:n.convert}),this._readOnly("gain")},e.extend(e.Gain),e.Gain.defaults={gain:1,convert:!0},e.Gain.prototype.dispose=function(){e.Param.prototype.dispose.call(this),this._gainNode.disconnect(),this._gainNode=null,this._writable("gain"),this.gain.dispose(),this.gain=null},e.prototype.createInsOuts=function(o,t){1===o?this.input=new e.Gain:1<o&&(this.input=Array(o)),1===t?this.output=new e.Gain:1<t&&(this.output=Array(o))},e.Gain}.apply(t,o),!(r!==void 0&&(e.exports=r))},function(e,t,n){var o,r;o=[n(0),n(7),n(39),n(14),n(12)],r=function(n){"use strict";return n.Clock=function(){n.Emitter.call(this);var e=this.optionsObject(arguments,["callback","frequency"],n.Clock.defaults);this.callback=e.callback,this._nextTick=0,this._lastState=n.State.Stopped,this.frequency=new n.TimelineSignal(e.frequency,n.Type.Frequency),this._readOnly("frequency"),this.ticks=0,this._state=new n.TimelineState(n.State.Stopped),this._boundLoop=this._loop.bind(this),this.context.on("tick",this._boundLoop)},n.extend(n.Clock,n.Emitter),n.Clock.defaults={callback:n.noOp,frequency:1,lookAhead:"auto"},Object.defineProperty(n.Clock.prototype,"state",{get:function(){return this._state.getValueAtTime(this.now())}}),n.Clock.prototype.start=function(o,r){return o=this.toSeconds(o),this._state.getValueAtTime(o)!==n.State.Started&&this._state.add({state:n.State.Started,time:o,offset:r}),this},n.Clock.prototype.stop=function(e){return e=this.toSeconds(e),this._state.cancel(e),this._state.setStateAtTime(n.State.Stopped,e),this},n.Clock.prototype.pause=function(e){return e=this.toSeconds(e),this._state.getValueAtTime(e)===n.State.Started&&this._state.setStateAtTime(n.State.Paused,e),this},n.Clock.prototype._loop=function(){for(var o=this.now()+this.context.lookAhead+this.context.updateInterval+2*this.context.lag,t;o>this._nextTick&&this._state;){if(t=this._state.getValueAtTime(this._nextTick),t!==this._lastState){this._lastState=t;var r=this._state.get(this._nextTick);t===n.State.Started?(this._nextTick=r.time,this.isUndef(r.offset)||(this.ticks=r.offset),this.emit("start",r.time,this.ticks)):t===n.State.Stopped?(this.ticks=0,this.emit("stop",r.time)):t===n.State.Paused&&this.emit("pause",r.time)}var a=this._nextTick;this.frequency&&(this._nextTick+=1/this.frequency.getValueAtTime(this._nextTick),t===n.State.Started&&(this.callback(a),this.ticks++))}},n.Clock.prototype.getStateAtTime=function(e){return e=this.toSeconds(e),this._state.getValueAtTime(e)},n.Clock.prototype.dispose=function(){n.Emitter.prototype.dispose.call(this),this.context.off("tick",this._boundLoop),this._writable("frequency"),this.frequency.dispose(),this.frequency=null,this._boundLoop=null,this._nextTick=1/0,this.callback=null,this._state.dispose(),this._state=null},n.Clock}.apply(t,o),!(r!==void 0&&(e.exports=r))},function(e,t,n){var o,r;o=[n(0),n(14)],r=function(a){function e(r,e,t){if(r.input)Array.isArray(r.input)?(a.prototype.isUndef(t)&&(t=0),this.connect(r.input[t])):this.connect(r.input,e,t);else try{r instanceof AudioNode?o.call(this,r,e,t):o.call(this,r,e)}catch(e){throw new Error("error connecting to node: "+r+"\n"+e)}}var o,t;return!window.hasOwnProperty("AudioContext")&&window.hasOwnProperty("webkitAudioContext")&&(window.AudioContext=window.webkitAudioContext),a.Context=function(n){for(var o in a.Emitter.call(this),n=n||new window.AudioContext,this._context=n,this._context)this._defineProperty(this._context,o);this._latencyHint="interactive",this._lookAhead=.1,this._updateInterval=this._lookAhead/3,this._computedUpdateInterval=0,this._worker=this._createWorker(),this._constants={}},a.extend(a.Context,a.Emitter),a.Emitter.mixin(a.Context),a.Context.prototype._defineProperty=function(o,e){this.isUndef(this[e])&&Object.defineProperty(this,e,{get:function(){return"function"==typeof o[e]?o[e].bind(o):o[e]},set:function(n){o[e]=n}})},a.Context.prototype.now=function(){return this._context.currentTime},a.Context.prototype._createWorker=function(){window.URL=window.URL||window.webkitURL;var o=new Blob(["var timeoutTime = "+(1e3*this._updateInterval).toFixed(1)+";self.onmessage = function(msg){\ttimeoutTime = parseInt(msg.data);};function tick(){\tsetTimeout(tick, timeoutTime);\tself.postMessage('tick');}tick();"]),t=URL.createObjectURL(o),e=new Worker(t);return e.addEventListener("message",function(){this.emit("tick")}.bind(this)),e.addEventListener("message",function(){var n=this.now();if(this.isNumber(this._lastUpdate)){var t=n-this._lastUpdate;this._computedUpdateInterval=Math.max(t,.97*this._computedUpdateInterval)}this._lastUpdate=n}.bind(this)),e},a.Context.prototype.getConstant=function(r){if(this._constants[r])return this._constants[r];for(var t=this._context.createBuffer(1,128,this._context.sampleRate),e=t.getChannelData(0),n=0;n<e.length;n++)e[n]=r;var a=this._context.createBufferSource();return a.channelCount=1,a.channelCountMode="explicit",a.buffer=t,a.loop=!0,a.start(0),this._constants[r]=a},Object.defineProperty(a.Context.prototype,"lag",{get:function(){var e=this._computedUpdateInterval-this._updateInterval;return e=Math.max(e,0)}}),Object.defineProperty(a.Context.prototype,"lookAhead",{get:function(){return this._lookAhead},set:function(e){this._lookAhead=e}}),Object.defineProperty(a.Context.prototype,"updateInterval",{get:function(){return this._updateInterval},set:function(e){this._updateInterval=Math.max(e,a.prototype.blockTime),this._worker.postMessage(Math.max(1e3*e,1))}}),Object.defineProperty(a.Context.prototype,"latencyHint",{get:function(){return this._latencyHint},set:function(n){var t=n;(this._latencyHint=n,this.isString(n))&&("interactive"===n?(t=.1,this._context.latencyHint=n):"playback"===n?(t=.8,this._context.latencyHint=n):"balanced"===n?(t=.25,this._context.latencyHint=n):"fastest"===n?t=.01:void 0);this.lookAhead=t,this.updateInterval=t/3}}),a.supported?(o=AudioNode.prototype.connect,t=AudioNode.prototype.disconnect,AudioNode.prototype.connect!==e&&(AudioNode.prototype.connect=e,AudioNode.prototype.disconnect=function(o,e,r){if(o&&o.input&&Array.isArray(o.input))a.prototype.isUndef(r)&&(r=0),this.disconnect(o.input[r],e,r);else if(o&&o.input)this.disconnect(o.input,e,r);else try{t.apply(this,arguments)}catch(e){throw new Error("error disconnecting node: "+o+"\n"+e)}}),a.context=new a.Context):console.warn("This browser does not support Tone.js"),a.Context}.apply(t,o),!(r!==void 0&&(e.exports=r))},function(e,t,n){var o,r;o=[n(0),n(4),n(20),n(2),n(10)],r=function(e){"use strict";return e.Subtract=function(n){this.createInsOuts(2,0),this._sum=this.input[0]=this.output=new e.Gain,this._neg=new e.Negate,this._param=this.input[1]=new e.Signal(n),this._param.chain(this._neg,this._sum)},e.extend(e.Subtract,e.Signal),e.Subtract.prototype.dispose=function(){return e.prototype.dispose.call(this),this._neg.dispose(),this._neg=null,this._sum.disconnect(),this._sum=null,this._param.dispose(),this._param=null,this},e.Subtract}.apply(t,o),!(r!==void 0&&(e.exports=r))},function(e,t,n){var o,r;o=[n(0)],r=function(a){"use strict";return a.Emitter=function(){this._events={}},a.extend(a.Emitter),a.Emitter.prototype.on=function(o,t){for(var e=o.split(/\W+/),a=0,i;a<e.length;a++)i=e[a],this._events.hasOwnProperty(i)||(this._events[i]=[]),this._events[i].push(t);return this},a.Emitter.prototype.off=function(o,u){for(var e=o.split(/\W+/),i=0;i<e.length;i++)if(o=e[i],this._events.hasOwnProperty(o))if(a.prototype.isUndef(u))this._events[o]=[];else for(var l=this._events[o],n=0;n<l.length;n++)l[n]===u&&l.splice(n,1);return this},a.Emitter.prototype.emit=function(o){if(this._events){var t=Array.apply(null,arguments).slice(1);if(this._events.hasOwnProperty(o))for(var e=this._events[o],a=0,i=e.length;a<i;a++)e[a].apply(this,t)}return this},a.Emitter.mixin=function(o){var t=["on","off","emit"];o._events={};for(var e=0;e<t.length;e++){var s=t[e],r=a.Emitter.prototype[s];o[s]=r}},a.Emitter.prototype.dispose=function(){return a.prototype.dispose.call(this),this._events=null,this},a.Emitter}.apply(t,o),!(r!==void 0&&(e.exports=r))},function(e,t,n){var o,r;o=[n(0)],r=function(t){"use strict";return t.SignalBase=function(){},t.extend(t.SignalBase),t.SignalBase.prototype.connect=function(o,e,n){return t.Signal&&t.Signal===o.constructor||t.Param&&t.Param===o.constructor||t.TimelineSignal&&t.TimelineSignal===o.constructor?(o._param.cancelScheduledValues(0),o._param.value=0,o.overridden=!0):o instanceof AudioParam&&(o.cancelScheduledValues(0),o.value=0),t.prototype.connect.call(this,o,e,n),this},t.SignalBase}.apply(t,o),!(r!==void 0&&(e.exports=r))},function(e,t,n){var o,r;o=[n(0),n(17)],r=function(n){return n.Time=function(o,t){return this instanceof n.Time?void(this._plusNow=!1,n.TimeBase.call(this,o,t)):new n.Time(o,t)},n.extend(n.Time,n.TimeBase),n.Time.prototype._unaryExpressions=Object.create(n.TimeBase.prototype._unaryExpressions),n.Time.prototype._unaryExpressions.quantize={regexp:/^@/,method:function(e){return n.Transport.nextSubdivision(e())}},n.Time.prototype._unaryExpressions.now={regexp:/^\+/,method:function(e){return this._plusNow=!0,e()}},n.Time.prototype.quantize=function(n,t){return t=this.defaultArg(t,1),this._expr=function(n,r,a){return n=n(),r=r.toSeconds(),n+(Math.round(n/r)*r-n)*a}.bind(this,this._expr,new this.constructor(n),t),this},n.Time.prototype.addNow=function(){return this._plusNow=!0,this},n.Time.prototype._defaultExpr=function(){return this._plusNow=!0,this._noOp},n.Time.prototype.copy=function(e){return n.TimeBase.prototype.copy.call(this,e),this._plusNow=e._plusNow,this},n.Time.prototype.toNotation=function(){var n=this.toSeconds(),t=this._toNotationHelper(n,["1m","2n","4n","8n","16n","32n","64n","128n"]),e=this._toNotationHelper(n,["1m","2n","2t","4n","4t","8n","8t","16n","16t","32n","32t","64n","64t","128n"]);return e.split("+").length<t.split("+").length?e:t},n.Time.prototype._toNotationHelper=function(a,u){for(var e=this._notationToUnits(u[u.length-1]),o="",l=0;l<u.length;l++){var p=this._notationToUnits(u[l]),r=a/p;if(1e-6>1-r%1&&(r+=1e-6),0<(r=Math.floor(r))){if(o+=1===r?u[l]:r.toString()+"*"+u[l],(a-=r*p)<e)break;o+=" + "}}return""===o&&(o="0"),o},n.Time.prototype._notationToUnits=function(a){for(var t=this._primaryExpressions,e=[t.n,t.t,t.m],o=0;o<e.length;o++){var s=e[o],i=a.match(s.regexp);if(i)return s.method.call(this,i[1])}},n.Time.prototype.toBarsBeatsSixteenths=function(){var r=this._beatsToUnits(1),t=this.toSeconds()/r,a=Math.floor(t/this._timeSignature()),o=4*(t%1);return t=Math.floor(t)%this._timeSignature(),3<(o=o.toString()).length&&(o=parseFloat(o).toFixed(3)),[a,t,o].join(":")},n.Time.prototype.toTicks=function(){var o=this._beatsToUnits(1),t=this.valueOf()/o;return Math.floor(t*n.Transport.PPQ)},n.Time.prototype.toSamples=function(){return this.toSeconds()*this.context.sampleRate},n.Time.prototype.toFrequency=function(){return 1/this.toSeconds()},n.Time.prototype.toSeconds=function(){return this.valueOf()},n.Time.prototype.toMilliseconds=function(){return 1e3*this.toSeconds()},n.Time.prototype.valueOf=function(){return this._expr()+(this._plusNow?this.now():0)},n.Time}.apply(t,o),!(r!==void 0&&(e.exports=r))},function(e,t,n){var o,r;o=[n(0)],r=function(o){return o.TimeBase=function(n,e){if(!(this instanceof o.TimeBase))return new o.TimeBase(n,e);if(this._expr=this._noOp,n instanceof o.TimeBase)this.copy(n);else if(!this.isUndef(e)||this.isNumber(n)){e=this.defaultArg(e,this._defaultUnits);var a=this._primaryExpressions[e].method;this._expr=a.bind(this,n)}else this.isString(n)?this.set(n):this.isUndef(n)&&(this._expr=this._defaultExpr())},o.extend(o.TimeBase),o.TimeBase.prototype.set=function(t){return this._expr=this._parseExprString(t),this},o.TimeBase.prototype.clone=function(){var t=new this.constructor;return t.copy(this),t},o.TimeBase.prototype.copy=function(n){var e=n._expr();return this.set(e)},o.TimeBase.prototype._primaryExpressions={n:{regexp:/^(\d+)n/i,method:function(t){return 1===(t=parseInt(t))?this._beatsToUnits(this._timeSignature()):this._beatsToUnits(4/t)}},t:{regexp:/^(\d+)t/i,method:function(t){return t=parseInt(t),this._beatsToUnits(8/(3*parseInt(t)))}},m:{regexp:/^(\d+)m/i,method:function(t){return this._beatsToUnits(parseInt(t)*this._timeSignature())}},i:{regexp:/^(\d+)i/i,method:function(t){return this._ticksToUnits(parseInt(t))}},hz:{regexp:/^(\d+(?:\.\d+)?)hz/i,method:function(t){return this._frequencyToUnits(parseFloat(t))}},tr:{regexp:/^(\d+(?:\.\d+)?):(\d+(?:\.\d+)?):?(\d+(?:\.\d+)?)?/,method:function(o,e,t){var r=0;return o&&"0"!==o&&(r+=this._beatsToUnits(this._timeSignature()*parseFloat(o))),e&&"0"!==e&&(r+=this._beatsToUnits(parseFloat(e))),t&&"0"!==t&&(r+=this._beatsToUnits(parseFloat(t)/4)),r}},s:{regexp:/^(\d+(?:\.\d+)?s)/,method:function(t){return this._secondsToUnits(parseFloat(t))}},samples:{regexp:/^(\d+)samples/,method:function(t){return parseInt(t)/this.context.sampleRate}},default:{regexp:/^(\d+(?:\.\d+)?)/,method:function(t){return this._primaryExpressions[this._defaultUnits].method.call(this,t)}}},o.TimeBase.prototype._binaryExpressions={"+":{regexp:/^\+/,precedence:2,method:function(n,e){return n()+e()}},"-":{regexp:/^\-/,precedence:2,method:function(n,e){return n()-e()}},"*":{regexp:/^\*/,precedence:1,method:function(n,e){return n()*e()}},"/":{regexp:/^\//,precedence:1,method:function(n,e){return n()/e()}}},o.TimeBase.prototype._unaryExpressions={neg:{regexp:/^\-/,method:function(t){return-t()}}},o.TimeBase.prototype._syntaxGlue={"(":{regexp:/^\(/},")":{regexp:/^\)/}},o.TimeBase.prototype._tokenize=function(o){function a(u,e){for(var t=["_binaryExpressions","_unaryExpressions","_primaryExpressions","_syntaxGlue"],r=0,l;r<t.length;r++)for(var c in l=e[t[r]],l){var s=l[c],o=s.regexp,p=u.match(o);if(null!==p)return{method:s.method,precedence:s.precedence,regexp:s.regexp,value:p[0]}}throw new SyntaxError("Tone.TimeBase: Unexpected token "+u)}for(var i=-1,s=[],r;0<o.length;)r=a(o=o.trim(),this),s.push(r),o=o.substr(r.value.length);return{next:function(){return s[++i]},peek:function(){return s[i+1]}}},o.TimeBase.prototype._matchGroup=function(o,e,t){if(!this.isUndef(o))for(var r in e){var n=e[r];if(n.regexp.test(o.value)){if(this.isUndef(t))return n;if(n.precedence===t)return n}}return!1},o.TimeBase.prototype._parseBinary=function(o,e){var a;this.isUndef(e)&&(e=2),a=0>e?this._parseUnary(o):this._parseBinary(o,e-1);for(var i=o.peek();i&&this._matchGroup(i,this._binaryExpressions,e);)a=(i=o.next()).method.bind(this,a,this._parseBinary(o,e-1)),i=o.peek();return a},o.TimeBase.prototype._parseUnary=function(o){var e,a;e=o.peek();var i=this._matchGroup(e,this._unaryExpressions);return i?(e=o.next(),a=this._parseUnary(o),i.method.bind(this,a)):this._parsePrimary(o)},o.TimeBase.prototype._parsePrimary=function(o){var e,a;if(e=o.peek(),this.isUndef(e))throw new SyntaxError("Tone.TimeBase: Unexpected end of expression");if(this._matchGroup(e,this._primaryExpressions)){var i=(e=o.next()).value.match(e.regexp);return e.method.bind(this,i[1],i[2],i[3])}if(e&&"("===e.value){if(o.next(),a=this._parseBinary(o),!(e=o.next())||")"!==e.value)throw new SyntaxError("Expected )");return a}throw new SyntaxError("Tone.TimeBase: Cannot process token "+e.value)},o.TimeBase.prototype._parseExprString=function(n){this.isString(n)||(n=n.toString());var o=this._tokenize(n);return this._parseBinary(o)},o.TimeBase.prototype._noOp=function(){return 0},o.TimeBase.prototype._defaultExpr=function(){return this._noOp},o.TimeBase.prototype._defaultUnits="s",o.TimeBase.prototype._frequencyToUnits=function(t){return 1/t},o.TimeBase.prototype._beatsToUnits=function(t){return 60/o.Transport.bpm.value*t},o.TimeBase.prototype._secondsToUnits=function(t){return t},o.TimeBase.prototype._ticksToUnits=function(t){return t*(this._beatsToUnits(1)/o.Transport.PPQ)},o.TimeBase.prototype._timeSignature=function(){return o.Transport.timeSignature},o.TimeBase.prototype._pushExpr=function(n,a,t){return n instanceof o.TimeBase||(n=new this.constructor(n,t)),this._expr=this._binaryExpressions[a].method.bind(this,this._expr,n._expr),this},o.TimeBase.prototype.add=function(n,e){return this._pushExpr(n,"+",e)},o.TimeBase.prototype.sub=function(n,e){return this._pushExpr(n,"-",e)},o.TimeBase.prototype.mult=function(n,e){return this._pushExpr(n,"*",e)},o.TimeBase.prototype.div=function(n,e){return this._pushExpr(n,"/",e)},o.TimeBase.prototype.valueOf=function(){return this._expr()},o.TimeBase.prototype.dispose=function(){this._expr=null},o.TimeBase}.apply(t,o),!(r!==void 0&&(e.exports=r))},function(e,t,n){var o,r;o=[n(0),n(9)],r=function(n){"use strict";return n.Param=function(){var e=this.optionsObject(arguments,["param","units","convert"],n.Param.defaults);this._param=this.input=e.param,this.units=e.units,this.convert=e.convert,this.overridden=!1,this._lfo=null,this.isObject(e.lfo)?this.value=e.lfo:this.isUndef(e.value)||(this.value=e.value)},n.extend(n.Param),n.Param.defaults={units:n.Type.Default,convert:!0,param:void 0},Object.defineProperty(n.Param.prototype,"value",{get:function(){return this._toUnits(this._param.value)},set:function(o){if(this.isObject(o)){if(this.isUndef(n.LFO))throw new Error("Include 'Tone.LFO' to use an LFO as a Param value.");this._lfo&&this._lfo.dispose(),this._lfo=new n.LFO(o).start(),this._lfo.connect(this.input)}else{var t=this._fromUnits(o);this._param.cancelScheduledValues(0),this._param.value=t}}}),n.Param.prototype._fromUnits=function(e){if(!this.convert&&!this.isUndef(this.convert))return e;switch(this.units){case n.Type.Time:return this.toSeconds(e);case n.Type.Frequency:return this.toFrequency(e);case n.Type.Decibels:return this.dbToGain(e);case n.Type.NormalRange:return Math.min(Math.max(e,0),1);case n.Type.AudioRange:return Math.min(Math.max(e,-1),1);case n.Type.Positive:return Math.max(e,0);default:return e;}},n.Param.prototype._toUnits=function(e){if(!this.convert&&!this.isUndef(this.convert))return e;switch(this.units){case n.Type.Decibels:return this.gainToDb(e);default:return e;}},n.Param.prototype._minOutput=1e-5,n.Param.prototype.setValueAtTime=function(n,o){return n=this._fromUnits(n),(o=this.toSeconds(o))<=this.now()+this.blockTime?this._param.value=n:this._param.setValueAtTime(n,o),this},n.Param.prototype.setRampPoint=function(n){n=this.defaultArg(n,this.now());var o=this._param.value;return 0===o&&(o=this._minOutput),this._param.setValueAtTime(o,n),this},n.Param.prototype.linearRampToValueAtTime=function(n,o){return n=this._fromUnits(n),this._param.linearRampToValueAtTime(n,this.toSeconds(o)),this},n.Param.prototype.exponentialRampToValueAtTime=function(n,o){return n=this._fromUnits(n),n=Math.max(this._minOutput,n),this._param.exponentialRampToValueAtTime(n,this.toSeconds(o)),this},n.Param.prototype.exponentialRampToValue=function(n,t,e){return e=this.toSeconds(e),this.setRampPoint(e),this.exponentialRampToValueAtTime(n,e+this.toSeconds(t)),this},n.Param.prototype.linearRampToValue=function(n,t,e){return e=this.toSeconds(e),this.setRampPoint(e),this.linearRampToValueAtTime(n,e+this.toSeconds(t)),this},n.Param.prototype.setTargetAtTime=function(n,o,e){return n=this._fromUnits(n),n=Math.max(this._minOutput,n),e=Math.max(this._minOutput,e),this._param.setTargetAtTime(n,this.toSeconds(o),e),this},n.Param.prototype.setValueCurveAtTime=function(n,t,e){for(var o=0;o<n.length;o++)n[o]=this._fromUnits(n[o]);return this._param.setValueCurveAtTime(n,this.toSeconds(t),this.toSeconds(e)),this},n.Param.prototype.cancelScheduledValues=function(e){return this._param.cancelScheduledValues(this.toSeconds(e)),this},n.Param.prototype.rampTo=function(o,t,r){return t=this.defaultArg(t,0),this.units===n.Type.Frequency||this.units===n.Type.BPM||this.units===n.Type.Decibels?this.exponentialRampToValue(o,t,r):this.linearRampToValue(o,t,r),this},Object.defineProperty(n.Param.prototype,"lfo",{get:function(){return this._lfo}}),n.Param.prototype.dispose=function(){return n.prototype.dispose.call(this),this._param=null,this._lfo&&(this._lfo.dispose(),this._lfo=null),this},n.Param}.apply(t,o),!(r!==void 0&&(e.exports=r))},function(e,t,n){var o,r;o=[n(0),n(9)],r=function(t){"use strict";return t.Timeline=function(){var n=this.optionsObject(arguments,["memory"],t.Timeline.defaults);this._timeline=[],this._toRemove=[],this._iterating=!1,this.memory=n.memory},t.extend(t.Timeline),t.Timeline.defaults={memory:1/0},Object.defineProperty(t.Timeline.prototype,"length",{get:function(){return this._timeline.length}}),t.Timeline.prototype.add=function(n){if(this.isUndef(n.time))throw new Error("Tone.Timeline: events must have a time attribute");if(this._timeline.length){var e=this._search(n.time);this._timeline.splice(e+1,0,n)}else this._timeline.push(n);if(this.length>this.memory){var o=this.length-this.memory;this._timeline.splice(0,o)}return this},t.Timeline.prototype.remove=function(t){if(this._iterating)this._toRemove.push(t);else{var e=this._timeline.indexOf(t);-1!==e&&this._timeline.splice(e,1)}return this},t.Timeline.prototype.get=function(t){var e=this._search(t);return-1===e?null:this._timeline[e]},t.Timeline.prototype.peek=function(){return this._timeline[0]},t.Timeline.prototype.shift=function(){return this._timeline.shift()},t.Timeline.prototype.getAfter=function(t){var e=this._search(t);return e+1<this._timeline.length?this._timeline[e+1]:null},t.Timeline.prototype.getBefore=function(n){var e=this._timeline.length;if(0<e&&this._timeline[e-1].time<n)return this._timeline[e-1];var o=this._search(n);return 0<=o-1?this._timeline[o-1]:null},t.Timeline.prototype.cancel=function(n){if(1<this._timeline.length){var e=this._search(n);if(!(0<=e))this._timeline=[];else if(this._timeline[e].time===n){for(var o=e;0<=o&&this._timeline[o].time===n;o--)e=o;this._timeline=this._timeline.slice(0,e)}else this._timeline=this._timeline.slice(0,e+1)}else 1===this._timeline.length&&this._timeline[0].time>=n&&(this._timeline=[]);return this},t.Timeline.prototype.cancelBefore=function(t){if(this._timeline.length){var e=this._search(t);0<=e&&(this._timeline=this._timeline.slice(e+1))}return this},t.Timeline.prototype._search=function(o){var e=0,a=this._timeline.length,t=a;if(0<a&&this._timeline[a-1].time<=o)return a-1;for(;e<t;){var u=Math.floor(e+(t-e)/2),p=this._timeline[u],s=this._timeline[u+1];if(p.time===o){for(var c=u;c<this._timeline.length;c++)this._timeline[c].time===o&&(u=c);return u}if(p.time<o&&s.time>o)return u;p.time>o?t=u:p.time<o&&(e=u+1)}return-1},t.Timeline.prototype._iterate=function(o,e,a){this._iterating=!0,e=this.defaultArg(e,0),a=this.defaultArg(a,this._timeline.length-1);for(var u=e;u<=a;u++)o(this._timeline[u]);if(this._iterating=!1,0<this._toRemove.length){for(var l=0,p;l<this._toRemove.length;l++)p=this._timeline.indexOf(this._toRemove[l]),-1!==p&&this._timeline.splice(p,1);this._toRemove=[]}},t.Timeline.prototype.forEach=function(t){return this._iterate(t),this},t.Timeline.prototype.forEachBefore=function(n,e){var o=this._search(n);return-1!==o&&this._iterate(e,0,o),this},t.Timeline.prototype.forEachAfter=function(n,e){var o=this._search(n);return this._iterate(e,o+1),this},t.Timeline.prototype.forEachFrom=function(n,e){for(var o=this._search(n);0<=o&&this._timeline[o].time>=n;)o--;return this._iterate(e,o+1),this},t.Timeline.prototype.forEachAtTime=function(n,o){var t=this._search(n);return-1!==t&&this._iterate(function(t){t.time===n&&o(t)},0,t),this},t.Timeline.prototype.dispose=function(){t.prototype.dispose.call(this),this._timeline=null,this._toRemove=null},t.Timeline}.apply(t,o),!(r!==void 0&&(e.exports=r))},function(e,t,n){var o,r;o=[n(0),n(1),n(2)],r=function(e){"use strict";return e.Negate=function(){this._multiply=this.input=this.output=new e.Multiply(-1)},e.extend(e.Negate,e.SignalBase),e.Negate.prototype.dispose=function(){return e.prototype.dispose.call(this),this._multiply.dispose(),this._multiply=null,this},e.Negate}.apply(t,o),!(r!==void 0&&(e.exports=r))},function(e,t,n){var o,r;o=[n(0),n(2),n(1),n(6)],r=function(t){"use strict";return t.GreaterThanZero=function(){this._thresh=this.output=new t.WaveShaper(function(t){return 0>=t?0:1},127),this._scale=this.input=new t.Multiply(1e4),this._scale.connect(this._thresh)},t.extend(t.GreaterThanZero,t.SignalBase),t.GreaterThanZero.prototype.dispose=function(){return t.prototype.dispose.call(this),this._scale.dispose(),this._scale=null,this._thresh.dispose(),this._thresh=null,this},t.GreaterThanZero}.apply(t,o),!(r!==void 0&&(e.exports=r))},function(n,o){var r,a,i;!function(s,e){a=[],r=e,i="function"==typeof r?r.apply(o,a):r,!(i!==void 0&&(n.exports=i))}(this,function(){function a(t){return"running"===t.state}var e=function(n,e){this._dragged=!1,this._element=n,this._bindedMove=this._moved.bind(this),this._bindedEnd=this._ended.bind(this,e),n.addEventListener("touchstart",this._bindedEnd),n.addEventListener("touchmove",this._bindedMove),n.addEventListener("touchend",this._bindedEnd),n.addEventListener("mouseup",this._bindedEnd)};return e.prototype._moved=function(){this._dragged=!0},e.prototype._ended=function(t){this._dragged||function(o){var e=o.createBuffer(1,1,o.sampleRate),t=o.createBufferSource();t.buffer=e,t.connect(o.destination),t.start(0),o.resume&&o.resume()}(t),this._dragged=!1},e.prototype.dispose=function(){this._element.removeEventListener("touchstart",this._bindedEnd),this._element.removeEventListener("touchmove",this._bindedMove),this._element.removeEventListener("touchend",this._bindedEnd),this._element.removeEventListener("mouseup",this._bindedEnd),this._bindedMove=null,this._bindedEnd=null,this._element=null},function(o,t,r){var n=new Promise(function(t){!function(o,t){a(o)?t():function n(){a(o)?t():(requestAnimationFrame(n),o.resume&&o.resume())}()}(o,t)}),i=[];return function r(a,t,n){if(Array.isArray(a)||NodeList&&a instanceof NodeList)for(var i=0;i<a.length;i++)r(a[i],t,n);else if("string"==typeof a)r(document.querySelectorAll(a),t,n);else if(a.jquery&&"function"==typeof a.toArray)r(a.toArray(),t,n);else if(Element&&a instanceof Element){var s=new e(a,n);t.push(s)}}(t=t||document.body,i,o),n.then(function(){for(var t=0;t<i.length;t++)i[t].dispose();i=null,r&&r()}),n}})},function(e,t,n){var o,r;o=[n(0),n(2),n(32),n(38),n(10)],r=function(t){"use strict";return t.CrossFade=function(n){this.createInsOuts(2,1),this.a=this.input[0]=new t.Gain,this.b=this.input[1]=new t.Gain,this.fade=new t.Signal(this.defaultArg(n,.5),t.Type.NormalRange),this._equalPowerA=new t.EqualPowerGain,this._equalPowerB=new t.EqualPowerGain,this._invert=new t.Expr("1 - $0"),this.a.connect(this.output),this.b.connect(this.output),this.fade.chain(this._equalPowerB,this.b.gain),this.fade.chain(this._invert,this._equalPowerA,this.a.gain),this._readOnly("fade")},t.extend(t.CrossFade),t.CrossFade.prototype.dispose=function(){return t.prototype.dispose.call(this),this._writable("fade"),this._equalPowerA.dispose(),this._equalPowerA=null,this._equalPowerB.dispose(),this._equalPowerB=null,this.fade.dispose(),this.fade=null,this._invert.dispose(),this._invert=null,this.a.dispose(),this.a=null,this.b.dispose(),this.b=null,this},t.CrossFade}.apply(t,o),!(r!==void 0&&(e.exports=r))},function(){!function(){function d(s){var l=this,o={},n=-1;this.parameters.forEach(function(i,e){var t=a[++n]||(a[n]=new Float32Array(l.bufferSize));t.fill(i.value),o[e]=t}),this.processor.realm.exec("self.sampleRate=sampleRate="+this.context.sampleRate+";self.currentTime=currentTime="+this.context.currentTime);var e=u(s.inputBuffer),t=u(s.outputBuffer);this.instance.process([e],[t],o)}function u(n){for(var e=[],t=0;t<n.numberOfChannels;t++)e[t]=n.getChannelData(t);return e}function p(t){return t.$$processors||(t.$$processors={})}function t(t){this.$$context=t}var a=[],f;"function"!=typeof AudioWorkletNode&&(self.AudioWorkletNode=function(l,e,t){var r=p(l)[e],o=l.createScriptProcessor(void 0,2,t&&t.outputChannelCount?t.outputChannelCount[0]:2);if(o.parameters=new Map,r.properties)for(var n=0;n<r.properties.length;n++){var m=r.properties[n],s=l.createGain().gain;s.value=m.defaultValue,o.parameters.set(m.name,s)}var a=new MessageChannel;f=a.port2;var u=new r.Processor(t||{});return f=null,o.port=a.port1,o.processor=r,o.instance=u,o.onaudioprocess=d,o},Object.defineProperty((self.AudioContext||self.webkitAudioContext).prototype,"audioWorklet",{get:function(){return this.$$audioWorklet||(this.$$audioWorklet=new self.AudioWorklet(this))}}),self.AudioWorklet=(t.prototype.addModule=function(o,a){var i=this;return fetch(o).then(function(t){if(!t.ok)throw Error(t.status);return t.text()}).then(function(t){var n={sampleRate:0,currentTime:0,AudioWorkletProcessor:function(){this.port=f},registerProcessor:function(o,e){p(i.$$context)[o]={realm:r,context:n,Processor:e,properties:e.parameterDescriptors||[]}}},r=new function(l,e){var t=document.createElement("iframe");t.style.cssText="position:absolute;left:0;top:-999px;width:1px;height:1px;",e.appendChild(t);var r=t.contentWindow,o=r.document,n="var window,$hook";for(var p in r)p in l||"eval"===p||(n+=",",n+=p);for(var s in l)n+=",",n+=s,n+="=self.",n+=s;var a=o.createElement("script");a.appendChild(o.createTextNode("function $hook(self,console) {\"use strict\";\n        "+n+";return function() {return eval(arguments[0])}}")),o.body.appendChild(a),this.exec=r.$hook(l,console)}(n.self=n,document.documentElement);return r.exec((a&&a.transpile||String)(t)),null})},t))}()},function(){(function(){function e(e){e&&(e.setTargetAtTime||(e.setTargetAtTime=e.setTargetValueAtTime))}window.hasOwnProperty("webkitAudioContext")&&!window.hasOwnProperty("AudioContext")&&(window.AudioContext=window.webkitAudioContext,"function"!=typeof AudioContext.prototype.createGain&&(AudioContext.prototype.createGain=AudioContext.prototype.createGainNode),"function"!=typeof AudioContext.prototype.createDelay&&(AudioContext.prototype.createDelay=AudioContext.prototype.createDelayNode),"function"!=typeof AudioContext.prototype.createScriptProcessor&&(AudioContext.prototype.createScriptProcessor=AudioContext.prototype.createJavaScriptNode),"function"!=typeof AudioContext.prototype.createPeriodicWave&&(AudioContext.prototype.createPeriodicWave=AudioContext.prototype.createWaveTable),AudioContext.prototype.internal_createGain=AudioContext.prototype.createGain,AudioContext.prototype.createGain=function(){var t=this.internal_createGain();return e(t.gain),t},AudioContext.prototype.internal_createDelay=AudioContext.prototype.createDelay,AudioContext.prototype.createDelay=function(t){var n=t?this.internal_createDelay(t):this.internal_createDelay();return e(n.delayTime),n},AudioContext.prototype.internal_createBufferSource=AudioContext.prototype.createBufferSource,AudioContext.prototype.createBufferSource=function(){var t=this.internal_createBufferSource();return t.start?(t.internal_start=t.start,t.start=function(e,n,o){"undefined"==typeof o?t.internal_start(e||0,n||0):t.internal_start(e||0,n,o)}):t.start=function(e,t,n){t||n?this.noteGrainOn(e||0,t,n):this.noteOn(e||0)},t.stop?(t.internal_stop=t.stop,t.stop=function(e){t.internal_stop(e||0)}):t.stop=function(e){this.noteOff(e||0)},e(t.playbackRate),t},AudioContext.prototype.internal_createDynamicsCompressor=AudioContext.prototype.createDynamicsCompressor,AudioContext.prototype.createDynamicsCompressor=function(){var t=this.internal_createDynamicsCompressor();return e(t.threshold),e(t.knee),e(t.ratio),e(t.reduction),e(t.attack),e(t.release),t},AudioContext.prototype.internal_createBiquadFilter=AudioContext.prototype.createBiquadFilter,AudioContext.prototype.createBiquadFilter=function(){var t=this.internal_createBiquadFilter();return e(t.frequency),e(t.detune),e(t.Q),e(t.gain),t},"function"!=typeof AudioContext.prototype.createOscillator&&(AudioContext.prototype.internal_createOscillator=AudioContext.prototype.createOscillator,AudioContext.prototype.createOscillator=function(){var t=this.internal_createOscillator();return t.start?(t.internal_start=t.start,t.start=function(e){t.internal_start(e||0)}):t.start=function(e){this.noteOn(e||0)},t.stop?(t.internal_stop=t.stop,t.stop=function(e){t.internal_stop(e||0)}):t.stop=function(e){this.noteOff(e||0)},t.setPeriodicWave||(t.setPeriodicWave=t.setWaveTable),e(t.frequency),e(t.detune),t})),window.hasOwnProperty("webkitOfflineAudioContext")&&!window.hasOwnProperty("OfflineAudioContext")&&(window.OfflineAudioContext=window.webkitOfflineAudioContext)})(window),navigator.getUserMedia=navigator.getUserMedia||navigator.webkitGetUserMedia||navigator.mozGetUserMedia||navigator.msGetUserMedia;var e=document.createElement("audio");p5.prototype.isSupported=function(){return!!e.canPlayType};var t=function(){return!!e.canPlayType&&e.canPlayType("audio/ogg; codecs=\"vorbis\"")},n=function(){return!!e.canPlayType&&e.canPlayType("audio/mpeg;")},o=function(){return!!e.canPlayType&&e.canPlayType("audio/wav; codecs=\"1\"")},r=function(){return!!e.canPlayType&&(e.canPlayType("audio/x-m4a;")||e.canPlayType("audio/aac;"))},a=function(){return!!e.canPlayType&&e.canPlayType("audio/x-aiff;")};p5.prototype.isFileSupported=function(e){switch(e.toLowerCase()){case"mp3":return n();case"wav":return o();case"ogg":return t();case"aac":case"m4a":case"mp4":return r();case"aif":case"aiff":return a();default:return!1;}}},function(e){var n=function(){return this}();try{n=n||new Function("return this")()}catch(e){"object"==typeof window&&(n=window)}e.exports=n},function(e,t,n){"use strict";n.r(t),t["default"]="function _typeof(obj) { if (typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\") { _typeof = function _typeof(obj) { return typeof obj; }; } else { _typeof = function _typeof(obj) { return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj; }; } return _typeof(obj); }\n\nfunction _possibleConstructorReturn(self, call) { if (call && (_typeof(call) === \"object\" || typeof call === \"function\")) { return call; } return _assertThisInitialized(self); }\n\nfunction _assertThisInitialized(self) { if (self === void 0) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return self; }\n\nfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function\"); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, writable: true, configurable: true } }); if (superClass) _setPrototypeOf(subClass, superClass); }\n\nfunction _wrapNativeSuper(Class) { var _cache = typeof Map === \"function\" ? new Map() : undefined; _wrapNativeSuper = function _wrapNativeSuper(Class) { if (Class === null || !_isNativeFunction(Class)) return Class; if (typeof Class !== \"function\") { throw new TypeError(\"Super expression must either be null or a function\"); } if (typeof _cache !== \"undefined\") { if (_cache.has(Class)) return _cache.get(Class); _cache.set(Class, Wrapper); } function Wrapper() { return _construct(Class, arguments, _getPrototypeOf(this).constructor); } Wrapper.prototype = Object.create(Class.prototype, { constructor: { value: Wrapper, enumerable: false, writable: true, configurable: true } }); return _setPrototypeOf(Wrapper, Class); }; return _wrapNativeSuper(Class); }\n\nfunction isNativeReflectConstruct() { if (typeof Reflect === \"undefined\" || !Reflect.construct) return false; if (Reflect.construct.sham) return false; if (typeof Proxy === \"function\") return true; try { Date.prototype.toString.call(Reflect.construct(Date, [], function () {})); return true; } catch (e) { return false; } }\n\nfunction _construct(Parent, args, Class) { if (isNativeReflectConstruct()) { _construct = Reflect.construct; } else { _construct = function _construct(Parent, args, Class) { var a = [null]; a.push.apply(a, args); var Constructor = Function.bind.apply(Parent, a); var instance = new Constructor(); if (Class) _setPrototypeOf(instance, Class.prototype); return instance; }; } return _construct.apply(null, arguments); }\n\nfunction _isNativeFunction(fn) { return Function.toString.call(fn).indexOf(\"[native code]\") !== -1; }\n\nfunction _setPrototypeOf(o, p) { _setPrototypeOf = Object.setPrototypeOf || function _setPrototypeOf(o, p) { o.__proto__ = p; return o; }; return _setPrototypeOf(o, p); }\n\nfunction _getPrototypeOf(o) { _getPrototypeOf = Object.setPrototypeOf ? Object.getPrototypeOf : function _getPrototypeOf(o) { return o.__proto__ || Object.getPrototypeOf(o); }; return _getPrototypeOf(o); }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction _defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } }\n\nfunction _createClass(Constructor, protoProps, staticProps) { if (protoProps) _defineProperties(Constructor.prototype, protoProps); if (staticProps) _defineProperties(Constructor, staticProps); return Constructor; }\n\n// import dependencies via preval.require so that they're available as values at compile time\nvar processorNames = {\n  \"recorderProcessor\": \"recorder-processor\",\n  \"soundFileProcessor\": \"sound-file-processor\",\n  \"amplitudeProcessor\": \"amplitude-processor\"\n};\nvar RingBuffer = {\n  \"default\":\n  /*#__PURE__*/\n  function () {\n    /**\n     * @constructor\n     * @param  {number} length Buffer length in frames.\n     * @param  {number} channelCount Buffer channel count.\n     */\n    function RingBuffer(length, channelCount) {\n      _classCallCheck(this, RingBuffer);\n\n      this._readIndex = 0;\n      this._writeIndex = 0;\n      this._framesAvailable = 0;\n      this._channelCount = channelCount;\n      this._length = length;\n      this._channelData = [];\n\n      for (var i = 0; i < this._channelCount; ++i) {\n        this._channelData[i] = new Float32Array(length);\n      }\n    }\n    /**\n     * Getter for Available frames in buffer.\n     *\n     * @return {number} Available frames in buffer.\n     */\n\n\n    _createClass(RingBuffer, [{\n      key: \"push\",\n\n      /**\n       * Push a sequence of Float32Arrays to buffer.\n       *\n       * @param  {array} arraySequence A sequence of Float32Arrays.\n       */\n      value: function push(arraySequence) {\n        // The channel count of arraySequence and the length of each channel must\n        // match with this buffer obejct.\n        // Transfer data from the |arraySequence| storage to the internal buffer.\n        var sourceLength = arraySequence[0] ? arraySequence[0].length : 0;\n\n        for (var i = 0; i < sourceLength; ++i) {\n          var writeIndex = (this._writeIndex + i) % this._length;\n\n          for (var channel = 0; channel < this._channelCount; ++channel) {\n            this._channelData[channel][writeIndex] = arraySequence[channel][i];\n          }\n        }\n\n        this._writeIndex += sourceLength;\n\n        if (this._writeIndex >= this._length) {\n          this._writeIndex = 0;\n        } // For excessive frames, the buffer will be overwritten.\n\n\n        this._framesAvailable += sourceLength;\n\n        if (this._framesAvailable > this._length) {\n          this._framesAvailable = this._length;\n        }\n      }\n      /**\n       * Pull data out of buffer and fill a given sequence of Float32Arrays.\n       *\n       * @param  {array} arraySequence An array of Float32Arrays.\n       */\n\n    }, {\n      key: \"pull\",\n      value: function pull(arraySequence) {\n        // The channel count of arraySequence and the length of each channel must\n        // match with this buffer obejct.\n        // If the FIFO is completely empty, do nothing.\n        if (this._framesAvailable === 0) {\n          return;\n        }\n\n        var destinationLength = arraySequence[0].length; // Transfer data from the internal buffer to the |arraySequence| storage.\n\n        for (var i = 0; i < destinationLength; ++i) {\n          var readIndex = (this._readIndex + i) % this._length;\n\n          for (var channel = 0; channel < this._channelCount; ++channel) {\n            arraySequence[channel][i] = this._channelData[channel][readIndex];\n          }\n        }\n\n        this._readIndex += destinationLength;\n\n        if (this._readIndex >= this._length) {\n          this._readIndex = 0;\n        }\n\n        this._framesAvailable -= destinationLength;\n\n        if (this._framesAvailable < 0) {\n          this._framesAvailable = 0;\n        }\n      }\n    }, {\n      key: \"framesAvailable\",\n      get: function get() {\n        return this._framesAvailable;\n      }\n    }]);\n\n    return RingBuffer;\n  }()\n}[\"default\"];\n\nvar RecorderProcessor =\n/*#__PURE__*/\nfunction (_AudioWorkletProcesso) {\n  _inherits(RecorderProcessor, _AudioWorkletProcesso);\n\n  function RecorderProcessor(options) {\n    var _this;\n\n    _classCallCheck(this, RecorderProcessor);\n\n    _this = _possibleConstructorReturn(this, _getPrototypeOf(RecorderProcessor).call(this));\n    var processorOptions = options.processorOptions || {};\n    _this.numOutputChannels = options.outputChannelCount || 2;\n    _this.numInputChannels = processorOptions.numInputChannels || 2;\n    _this.bufferSize = processorOptions.bufferSize || 1024;\n    _this.recording = false;\n\n    _this.clear();\n\n    _this.port.onmessage = function (event) {\n      var data = event.data;\n\n      if (data.name === 'start') {\n        _this.record(data.duration);\n      } else if (data.name === 'stop') {\n        _this.stop();\n      }\n    };\n\n    return _this;\n  }\n\n  _createClass(RecorderProcessor, [{\n    key: \"process\",\n    value: function process(inputs) {\n      if (!this.recording) {\n        return true;\n      } else if (this.sampleLimit && this.recordedSamples >= this.sampleLimit) {\n        this.stop();\n        return true;\n      }\n\n      var input = inputs[0];\n      this.inputRingBuffer.push(input);\n\n      if (this.inputRingBuffer.framesAvailable >= this.bufferSize) {\n        this.inputRingBuffer.pull(this.inputRingBufferArraySequence);\n\n        for (var channel = 0; channel < this.numOutputChannels; ++channel) {\n          var inputChannelCopy = this.inputRingBufferArraySequence[channel].slice();\n\n          if (channel === 0) {\n            this.leftBuffers.push(inputChannelCopy);\n\n            if (this.numInputChannels === 1) {\n              this.rightBuffers.push(inputChannelCopy);\n            }\n          } else if (channel === 1 && this.numInputChannels > 1) {\n            this.rightBuffers.push(inputChannelCopy);\n          }\n        }\n\n        this.recordedSamples += this.bufferSize;\n      }\n\n      return true;\n    }\n  }, {\n    key: \"record\",\n    value: function record(duration) {\n      if (duration) {\n        this.sampleLimit = Math.round(duration * sampleRate);\n      }\n\n      this.recording = true;\n    }\n  }, {\n    key: \"stop\",\n    value: function stop() {\n      this.recording = false;\n      var buffers = this.getBuffers();\n      var leftBuffer = buffers[0].buffer;\n      var rightBuffer = buffers[1].buffer;\n      this.port.postMessage({\n        name: 'buffers',\n        leftBuffer: leftBuffer,\n        rightBuffer: rightBuffer\n      }, [leftBuffer, rightBuffer]);\n      this.clear();\n    }\n  }, {\n    key: \"getBuffers\",\n    value: function getBuffers() {\n      var buffers = [];\n      buffers.push(this.mergeBuffers(this.leftBuffers));\n      buffers.push(this.mergeBuffers(this.rightBuffers));\n      return buffers;\n    }\n  }, {\n    key: \"mergeBuffers\",\n    value: function mergeBuffers(channelBuffer) {\n      var result = new Float32Array(this.recordedSamples);\n      var offset = 0;\n      var lng = channelBuffer.length;\n\n      for (var i = 0; i < lng; i++) {\n        var buffer = channelBuffer[i];\n        result.set(buffer, offset);\n        offset += buffer.length;\n      }\n\n      return result;\n    }\n  }, {\n    key: \"clear\",\n    value: function clear() {\n      var _this2 = this;\n\n      this.leftBuffers = [];\n      this.rightBuffers = [];\n      this.inputRingBuffer = new RingBuffer(this.bufferSize, this.numInputChannels);\n      this.inputRingBufferArraySequence = new Array(this.numInputChannels).fill(null).map(function () {\n        return new Float32Array(_this2.bufferSize);\n      });\n      this.recordedSamples = 0;\n      this.sampleLimit = null;\n    }\n  }]);\n\n  return RecorderProcessor;\n}(_wrapNativeSuper(AudioWorkletProcessor));\n\nregisterProcessor(processorNames.recorderProcessor, RecorderProcessor);"},function(e,t,n){"use strict";n.r(t),t["default"]="function _typeof(obj) { if (typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\") { _typeof = function _typeof(obj) { return typeof obj; }; } else { _typeof = function _typeof(obj) { return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj; }; } return _typeof(obj); }\n\nfunction _possibleConstructorReturn(self, call) { if (call && (_typeof(call) === \"object\" || typeof call === \"function\")) { return call; } return _assertThisInitialized(self); }\n\nfunction _assertThisInitialized(self) { if (self === void 0) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return self; }\n\nfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function\"); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, writable: true, configurable: true } }); if (superClass) _setPrototypeOf(subClass, superClass); }\n\nfunction _wrapNativeSuper(Class) { var _cache = typeof Map === \"function\" ? new Map() : undefined; _wrapNativeSuper = function _wrapNativeSuper(Class) { if (Class === null || !_isNativeFunction(Class)) return Class; if (typeof Class !== \"function\") { throw new TypeError(\"Super expression must either be null or a function\"); } if (typeof _cache !== \"undefined\") { if (_cache.has(Class)) return _cache.get(Class); _cache.set(Class, Wrapper); } function Wrapper() { return _construct(Class, arguments, _getPrototypeOf(this).constructor); } Wrapper.prototype = Object.create(Class.prototype, { constructor: { value: Wrapper, enumerable: false, writable: true, configurable: true } }); return _setPrototypeOf(Wrapper, Class); }; return _wrapNativeSuper(Class); }\n\nfunction isNativeReflectConstruct() { if (typeof Reflect === \"undefined\" || !Reflect.construct) return false; if (Reflect.construct.sham) return false; if (typeof Proxy === \"function\") return true; try { Date.prototype.toString.call(Reflect.construct(Date, [], function () {})); return true; } catch (e) { return false; } }\n\nfunction _construct(Parent, args, Class) { if (isNativeReflectConstruct()) { _construct = Reflect.construct; } else { _construct = function _construct(Parent, args, Class) { var a = [null]; a.push.apply(a, args); var Constructor = Function.bind.apply(Parent, a); var instance = new Constructor(); if (Class) _setPrototypeOf(instance, Class.prototype); return instance; }; } return _construct.apply(null, arguments); }\n\nfunction _isNativeFunction(fn) { return Function.toString.call(fn).indexOf(\"[native code]\") !== -1; }\n\nfunction _setPrototypeOf(o, p) { _setPrototypeOf = Object.setPrototypeOf || function _setPrototypeOf(o, p) { o.__proto__ = p; return o; }; return _setPrototypeOf(o, p); }\n\nfunction _getPrototypeOf(o) { _getPrototypeOf = Object.setPrototypeOf ? Object.getPrototypeOf : function _getPrototypeOf(o) { return o.__proto__ || Object.getPrototypeOf(o); }; return _getPrototypeOf(o); }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction _defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } }\n\nfunction _createClass(Constructor, protoProps, staticProps) { if (protoProps) _defineProperties(Constructor.prototype, protoProps); if (staticProps) _defineProperties(Constructor, staticProps); return Constructor; }\n\n// import dependencies via preval.require so that they're available as values at compile time\nvar processorNames = {\n  \"recorderProcessor\": \"recorder-processor\",\n  \"soundFileProcessor\": \"sound-file-processor\",\n  \"amplitudeProcessor\": \"amplitude-processor\"\n};\nvar RingBuffer = {\n  \"default\":\n  /*#__PURE__*/\n  function () {\n    /**\n     * @constructor\n     * @param  {number} length Buffer length in frames.\n     * @param  {number} channelCount Buffer channel count.\n     */\n    function RingBuffer(length, channelCount) {\n      _classCallCheck(this, RingBuffer);\n\n      this._readIndex = 0;\n      this._writeIndex = 0;\n      this._framesAvailable = 0;\n      this._channelCount = channelCount;\n      this._length = length;\n      this._channelData = [];\n\n      for (var i = 0; i < this._channelCount; ++i) {\n        this._channelData[i] = new Float32Array(length);\n      }\n    }\n    /**\n     * Getter for Available frames in buffer.\n     *\n     * @return {number} Available frames in buffer.\n     */\n\n\n    _createClass(RingBuffer, [{\n      key: \"push\",\n\n      /**\n       * Push a sequence of Float32Arrays to buffer.\n       *\n       * @param  {array} arraySequence A sequence of Float32Arrays.\n       */\n      value: function push(arraySequence) {\n        // The channel count of arraySequence and the length of each channel must\n        // match with this buffer obejct.\n        // Transfer data from the |arraySequence| storage to the internal buffer.\n        var sourceLength = arraySequence[0] ? arraySequence[0].length : 0;\n\n        for (var i = 0; i < sourceLength; ++i) {\n          var writeIndex = (this._writeIndex + i) % this._length;\n\n          for (var channel = 0; channel < this._channelCount; ++channel) {\n            this._channelData[channel][writeIndex] = arraySequence[channel][i];\n          }\n        }\n\n        this._writeIndex += sourceLength;\n\n        if (this._writeIndex >= this._length) {\n          this._writeIndex = 0;\n        } // For excessive frames, the buffer will be overwritten.\n\n\n        this._framesAvailable += sourceLength;\n\n        if (this._framesAvailable > this._length) {\n          this._framesAvailable = this._length;\n        }\n      }\n      /**\n       * Pull data out of buffer and fill a given sequence of Float32Arrays.\n       *\n       * @param  {array} arraySequence An array of Float32Arrays.\n       */\n\n    }, {\n      key: \"pull\",\n      value: function pull(arraySequence) {\n        // The channel count of arraySequence and the length of each channel must\n        // match with this buffer obejct.\n        // If the FIFO is completely empty, do nothing.\n        if (this._framesAvailable === 0) {\n          return;\n        }\n\n        var destinationLength = arraySequence[0].length; // Transfer data from the internal buffer to the |arraySequence| storage.\n\n        for (var i = 0; i < destinationLength; ++i) {\n          var readIndex = (this._readIndex + i) % this._length;\n\n          for (var channel = 0; channel < this._channelCount; ++channel) {\n            arraySequence[channel][i] = this._channelData[channel][readIndex];\n          }\n        }\n\n        this._readIndex += destinationLength;\n\n        if (this._readIndex >= this._length) {\n          this._readIndex = 0;\n        }\n\n        this._framesAvailable -= destinationLength;\n\n        if (this._framesAvailable < 0) {\n          this._framesAvailable = 0;\n        }\n      }\n    }, {\n      key: \"framesAvailable\",\n      get: function get() {\n        return this._framesAvailable;\n      }\n    }]);\n\n    return RingBuffer;\n  }()\n}[\"default\"];\n\nvar SoundFileProcessor =\n/*#__PURE__*/\nfunction (_AudioWorkletProcesso) {\n  _inherits(SoundFileProcessor, _AudioWorkletProcesso);\n\n  function SoundFileProcessor(options) {\n    var _this;\n\n    _classCallCheck(this, SoundFileProcessor);\n\n    _this = _possibleConstructorReturn(this, _getPrototypeOf(SoundFileProcessor).call(this));\n    var processorOptions = options.processorOptions || {};\n    _this.bufferSize = processorOptions.bufferSize || 256;\n    _this.inputRingBuffer = new RingBuffer(_this.bufferSize, 1);\n    _this.inputRingBufferArraySequence = [new Float32Array(_this.bufferSize)];\n    return _this;\n  }\n\n  _createClass(SoundFileProcessor, [{\n    key: \"process\",\n    value: function process(inputs) {\n      var input = inputs[0]; // we only care about the first input channel, because that contains the position data\n\n      this.inputRingBuffer.push([input[0]]);\n\n      if (this.inputRingBuffer.framesAvailable >= this.bufferSize) {\n        this.inputRingBuffer.pull(this.inputRingBufferArraySequence);\n        var inputChannel = this.inputRingBufferArraySequence[0];\n        var position = inputChannel[inputChannel.length - 1] || 0;\n        this.port.postMessage({\n          name: 'position',\n          position: position\n        });\n      }\n\n      return true;\n    }\n  }]);\n\n  return SoundFileProcessor;\n}(_wrapNativeSuper(AudioWorkletProcessor));\n\nregisterProcessor(processorNames.soundFileProcessor, SoundFileProcessor);"},function(e,t,n){"use strict";n.r(t),t["default"]="function _typeof(obj) { if (typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\") { _typeof = function _typeof(obj) { return typeof obj; }; } else { _typeof = function _typeof(obj) { return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj; }; } return _typeof(obj); }\n\nfunction _possibleConstructorReturn(self, call) { if (call && (_typeof(call) === \"object\" || typeof call === \"function\")) { return call; } return _assertThisInitialized(self); }\n\nfunction _assertThisInitialized(self) { if (self === void 0) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return self; }\n\nfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function\"); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, writable: true, configurable: true } }); if (superClass) _setPrototypeOf(subClass, superClass); }\n\nfunction _wrapNativeSuper(Class) { var _cache = typeof Map === \"function\" ? new Map() : undefined; _wrapNativeSuper = function _wrapNativeSuper(Class) { if (Class === null || !_isNativeFunction(Class)) return Class; if (typeof Class !== \"function\") { throw new TypeError(\"Super expression must either be null or a function\"); } if (typeof _cache !== \"undefined\") { if (_cache.has(Class)) return _cache.get(Class); _cache.set(Class, Wrapper); } function Wrapper() { return _construct(Class, arguments, _getPrototypeOf(this).constructor); } Wrapper.prototype = Object.create(Class.prototype, { constructor: { value: Wrapper, enumerable: false, writable: true, configurable: true } }); return _setPrototypeOf(Wrapper, Class); }; return _wrapNativeSuper(Class); }\n\nfunction isNativeReflectConstruct() { if (typeof Reflect === \"undefined\" || !Reflect.construct) return false; if (Reflect.construct.sham) return false; if (typeof Proxy === \"function\") return true; try { Date.prototype.toString.call(Reflect.construct(Date, [], function () {})); return true; } catch (e) { return false; } }\n\nfunction _construct(Parent, args, Class) { if (isNativeReflectConstruct()) { _construct = Reflect.construct; } else { _construct = function _construct(Parent, args, Class) { var a = [null]; a.push.apply(a, args); var Constructor = Function.bind.apply(Parent, a); var instance = new Constructor(); if (Class) _setPrototypeOf(instance, Class.prototype); return instance; }; } return _construct.apply(null, arguments); }\n\nfunction _isNativeFunction(fn) { return Function.toString.call(fn).indexOf(\"[native code]\") !== -1; }\n\nfunction _setPrototypeOf(o, p) { _setPrototypeOf = Object.setPrototypeOf || function _setPrototypeOf(o, p) { o.__proto__ = p; return o; }; return _setPrototypeOf(o, p); }\n\nfunction _getPrototypeOf(o) { _getPrototypeOf = Object.setPrototypeOf ? Object.getPrototypeOf : function _getPrototypeOf(o) { return o.__proto__ || Object.getPrototypeOf(o); }; return _getPrototypeOf(o); }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction _defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } }\n\nfunction _createClass(Constructor, protoProps, staticProps) { if (protoProps) _defineProperties(Constructor.prototype, protoProps); if (staticProps) _defineProperties(Constructor, staticProps); return Constructor; }\n\n// import dependencies via preval.require so that they're available as values at compile time\nvar processorNames = {\n  \"recorderProcessor\": \"recorder-processor\",\n  \"soundFileProcessor\": \"sound-file-processor\",\n  \"amplitudeProcessor\": \"amplitude-processor\"\n};\nvar RingBuffer = {\n  \"default\":\n  /*#__PURE__*/\n  function () {\n    /**\n     * @constructor\n     * @param  {number} length Buffer length in frames.\n     * @param  {number} channelCount Buffer channel count.\n     */\n    function RingBuffer(length, channelCount) {\n      _classCallCheck(this, RingBuffer);\n\n      this._readIndex = 0;\n      this._writeIndex = 0;\n      this._framesAvailable = 0;\n      this._channelCount = channelCount;\n      this._length = length;\n      this._channelData = [];\n\n      for (var i = 0; i < this._channelCount; ++i) {\n        this._channelData[i] = new Float32Array(length);\n      }\n    }\n    /**\n     * Getter for Available frames in buffer.\n     *\n     * @return {number} Available frames in buffer.\n     */\n\n\n    _createClass(RingBuffer, [{\n      key: \"push\",\n\n      /**\n       * Push a sequence of Float32Arrays to buffer.\n       *\n       * @param  {array} arraySequence A sequence of Float32Arrays.\n       */\n      value: function push(arraySequence) {\n        // The channel count of arraySequence and the length of each channel must\n        // match with this buffer obejct.\n        // Transfer data from the |arraySequence| storage to the internal buffer.\n        var sourceLength = arraySequence[0] ? arraySequence[0].length : 0;\n\n        for (var i = 0; i < sourceLength; ++i) {\n          var writeIndex = (this._writeIndex + i) % this._length;\n\n          for (var channel = 0; channel < this._channelCount; ++channel) {\n            this._channelData[channel][writeIndex] = arraySequence[channel][i];\n          }\n        }\n\n        this._writeIndex += sourceLength;\n\n        if (this._writeIndex >= this._length) {\n          this._writeIndex = 0;\n        } // For excessive frames, the buffer will be overwritten.\n\n\n        this._framesAvailable += sourceLength;\n\n        if (this._framesAvailable > this._length) {\n          this._framesAvailable = this._length;\n        }\n      }\n      /**\n       * Pull data out of buffer and fill a given sequence of Float32Arrays.\n       *\n       * @param  {array} arraySequence An array of Float32Arrays.\n       */\n\n    }, {\n      key: \"pull\",\n      value: function pull(arraySequence) {\n        // The channel count of arraySequence and the length of each channel must\n        // match with this buffer obejct.\n        // If the FIFO is completely empty, do nothing.\n        if (this._framesAvailable === 0) {\n          return;\n        }\n\n        var destinationLength = arraySequence[0].length; // Transfer data from the internal buffer to the |arraySequence| storage.\n\n        for (var i = 0; i < destinationLength; ++i) {\n          var readIndex = (this._readIndex + i) % this._length;\n\n          for (var channel = 0; channel < this._channelCount; ++channel) {\n            arraySequence[channel][i] = this._channelData[channel][readIndex];\n          }\n        }\n\n        this._readIndex += destinationLength;\n\n        if (this._readIndex >= this._length) {\n          this._readIndex = 0;\n        }\n\n        this._framesAvailable -= destinationLength;\n\n        if (this._framesAvailable < 0) {\n          this._framesAvailable = 0;\n        }\n      }\n    }, {\n      key: \"framesAvailable\",\n      get: function get() {\n        return this._framesAvailable;\n      }\n    }]);\n\n    return RingBuffer;\n  }()\n}[\"default\"];\n\nvar AmplitudeProcessor =\n/*#__PURE__*/\nfunction (_AudioWorkletProcesso) {\n  _inherits(AmplitudeProcessor, _AudioWorkletProcesso);\n\n  function AmplitudeProcessor(options) {\n    var _this;\n\n    _classCallCheck(this, AmplitudeProcessor);\n\n    _this = _possibleConstructorReturn(this, _getPrototypeOf(AmplitudeProcessor).call(this));\n    var processorOptions = options.processorOptions || {};\n    _this.numOutputChannels = options.outputChannelCount || 1;\n    _this.numInputChannels = processorOptions.numInputChannels || 2;\n    _this.normalize = processorOptions.normalize || false;\n    _this.smoothing = processorOptions.smoothing || 0;\n    _this.bufferSize = processorOptions.bufferSize || 2048;\n    _this.inputRingBuffer = new RingBuffer(_this.bufferSize, _this.numInputChannels);\n    _this.outputRingBuffer = new RingBuffer(_this.bufferSize, _this.numOutputChannels);\n    _this.inputRingBufferArraySequence = new Array(_this.numInputChannels).fill(null).map(function () {\n      return new Float32Array(_this.bufferSize);\n    });\n    _this.stereoVol = [0, 0];\n    _this.stereoVolNorm = [0, 0];\n    _this.volMax = 0.001;\n\n    _this.port.onmessage = function (event) {\n      var data = event.data;\n\n      if (data.name === 'toggleNormalize') {\n        _this.normalize = data.normalize;\n      } else if (data.name === 'smoothing') {\n        _this.smoothing = Math.max(0, Math.min(1, data.smoothing));\n      }\n    };\n\n    return _this;\n  } // TO DO make this stereo / dependent on # of audio channels\n\n\n  _createClass(AmplitudeProcessor, [{\n    key: \"process\",\n    value: function process(inputs, outputs) {\n      var input = inputs[0];\n      var output = outputs[0];\n      var smoothing = this.smoothing;\n      this.inputRingBuffer.push(input);\n\n      if (this.inputRingBuffer.framesAvailable >= this.bufferSize) {\n        this.inputRingBuffer.pull(this.inputRingBufferArraySequence);\n\n        for (var channel = 0; channel < this.numInputChannels; ++channel) {\n          var inputBuffer = this.inputRingBufferArraySequence[channel];\n          var bufLength = inputBuffer.length;\n          var sum = 0;\n\n          for (var i = 0; i < bufLength; i++) {\n            var x = inputBuffer[i];\n\n            if (this.normalize) {\n              sum += Math.max(Math.min(x / this.volMax, 1), -1) * Math.max(Math.min(x / this.volMax, 1), -1);\n            } else {\n              sum += x * x;\n            }\n          } // ... then take the square root of the sum.\n\n\n          var rms = Math.sqrt(sum / bufLength);\n          this.stereoVol[channel] = Math.max(rms, this.stereoVol[channel] * smoothing);\n          this.volMax = Math.max(this.stereoVol[channel], this.volMax);\n        } // calculate stero normalized volume and add volume from all channels together\n\n\n        var volSum = 0;\n\n        for (var index = 0; index < this.stereoVol.length; index++) {\n          this.stereoVolNorm[index] = Math.max(Math.min(this.stereoVol[index] / this.volMax, 1), 0);\n          volSum += this.stereoVol[index];\n        } // volume is average of channels\n\n\n        var volume = volSum / this.stereoVol.length; // normalized value\n\n        var volNorm = Math.max(Math.min(volume / this.volMax, 1), 0);\n        this.port.postMessage({\n          name: 'amplitude',\n          volume: volume,\n          volNorm: volNorm,\n          stereoVol: this.stereoVol,\n          stereoVolNorm: this.stereoVolNorm\n        }); // pass input through to output\n\n        this.outputRingBuffer.push(this.inputRingBufferArraySequence);\n      } // pull 128 frames out of the ring buffer\n      // if the ring buffer does not have enough frames, the output will be silent\n\n\n      this.outputRingBuffer.pull(output);\n      return true;\n    }\n  }]);\n\n  return AmplitudeProcessor;\n}(_wrapNativeSuper(AudioWorkletProcessor));\n\nregisterProcessor(processorNames.amplitudeProcessor, AmplitudeProcessor);"},function(e,t,n){var o,r;o=[n(0),n(17)],r=function(a){a.Frequency=function(n,e){return this instanceof a.Frequency?void a.TimeBase.call(this,n,e):new a.Frequency(n,e)},a.extend(a.Frequency,a.TimeBase),a.Frequency.prototype._primaryExpressions=Object.create(a.TimeBase.prototype._primaryExpressions),a.Frequency.prototype._primaryExpressions.midi={regexp:/^(\d+(?:\.\d+)?midi)/,method:function(t){return this.midiToFrequency(t)}},a.Frequency.prototype._primaryExpressions.note={regexp:/^([a-g]{1}(?:b|#|x|bb)?)(-?[0-9]+)/i,method:function(n,e){var t=o[n.toLowerCase()]+12*(parseInt(e)+1);return this.midiToFrequency(t)}},a.Frequency.prototype._primaryExpressions.tr={regexp:/^(\d+(?:\.\d+)?):(\d+(?:\.\d+)?):?(\d+(?:\.\d+)?)?/,method:function(o,e,t){var r=1;return o&&"0"!==o&&(r*=this._beatsToUnits(this._timeSignature()*parseFloat(o))),e&&"0"!==e&&(r*=this._beatsToUnits(parseFloat(e))),t&&"0"!==t&&(r*=this._beatsToUnits(parseFloat(t)/4)),r}},a.Frequency.prototype.transpose=function(t){return this._expr=function(n,e){return n()*this.intervalToFrequencyRatio(e)}.bind(this,this._expr,t),this},a.Frequency.prototype.harmonize=function(t){return this._expr=function(a,e){for(var t=a(),r=[],n=0;n<e.length;n++)r[n]=t*this.intervalToFrequencyRatio(e[n]);return r}.bind(this,this._expr,t),this},a.Frequency.prototype.toMidi=function(){return this.frequencyToMidi(this.valueOf())},a.Frequency.prototype.toNote=function(){var o=this.valueOf(),e=Math.log(o/a.Frequency.A4)/Math.LN2,t=Math.round(12*e)+57,i=Math.floor(t/12);return 0>i&&(t+=-12*i),s[t%12]+i.toString()},a.Frequency.prototype.toSeconds=function(){return 1/this.valueOf()},a.Frequency.prototype.toFrequency=function(){return this.valueOf()},a.Frequency.prototype.toTicks=function(){var n=this._beatsToUnits(1),e=this.valueOf()/n;return Math.floor(e*a.Transport.PPQ)},a.Frequency.prototype._frequencyToUnits=function(t){return t},a.Frequency.prototype._ticksToUnits=function(t){return 1/(60*t/(a.Transport.bpm.value*a.Transport.PPQ))},a.Frequency.prototype._beatsToUnits=function(t){return 1/a.TimeBase.prototype._beatsToUnits.call(this,t)},a.Frequency.prototype._secondsToUnits=function(t){return 1/t},a.Frequency.prototype._defaultUnits="hz";var o={cbb:-2,cb:-1,c:0,"c#":1,cx:2,dbb:0,db:1,d:2,"d#":3,dx:4,ebb:2,eb:3,e:4,"e#":5,ex:6,fbb:3,fb:4,f:5,"f#":6,fx:7,gbb:5,gb:6,g:7,"g#":8,gx:9,abb:7,ab:8,a:9,"a#":10,ax:11,bbb:9,bb:10,b:11,"b#":12,bx:13},s=["C","C#","D","D#","E","F","F#","G","G#","A","A#","B"];return a.Frequency.A4=440,a.Frequency.prototype.midiToFrequency=function(t){return a.Frequency.A4*Math.pow(2,(t-69)/12)},a.Frequency.prototype.frequencyToMidi=function(t){return 69+12*Math.log(t/a.Frequency.A4)/Math.LN2},a.Frequency}.apply(t,o),!(r!==void 0&&(e.exports=r))},function(e,t,n){var o,r;o=[n(0),n(16)],r=function(n){return n.TransportTime=function(e,t){return this instanceof n.TransportTime?void n.Time.call(this,e,t):new n.TransportTime(e,t)},n.extend(n.TransportTime,n.Time),n.TransportTime.prototype._unaryExpressions=Object.create(n.Time.prototype._unaryExpressions),n.TransportTime.prototype._unaryExpressions.quantize={regexp:/^@/,method:function(o){var t=this._secondsToTicks(o()),r=Math.ceil(n.Transport.ticks/t);return this._ticksToUnits(r*t)}},n.TransportTime.prototype._secondsToTicks=function(e){var t=e/this._beatsToUnits(1);return Math.round(t*n.Transport.PPQ)},n.TransportTime.prototype.valueOf=function(){return this._secondsToTicks(this._expr())+(this._plusNow?n.Transport.ticks:0)},n.TransportTime.prototype.toTicks=function(){return this.valueOf()},n.TransportTime.prototype.toSeconds=function(){return this._expr()+(this._plusNow?n.Transport.seconds:0)},n.TransportTime.prototype.toFrequency=function(){return 1/this.toSeconds()},n.TransportTime}.apply(t,o),!(r!==void 0&&(e.exports=r))},function(e,t,n){var o,r;o=[n(0),n(4),n(13),n(1),n(33),n(21),n(34),n(20),n(35),n(36),n(37)],r=function(s){"use strict";function a(o,e,n){var r=new o;return n._eval(e[0]).connect(r,0,0),n._eval(e[1]).connect(r,0,1),r}function r(o,e,n){var r=new o;return n._eval(e[0]).connect(r,0,0),r}function t(t){return t?parseFloat(t):void 0}function o(t){return t&&t.args?parseFloat(t.args):void 0}return s.Expr=function(){var a=this._replacements(Array.prototype.slice.call(arguments)),n=this._parseInputs(a);this._nodes=[],this.input=Array(n);for(var e=0;e<n;e++)this.input[e]=this.context.createGain();var i=this._parseTree(a),o;try{o=this._eval(i)}catch(t){throw this._disposeNodes(),new Error("Tone.Expr: Could evaluate expression: "+a)}this.output=o},s.extend(s.Expr,s.SignalBase),s.Expr._Expressions={value:{signal:{regexp:/^\d+\.\d+|^\d+/,method:function(n){return new s.Signal(t(n))}},input:{regexp:/^\$\d/,method:function(o,e){return e.input[t(o.substr(1))]}}},glue:{"(":{regexp:/^\(/},")":{regexp:/^\)/},",":{regexp:/^,/}},func:{abs:{regexp:/^abs/,method:r.bind(this,s.Abs)},mod:{regexp:/^mod/,method:function(a,e){var n=o(a[1]),r=new s.Modulo(n);return e._eval(a[0]).connect(r),r}},pow:{regexp:/^pow/,method:function(a,e){var n=o(a[1]),r=new s.Pow(n);return e._eval(a[0]).connect(r),r}},a2g:{regexp:/^a2g/,method:function(t,e){var n=new s.AudioToGain;return e._eval(t[0]).connect(n),n}}},binary:{"+":{regexp:/^\+/,precedence:1,method:a.bind(this,s.Add)},"-":{regexp:/^\-/,precedence:1,method:function(t,e){return 1===t.length?r(s.Negate,t,e):a(s.Subtract,t,e)}},"*":{regexp:/^\*/,precedence:0,method:a.bind(this,s.Multiply)}},unary:{"-":{regexp:/^\-/,method:r.bind(this,s.Negate)},"!":{regexp:/^\!/,method:r.bind(this,s.NOT)}}},s.Expr.prototype._parseInputs=function(a){var e=a.match(/\$\d/g),n=0;if(null!==e)for(var i=0,s;i<e.length;i++)s=parseInt(e[i].substr(1))+1,n=Math.max(n,s);return n},s.Expr.prototype._replacements=function(t){for(var e=t.shift(),o=0;o<t.length;o++)e=e.replace(/\%/i,t[o]);return e},s.Expr.prototype._tokenize=function(a){function i(u){for(var e in s.Expr._Expressions){var n=s.Expr._Expressions[e];for(var r in n){var t=n[r],o=t.regexp,i=u.match(o);if(null!==i)return{type:e,value:i[0],method:t.method}}}throw new SyntaxError("Tone.Expr: Unexpected token "+u)}for(var o=-1,u=[],r;0<a.length;)r=i(a=a.trim()),u.push(r),a=a.substr(r.value.length);return{next:function(){return u[++o]},peek:function(){return u[o+1]}}},s.Expr.prototype._parseTree=function(n){function u(t,e){return!c(t)&&"glue"===t.type&&t.value===e}function l(a,e,n){var r=s.Expr._Expressions[e];if(!c(a))for(var t in r){var o=r[t];if(o.regexp.test(a.value)){if(c(n))return!0;if(o.precedence===n)return!0}}return!1}function o(t){var a;c(t)&&(t=5),a=0>t?function t(){var e,o;return e=p.peek(),l(e,"unary")?(e=p.next(),o=t(),{operator:e.value,method:e.method,args:[o]}):i()}():o(t-1);for(var s=p.peek();l(s,"binary",t);)a={operator:(s=p.next()).value,method:s.method,args:[a,o(t-1)]},s=p.peek();return a}function i(){var t,r;if(t=p.peek(),c(t))throw new SyntaxError("Tone.Expr: Unexpected termination of expression");if("func"===t.type)return function(t){var e=[];if(!u(p.next(),"("))throw new SyntaxError("Tone.Expr: Expected ( in a function call \""+t.value+"\"");if(u(p.peek(),")")||(e=function(){for(var t=[],n;n=o(),!c(n)&&(t.push(n),u(p.peek(),","));)p.next();return t}()),u(p.next(),")"))return{method:t.method,args:e,name:name};throw new SyntaxError("Tone.Expr: Expected ) in a function call \""+t.value+"\"")}(t=p.next());if("value"===t.type)return{method:(t=p.next()).method,args:t.value};if(u(t,"(")){if(p.next(),r=o(),!u(t=p.next(),")"))throw new SyntaxError("Expected )");return r}throw new SyntaxError("Tone.Expr: Parse error, cannot process token "+t.value)}var p=this._tokenize(n),c=this.isUndef.bind(this);return o()},s.Expr.prototype._eval=function(t){if(!this.isUndef(t)){var e=t.method(t.args,this);return this._nodes.push(e),e}},s.Expr.prototype._disposeNodes=function(){for(var t=0,o;t<this._nodes.length;t++)o=this._nodes[t],this.isFunction(o.dispose)?o.dispose():this.isFunction(o.disconnect)&&o.disconnect(),o=null,this._nodes[t]=null;this._nodes=null},s.Expr.prototype.dispose=function(){s.prototype.dispose.call(this),this._disposeNodes()},s.Expr}.apply(t,o),!(r!==void 0&&(e.exports=r))},function(e,t,n){var o,r;o=[n(0),n(21),n(13),n(2)],r=function(n){"use strict";return n.GreaterThan=function(e){this.createInsOuts(2,0),this._param=this.input[0]=new n.Subtract(e),this.input[1]=this._param.input[1],this._gtz=this.output=new n.GreaterThanZero,this._param.connect(this._gtz)},n.extend(n.GreaterThan,n.Signal),n.GreaterThan.prototype.dispose=function(){return n.prototype.dispose.call(this),this._param.dispose(),this._param=null,this._gtz.dispose(),this._gtz=null,this},n.GreaterThan}.apply(t,o),!(r!==void 0&&(e.exports=r))},function(e,t,n){var o,r;o=[n(0),n(6),n(15)],r=function(e){"use strict";return e.Abs=function(){this._abs=this.input=this.output=new e.WaveShaper(function(e){return 0===e?0:Math.abs(e)},127)},e.extend(e.Abs,e.SignalBase),e.Abs.prototype.dispose=function(){return e.prototype.dispose.call(this),this._abs.dispose(),this._abs=null,this},e.Abs}.apply(t,o),!(r!==void 0&&(e.exports=r))},function(e,t,n){var o,r;o=[n(0),n(6),n(1),n(13)],r=function(e){"use strict";return e.Modulo=function(n){this.createInsOuts(1,0),this._shaper=new e.WaveShaper(Math.pow(2,16)),this._multiply=new e.Multiply,this._subtract=this.output=new e.Subtract,this._modSignal=new e.Signal(n),this.input.fan(this._shaper,this._subtract),this._modSignal.connect(this._multiply,0,0),this._shaper.connect(this._multiply,0,1),this._multiply.connect(this._subtract,0,1),this._setWaveShaper(n)},e.extend(e.Modulo,e.SignalBase),e.Modulo.prototype._setWaveShaper=function(e){this._shaper.setMap(function(n){return Math.floor((n+1e-4)/e)})},Object.defineProperty(e.Modulo.prototype,"value",{get:function(){return this._modSignal.value},set:function(e){this._modSignal.value=e,this._setWaveShaper(e)}}),e.Modulo.prototype.dispose=function(){return e.prototype.dispose.call(this),this._shaper.dispose(),this._shaper=null,this._multiply.dispose(),this._multiply=null,this._subtract.dispose(),this._subtract=null,this._modSignal.dispose(),this._modSignal=null,this},e.Modulo}.apply(t,o),!(r!==void 0&&(e.exports=r))},function(e,t,n){var o,r;o=[n(0),n(6)],r=function(n){"use strict";return n.Pow=function(t){this._exp=this.defaultArg(t,1),this._expScaler=this.input=this.output=new n.WaveShaper(this._expFunc(this._exp),8192)},n.extend(n.Pow,n.SignalBase),Object.defineProperty(n.Pow.prototype,"value",{get:function(){return this._exp},set:function(t){this._exp=t,this._expScaler.setMap(this._expFunc(this._exp))}}),n.Pow.prototype._expFunc=function(n){return function(t){return Math.pow(Math.abs(t),n)}},n.Pow.prototype.dispose=function(){return n.prototype.dispose.call(this),this._expScaler.dispose(),this._expScaler=null,this},n.Pow}.apply(t,o),!(r!==void 0&&(e.exports=r))},function(e,t,n){var o,r;o=[n(0),n(6),n(2)],r=function(e){"use strict";return e.AudioToGain=function(){this._norm=this.input=this.output=new e.WaveShaper(function(e){return(e+1)/2})},e.extend(e.AudioToGain,e.SignalBase),e.AudioToGain.prototype.dispose=function(){return e.prototype.dispose.call(this),this._norm.dispose(),this._norm=null,this},e.AudioToGain}.apply(t,o),!(r!==void 0&&(e.exports=r))},function(e,t,n){var o,r;o=[n(0),n(6)],r=function(t){"use strict";return t.EqualPowerGain=function(){this._eqPower=this.input=this.output=new t.WaveShaper(function(t){return .001>Math.abs(t)?0:this.equalPowerScale(t)}.bind(this),4096)},t.extend(t.EqualPowerGain,t.SignalBase),t.EqualPowerGain.prototype.dispose=function(){return t.prototype.dispose.call(this),this._eqPower.dispose(),this._eqPower=null,this},t.EqualPowerGain}.apply(t,o),!(r!==void 0&&(e.exports=r))},function(e,t,n){var o,r;o=[n(0),n(19),n(9)],r=function(n){"use strict";return n.TimelineState=function(t){n.Timeline.call(this),this._initial=t},n.extend(n.TimelineState,n.Timeline),n.TimelineState.prototype.getValueAtTime=function(n){var e=this.get(n);return null===e?this._initial:e.state},n.TimelineState.prototype.setStateAtTime=function(n,e){this.add({state:n,time:e})},n.TimelineState}.apply(t,o),!(r!==void 0&&(e.exports=r))},function(e,t,n){"use strict";function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e){return r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},r(e)}function a(e){var t=Math.log(e/440)/Math.log(2),n=Math.round(12*t)+69;return n}function i(e){return 440*Math.pow(2,(e-69)/12)}function s(e){if("string"!=typeof e)return e;var t={A:21,B:23,C:24,D:26,E:28,F:29,G:31}[e[0].toUpperCase()],n=~~e.slice(-1);switch(t+=12*(n-1),e[1]){case"#":t+=1;break;case"b":t-=1;break;default:}return i(t)}function u(e){var t;if("string"==typeof e){t=e;var n=t.split(".").pop();if(!(-1<["mp3","wav","ogg","m4a","aac"].indexOf(n)))for(var o=0;o<Un.extensions.length;o++){var a=Un.extensions[o],s=p5.prototype.isFileSupported(a);if(s){t=t+"."+a;break}}else if(!p5.prototype.isFileSupported(n))for(var u=t.split("."),l=u[u.length-1],c=0;c<Un.extensions.length;c++){var d=Un.extensions[c],f=p5.prototype.isFileSupported(d);if(f){l="",2===u.length&&(l+=u[0]);for(var m=1,y;m<=u.length-2;m++)y=u[m],l+="."+y;t=l+=".",t=t+=d;break}}}else if("object"===r(e))for(var h=0;h<e.length;h++){var _=e[h].split(".").pop(),g=p5.prototype.isFileSupported(_);if(g){t=e[h];break}}return t}function l(e){var t,n;t=e.getChannelData(0),n=1<e.numberOfChannels?e.getChannelData(1):t;var o=p(t,n),r=new window.ArrayBuffer(44+2*o.length),a=new window.DataView(r);c(a,0,"RIFF"),a.setUint32(4,36+2*o.length,!0),c(a,8,"WAVE"),c(a,12,"fmt "),a.setUint32(16,16,!0),a.setUint16(20,1,!0),a.setUint16(22,2,!0),a.setUint32(24,Un.audiocontext.sampleRate,!0),a.setUint32(28,4*Un.audiocontext.sampleRate,!0),a.setUint16(32,4,!0),a.setUint16(34,16,!0),c(a,36,"data"),a.setUint32(40,2*o.length,!0);for(var s=o.length,u=44,l=0;l<s;l++)a.setInt16(u,o[l]*(32767*1),!0),u+=2;return a}function p(e,t){for(var n=e.length+t.length,o=new Float32Array(n),r=0,a=0;a<n;)o[a++]=e[r],o[a++]=t[r],r++;return o}function c(e,t,n){for(var o=n.length,r=0;r<o;r++)e.setUint8(t+r,n.charCodeAt(r))}function d(e){var t=e,n=new AudioWorkletNode(Un.audiocontext,Ln.a.soundFileProcessor);return n instanceof ScriptProcessorNode&&(t=n.bufferSize),n.disconnect(),n=null,t}function f(){return Promise.all(zn.map(function(e){var t=new Blob([e],{type:"application/javascript"}),n=URL.createObjectURL(t);return Wn.audioWorklet.addModule(n)}))}function m(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function y(e,t){for(var n=0,o;n<t.length;n++)o=t[n],o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}function h(e,t,n){return t&&y(e.prototype,t),n&&y(e,n),e}function _(e){return _="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},_(e)}function g(e,t){for(var n=0,o;n<t.length;n++)o=t[n],o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}function v(e,t,n){return t&&g(e.prototype,t),n&&g(e,n),e}function b(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function T(t){var e=t.target,o=this;e._playing=!1,e.removeEventListener("ended",o._clearOnEnd),o._onended(o),o.bufferSourceNodes.map(function(e,t){return t}).reverse().forEach(function(e){var t=o.bufferSourceNodes[e];!1===t._playing&&o.bufferSourceNodes.splice(e,1)}),0===o.bufferSourceNodes.length&&(o._playing=!1)}function x(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function k(e,t){for(var n=0,o;n<t.length;n++)o=t[n],o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}function S(e,t,n){return t&&k(e.prototype,t),n&&k(e,n),e}function P(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function A(e,t){for(var n=0,o;n<t.length;n++)o=t[n],o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}function w(e,t,n){return t&&A(e.prototype,t),n&&A(e,n),e}function C(e){!1==e.freqDomain instanceof Float32Array&&(e.freqDomain=new Float32Array(e.analyser.frequencyBinCount))}function O(e){!1==e.freqDomain instanceof Uint8Array&&(e.freqDomain=new Uint8Array(e.analyser.frequencyBinCount))}function q(e){!1==e.timeDomain instanceof Float32Array&&(e.timeDomain=new Float32Array(e.analyser.frequencyBinCount))}function R(e){!1==e.timeDomain instanceof Uint8Array&&(e.timeDomain=new Uint8Array(e.analyser.frequencyBinCount))}function N(e){return N="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},N(e)}function B(e,t){return t&&("object"===N(t)||"function"==typeof t)?t:V(e)}function V(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function E(e){return E=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},E(e)}function F(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&D(e,t)}function D(e,t){return D=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},D(e,t)}function I(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function M(e,t){for(var n=0,o;n<t.length;n++)o=t[n],o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}function U(e,t,n){return t&&M(e.prototype,t),n&&M(e,n),e}function G(e,t,n,o,r){var a=e.oscillator;for(var s in e.mathOps)e.mathOps[s]instanceof r&&(a.disconnect(),e.mathOps[s].dispose(),n=s,n<e.mathOps.length-2&&(o=e.mathOps[s+1]));return n===e.mathOps.length-1&&e.mathOps.push(o),0<s&&(a=e.mathOps[s-1]),a.disconnect(),a.connect(t),t.connect(o),e.mathOps[n]=t,e}function L(e){return L="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},L(e)}function j(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function z(e,t){for(var n=0,o;n<t.length;n++)o=t[n],o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}function W(e,t,n){return t&&z(e.prototype,t),n&&z(e,n),e}function Z(e,t){return t&&("object"===L(t)||"function"==typeof t)?t:X(e)}function X(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Y(e){return Y=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},Y(e)}function H(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Q(e,t)}function Q(e,t){return Q=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},Q(e,t)}function $(e){return $="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},$(e)}function J(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function K(e,t){for(var n=0,o;n<t.length;n++)o=t[n],o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}function ee(e,t,n){return t&&K(e.prototype,t),n&&K(e,n),e}function te(e,t){return t&&("object"===$(t)||"function"==typeof t)?t:ne(e)}function ne(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function oe(e){return oe=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},oe(e)}function re(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&ae(e,t)}function ae(e,t){return ae=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},ae(e,t)}function ie(){for(var e=Un.audiocontext,t=e.createBuffer(1,2048,e.sampleRate),n=t.getChannelData(0),o=0;2048>o;o++)n[o]=1;var r=e.createBufferSource();return r.buffer=t,r.loop=!0,r}function se(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function ue(e,t){for(var n=0,o;n<t.length;n++)o=t[n],o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}function le(e,t,n){return t&&ue(e.prototype,t),n&&ue(e,n),e}function pe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function ce(e,t){for(var n=0,o;n<t.length;n++)o=t[n],o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}function de(e,t,n){return t&&ce(e.prototype,t),n&&ce(e,n),e}function fe(e){return fe="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},fe(e)}function me(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function ye(e,t){for(var n=0,o;n<t.length;n++)o=t[n],o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}function he(e,t,n){return t&&ye(e.prototype,t),n&&ye(e,n),e}function _e(e,t){return t&&("object"===fe(t)||"function"==typeof t)?t:ge(e)}function ge(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function ve(e,t,n){return ve="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var o=be(e,t);if(o){var r=Object.getOwnPropertyDescriptor(o,t);return r.get?r.get.call(n):r.value}},ve(e,t,n||e)}function be(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=Te(e),null!==e););return e}function Te(e){return Te=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},Te(e)}function xe(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&ke(e,t)}function ke(e,t){return ke=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},ke(e,t)}function Se(e){return Se="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Se(e)}function Pe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Ae(e,t){for(var n=0,o;n<t.length;n++)o=t[n],o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}function we(e,t,n){return t&&Ae(e.prototype,t),n&&Ae(e,n),e}function Ce(e,t){return t&&("object"===Se(t)||"function"==typeof t)?t:Oe(e)}function Oe(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function qe(e){return qe=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},qe(e)}function Re(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Ne(e,t)}function Ne(e,t){return Ne=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},Ne(e,t)}function Be(e){return Be="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Be(e)}function Ve(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Ee(e,t){for(var n=0,o;n<t.length;n++)o=t[n],o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}function Fe(e,t,n){return t&&Ee(e.prototype,t),n&&Ee(e,n),e}function De(e,t){return t&&("object"===Be(t)||"function"==typeof t)?t:Ie(e)}function Ie(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Me(e,t,n){return Me="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var o=Ue(e,t);if(o){var r=Object.getOwnPropertyDescriptor(o,t);return r.get?r.get.call(n):r.value}},Me(e,t,n||e)}function Ue(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=Ge(e),null!==e););return e}function Ge(e){return Ge=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},Ge(e)}function Le(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&je(e,t)}function je(e,t){return je=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},je(e,t)}function ze(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function We(e,t){for(var n=0,o;n<t.length;n++)o=t[n],o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}function Ze(e,t,n){return t&&We(e.prototype,t),n&&We(e,n),e}function Xe(e){return Xe="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Xe(e)}function Ye(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function He(e,t){for(var n=0,o;n<t.length;n++)o=t[n],o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}function Qe(e,t,n){return t&&He(e.prototype,t),n&&He(e,n),e}function $e(e,t){return t&&("object"===Xe(t)||"function"==typeof t)?t:Je(e)}function Je(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Ke(e,t,n){return Ke="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var o=et(e,t);if(o){var r=Object.getOwnPropertyDescriptor(o,t);return r.get?r.get.call(n):r.value}},Ke(e,t,n||e)}function et(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=tt(e),null!==e););return e}function tt(e){return tt=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},tt(e)}function nt(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&ot(e,t)}function ot(e,t){return ot=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},ot(e,t)}function rt(e){return rt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},rt(e)}function at(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function it(e,t){for(var n=0,o;n<t.length;n++)o=t[n],o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}function st(e,t,n){return t&&it(e.prototype,t),n&&it(e,n),e}function ut(e,t){return t&&("object"===rt(t)||"function"==typeof t)?t:lt(e)}function lt(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function pt(e,t,n){return pt="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var o=ct(e,t);if(o){var r=Object.getOwnPropertyDescriptor(o,t);return r.get?r.get.call(n):r.value}},pt(e,t,n||e)}function ct(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=dt(e),null!==e););return e}function dt(e){return dt=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},dt(e)}function ft(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&mt(e,t)}function mt(e,t){return mt=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},mt(e,t)}function yt(e){return yt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},yt(e)}function ht(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _t(e,t){for(var n=0,o;n<t.length;n++)o=t[n],o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}function gt(e,t,n){return t&&_t(e.prototype,t),n&&_t(e,n),e}function vt(e,t){return t&&("object"===yt(t)||"function"==typeof t)?t:bt(e)}function bt(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Tt(e,t,n){return Tt="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var o=xt(e,t);if(o){var r=Object.getOwnPropertyDescriptor(o,t);return r.get?r.get.call(n):r.value}},Tt(e,t,n||e)}function xt(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=kt(e),null!==e););return e}function kt(e){return kt=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},kt(e)}function St(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Pt(e,t)}function Pt(e,t){return Pt=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},Pt(e,t)}function At(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function wt(e,t){for(var n=0,o;n<t.length;n++)o=t[n],o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}function Ct(e,t,n){return t&&wt(e.prototype,t),n&&wt(e,n),e}function Ot(e,t){for(var n=0,o;n<t.length;n++)o=t[n],o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}function qt(e,t,n){return t&&Ot(e.prototype,t),n&&Ot(e,n),e}function Rt(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Nt(e){e.currentPart++,e.currentPart>=e.parts.length?(e.scoreStep=0,e.onended()):(e.scoreStep=0,e.parts[e.currentPart-1].stop(),e.parts[e.currentPart].start())}function Bt(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Vt(e,t){for(var n=0,o;n<t.length;n++)o=t[n],o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}function Et(e,t,n){return t&&Vt(e.prototype,t),n&&Vt(e,n),e}function Ft(e){return Ft="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Ft(e)}function Dt(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function It(e,t){for(var n=0,o;n<t.length;n++)o=t[n],o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}function Mt(e,t,n){return t&&It(e.prototype,t),n&&It(e,n),e}function Ut(e,t){return t&&("object"===Ft(t)||"function"==typeof t)?t:Gt(e)}function Gt(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Lt(e,t,n){return Lt="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var o=jt(e,t);if(o){var r=Object.getOwnPropertyDescriptor(o,t);return r.get?r.get.call(n):r.value}},Lt(e,t,n||e)}function jt(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=zt(e),null!==e););return e}function zt(e){return zt=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},zt(e)}function Wt(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Zt(e,t)}function Zt(e,t){return Zt=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},Zt(e,t)}function Xt(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Yt(e,t){for(var n=0,o;n<t.length;n++)o=t[n],o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}function Ht(e,t,n){return t&&Yt(e.prototype,t),n&&Yt(e,n),e}function Qt(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function $t(e,t){for(var n=0,o;n<t.length;n++)o=t[n],o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}function Jt(e,t,n){return t&&$t(e.prototype,t),n&&$t(e,n),e}function Kt(e){return Kt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Kt(e)}function en(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function tn(e,t){for(var n=0,o;n<t.length;n++)o=t[n],o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}function nn(e,t,n){return t&&tn(e.prototype,t),n&&tn(e,n),e}function on(e,t){return t&&("object"===Kt(t)||"function"==typeof t)?t:rn(e)}function rn(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function an(e,t,n){return an="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var o=sn(e,t);if(o){var r=Object.getOwnPropertyDescriptor(o,t);return r.get?r.get.call(n):r.value}},an(e,t,n||e)}function sn(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=un(e),null!==e););return e}function un(e){return un=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},un(e)}function ln(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&pn(e,t)}function pn(e,t){return pn=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},pn(e,t)}function cn(e){for(var t="number"==typeof e?e:50,n=44100,o=new Float32Array(n),r=Math.PI/180,a=0,s;a<n;++a)s=2*a/n-1,o[a]=20*((3+t)*s)*r/(Math.PI+t*Math.abs(s));return o}function dn(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function fn(e,t){for(var n=0,o;n<t.length;n++)o=t[n],o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}function mn(e,t,n){return t&&fn(e.prototype,t),n&&fn(e,n),e}function yn(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function hn(e,t){for(var n=0,o;n<t.length;n++)o=t[n],o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}function _n(e,t,n){return t&&hn(e.prototype,t),n&&hn(e,n),e}function gn(e){return gn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},gn(e)}function vn(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function bn(e,t){for(var n=0,o;n<t.length;n++)o=t[n],o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}function Tn(e,t,n){return t&&bn(e.prototype,t),n&&bn(e,n),e}function xn(e,t){return t&&("object"===gn(t)||"function"==typeof t)?t:kn(e)}function kn(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Sn(e,t,n){return Sn="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var o=Pn(e,t);if(o){var r=Object.getOwnPropertyDescriptor(o,t);return r.get?r.get.call(n):r.value}},Sn(e,t,n||e)}function Pn(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=An(e),null!==e););return e}function An(e){return An=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},An(e)}function wn(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Cn(e,t)}function Cn(e,t){return Cn=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},Cn(e,t)}function On(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function qn(e,t){for(var n=0,o;n<t.length;n++)o=t[n],o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}function Rn(e,t,n){return t&&qn(e.prototype,t),n&&qn(e,n),e}function Nn(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Bn(e,t){for(var n=0,o;n<t.length;n++)o=t[n],o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}function Vn(e,t,n){return t&&Bn(e.prototype,t),n&&Bn(e,n),e}function En(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}n.r(t);var Fn=n(24),Dn=n(25),In=n(3),Mn=new function e(){o(this,e),this.input=In.a.createGain(),this.output=In.a.createGain(),this.limiter=In.a.createDynamicsCompressor(),this.limiter.threshold.value=-3,this.limiter.ratio.value=20,this.limiter.knee.value=1,this.audiocontext=In.a,this.output.disconnect(),this.input.connect(this.limiter),this.limiter.connect(this.output),this.meter=In.a.createGain(),this.fftMeter=In.a.createGain(),this.output.connect(this.meter),this.output.connect(this.fftMeter),this.output.connect(this.audiocontext.destination),this.soundArray=[],this.parts=[],this.extensions=[]};p5.prototype.getOutputVolume=function(){return Mn.output.gain.value},p5.prototype.outputVolume=function(e){var t=1<arguments.length&&arguments[1]!==void 0?arguments[1]:0,n=2<arguments.length&&arguments[2]!==void 0?arguments[2]:0;if("number"==typeof e){var o=Mn.audiocontext.currentTime,r=Mn.output.gain.value;Mn.output.gain.cancelScheduledValues(o+n),Mn.output.gain.linearRampToValueAtTime(r,o+n),Mn.output.gain.linearRampToValueAtTime(e,o+n+t)}else if(e)e.connect(Mn.output.gain);else return Mn.output.gain},p5.prototype.soundOut=p5.soundOut=Mn,p5.soundOut._silentNode=Mn.audiocontext.createGain(),p5.soundOut._silentNode.gain.value=0,p5.soundOut._silentNode.connect(Mn.audiocontext.destination);var Un=Mn,Gn=n(5),Ln=n.n(Gn),jn=function(e,t,n){var o=new Error,r,a;return o.name=e,o.originalStack=o.stack+t,r=o.stack+t,o.failedPath=n,a=r.split("\n").filter(function(e){return!e.match(/(p5.|native code|globalInit)/g)}),o.stack=a.join("\n"),o},zn=[n(27)["default"],n(28)["default"],n(29)["default"]],Wn=Un.audiocontext,Zn=!1;p5.prototype.registerMethod("init",function(){if(!Zn){this.preload||window.preload||(this.preload=function(){}),this._incrementPreload();var e=function(){Zn=!0,this._decrementPreload()}.bind(this);f().then(e)}});var Xn=Un.audiocontext,Yn;if("undefined"!=typeof Xn.createStereoPanner){var Hn=function(){function e(t,n){m(this,e),this.stereoPanner=this.input=Xn.createStereoPanner(),t.connect(this.stereoPanner),this.stereoPanner.connect(n)}return h(e,[{key:"pan",value:function(e,n){var o=Xn.currentTime+(n||0);this.stereoPanner.pan.linearRampToValueAtTime(e,o)}},{key:"inputChannels",value:function(){}},{key:"connect",value:function(e){this.stereoPanner.connect(e)}},{key:"disconnect",value:function(){this.stereoPanner&&this.stereoPanner.disconnect()}}]),e}();Yn=Hn}else{var Qn=function(){function e(t,n,o){m(this,e),this.input=Xn.createGain(),t.connect(this.input),this.left=Xn.createGain(),this.right=Xn.createGain(),this.left.channelInterpretation="discrete",this.right.channelInterpretation="discrete",1<o?(this.splitter=Xn.createChannelSplitter(2),this.input.connect(this.splitter),this.splitter.connect(this.left,1),this.splitter.connect(this.right,0)):(this.input.connect(this.left),this.input.connect(this.right)),this.output=Xn.createChannelMerger(2),this.left.connect(this.output,0,1),this.right.connect(this.output,0,0),this.output.connect(n)}return h(e,[{key:"pan",value:function(e,n){var o=Xn.currentTime+(n||0),t=(e+1)/2,r=Math.cos(t*Math.PI/2),a=Math.sin(t*Math.PI/2);this.left.gain.linearRampToValueAtTime(a,o),this.right.gain.linearRampToValueAtTime(r,o)}},{key:"inputChannels",value:function(e){1===e?(this.input.disconnect(),this.input.connect(this.left),this.input.connect(this.right)):2==e&&("undefined"==typeof this.splitter&&(this.splitter=Xn.createChannelSplitter(2)),this.input.disconnect(),this.input.connect(this.splitter),this.splitter.connect(this.left,1),this.splitter.connect(this.right,0))}},{key:"connect",value:function(e){this.output.connect(e)}},{key:"disconnect",value:function(){this.output&&this.output.disconnect()}}]),e}();Yn=Qn}var $n=Yn,Jn=Un.audiocontext,Kn=function(e){for(var t=e.length,n=Jn.createBuffer(1,e.length,Jn.sampleRate),o=n.getChannelData(0),r=0;r<t;r++)o[r]=r;return n},eo=function e(t,n,o,r){b(this,e),this.callback=t,this.time=n,this.id=o,this.val=r},to=function(){function e(t,n,o,r){if(b(this,e),"undefined"!=typeof t){if("string"==typeof t||"string"==typeof t[0]){var a=p5.prototype._checkFileFormats(t);this.url=a}else if("object"===_(t)&&!(window.File&&window.FileReader&&window.FileList&&window.Blob))throw"Unable to load file because the File API is not supported";t.file&&(t=t.file),this.file=t}this._onended=function(){},this._looping=!1,this._playing=!1,this._paused=!1,this._pauseTime=0,this._cues=[],this._cueIDCounter=0,this._lastPos=0,this._counterNode=null,this._workletNode=null,this.bufferSourceNodes=[],this.bufferSourceNode=null,this.buffer=null,this.playbackRate=1,this.input=Un.audiocontext.createGain(),this.output=Un.audiocontext.createGain(),this.reversed=!1,this.startTime=0,this.endTime=null,this.pauseTime=0,this.mode="sustain",this.startMillis=null,this.panPosition=0,this.panner=new $n(this.output,Un.input,2),(this.url||this.file)&&this.load(n,o),Un.soundArray.push(this),this._whileLoading="function"==typeof r?r:function(){},this._clearOnEnd=T.bind(this),this.amp=this.setVolume,this.fade=this.setVolume}return v(e,[{key:"load",value:function(e,t){var n=this,o=new Error().stack;if(void 0!==this.url&&""!==this.url){var r=new XMLHttpRequest;r.addEventListener("progress",function(e){n._updateProgress(e)},!1),r.open("GET",this.url,!0),r.responseType="arraybuffer",r.onload=function(){if(200===r.status){if(!n.panner)return;Jn.decodeAudioData(r.response,function(t){n.panner&&(n.buffer=t,n.panner.inputChannels(t.numberOfChannels),e&&e(n))},function(){if(n.panner){var e=new jn("decodeAudioData",o,n.url),r="AudioContext error at decodeAudioData for "+n.url;t?(e.msg=r,t(e)):console.error(r+"\n The error stack trace includes: \n"+e.stack)}})}else{if(!n.panner)return;var a=new jn("loadSound",o,n.url),i="Unable to load "+n.url+". The request status was: "+r.status+" ("+r.statusText+")";t?(a.message=i,t(a)):console.error(i+"\n The error stack trace includes: \n"+a.stack)}},r.onerror=function(){var e=new jn("loadSound",o,n.url),r="There was no response from the server at "+n.url+". Check the url and internet connectivity.";t?(e.message=r,t(e)):console.error(r+"\n The error stack trace includes: \n"+e.stack)},r.send()}else if(void 0!==this.file){var a=new FileReader;a.onload=function(){n.panner&&Jn.decodeAudioData(a.result,function(t){n.panner&&(n.buffer=t,n.panner.inputChannels(t.numberOfChannels),e&&e(n))})},a.onerror=function(t){!n.panner||onerror&&onerror(t)},a.readAsArrayBuffer(this.file)}}},{key:"_updateProgress",value:function(e){if(e.lengthComputable){var t=.99*(e.loaded/e.total);this._whileLoading(t,e)}else this._whileLoading("size unknown")}},{key:"isLoaded",value:function(){return!!this.buffer}},{key:"play",value:function(e,t,n,o,r){if(!this.output)return void console.warn("SoundFile.play() called after dispose");var a=Un.audiocontext.currentTime,i=e||0,s,u;if(0>i&&(i=0),i+=a,"undefined"!=typeof t&&this.rate(t),"undefined"!=typeof n&&this.setVolume(n),this.buffer){if(this._pauseTime=0,"restart"===this.mode&&this.buffer&&this.bufferSourceNode&&(this.bufferSourceNode.stop(i),this._counterNode.stop(i)),"untildone"===this.mode&&this.isPlaying())return;if(this.bufferSourceNode=this._initSourceNode(),delete this._counterNode,this._counterNode=this._initCounterNode(),!o)s=0;else if(0<=o&&o<this.buffer.duration)s=o;else throw"start time out of range";r&&(r=r<=this.buffer.duration-s?r:this.buffer.duration),this._paused?(this.bufferSourceNode.start(i,this.pauseTime,r),this._counterNode.start(i,this.pauseTime,r)):(this.bufferSourceNode.start(i,s,r),this._counterNode.start(i,s,r)),this._playing=!0,this._paused=!1,this.bufferSourceNodes.push(this.bufferSourceNode),this.bufferSourceNode._arrayIndex=this.bufferSourceNodes.length-1,this.bufferSourceNode.addEventListener("ended",this._clearOnEnd)}else throw"not ready to play file, buffer has yet to load. Try preload()";this.bufferSourceNode.loop=this._looping,this._counterNode.loop=this._looping,!0===this._looping&&(u=r?r:s-1e-15,this.bufferSourceNode.loopStart=s,this.bufferSourceNode.loopEnd=u,this._counterNode.loopStart=s,this._counterNode.loopEnd=u)}},{key:"playMode",value:function(e){var t=e.toLowerCase();if("restart"===t&&this.buffer&&this.bufferSourceNode)for(var n=0,o;n<this.bufferSourceNodes.length-1;n++)o=Un.audiocontext.currentTime,this.bufferSourceNodes[n].stop(o);if("restart"===t||"sustain"===t||"untildone"===t)this.mode=t;else throw"Invalid play mode. Must be either \"restart\" or \"sustain\""}},{key:"pause",value:function(e){var t=Un.audiocontext.currentTime,n=(e||0)+t;this.isPlaying()&&this.buffer&&this.bufferSourceNode?(this._paused=!0,this._playing=!1,this.pauseTime=this.currentTime(),this.bufferSourceNode.stop(n),this._counterNode.stop(n),this._pauseTime=this.currentTime()):this._pauseTime=0}},{key:"loop",value:function(e,t,n,o,r){this._looping=!0,this.play(e,t,n,o,r)}},{key:"setLoop",value:function(e){if(!0===e)this._looping=!0;else if(!1===e)this._looping=!1;else throw"Error: setLoop accepts either true or false";this.bufferSourceNode&&(this.bufferSourceNode.loop=this._looping,this._counterNode.loop=this._looping)}},{key:"isLooping",value:function(){return!!this.bufferSourceNode&&!0===this._looping&&!0===this.isPlaying()}},{key:"isPlaying",value:function(){return this._playing}},{key:"isPaused",value:function(){return this._paused}},{key:"stop",value:function(e){var n=e||0;if("sustain"===this.mode||"untildone"===this.mode)this.stopAll(n),this._playing=!1,this.pauseTime=0,this._paused=!1;else if(this.buffer&&this.bufferSourceNode){var o=Un.audiocontext.currentTime,r=n||0;this.pauseTime=0,this.bufferSourceNode.stop(o+r),this._counterNode.stop(o+r),this._playing=!1,this._paused=!1}}},{key:"stopAll",value:function(e){var t=Un.audiocontext.currentTime,n=e||0;if(this.buffer&&this.bufferSourceNode){for(var o in this.bufferSourceNodes){var r=this.bufferSourceNodes[o];if(r)try{r.stop(t+n)}catch(t){}}this._counterNode.stop(t+n)}}},{key:"getVolume",value:function(){return this.output.gain.value}},{key:"pan",value:function(e,t){this.panPosition=e,this.panner.pan(e,t)}},{key:"getPan",value:function(){return this.panPosition}},{key:"rate",value:function(e){var t=!1;if("undefined"==typeof e)return this.playbackRate;if(this.playbackRate=e,0===e?e=1e-13:0>e&&!this.reversed?(e=Math.abs(e),t=!0):0<e&&this.reversed&&(t=!0),this.bufferSourceNode){var n=Un.audiocontext.currentTime;this.bufferSourceNode.playbackRate.cancelScheduledValues(n),this.bufferSourceNode.playbackRate.linearRampToValueAtTime(Math.abs(e),n),this._counterNode.playbackRate.cancelScheduledValues(n),this._counterNode.playbackRate.linearRampToValueAtTime(Math.abs(e),n)}return t&&this.reverseBuffer(),this.playbackRate}},{key:"setPitch",value:function(e){var t=i(e)/i(60);this.rate(t)}},{key:"getPlaybackRate",value:function(){return this.playbackRate}},{key:"setVolume",value:function(e,t,n){if("number"==typeof e){var o=n||0,r=Un.audiocontext.currentTime,a=this.output.gain.value;this.output.gain.cancelScheduledValues(r+o),this.output.gain.linearRampToValueAtTime(a,r+o),this.output.gain.linearRampToValueAtTime(e,r+o+(t||0))}else if(e)e.connect(this.output.gain);else return this.output.gain}},{key:"duration",value:function(){return this.buffer?this.buffer.duration:0}},{key:"currentTime",value:function(){return this.reversed?Math.abs(this._lastPos-this.buffer.length)/Jn.sampleRate:this._lastPos/Jn.sampleRate}},{key:"jump",value:function(e,t){if(0>e||e>this.buffer.duration)throw"jump time out of range";if(t>this.buffer.duration-e)throw"end time out of range";this.isPlaying()&&(this.stop(0),this.play(0,this.playbackRate,this.output.gain.value,e||0,t||void 0))}},{key:"channels",value:function(){return this.buffer.numberOfChannels}},{key:"sampleRate",value:function(){return this.buffer.sampleRate}},{key:"frames",value:function(){return this.buffer.length}},{key:"getPeaks",value:function(e){if(!this.buffer)throw"Cannot load peaks yet, buffer is not loaded";else if(e||(e=5*window.width),this.buffer){for(var t=this.buffer,n=t.length/e,o=t.numberOfChannels,r=new Float32Array(Math.round(e)),a=0,s;a<o;a++){s=t.getChannelData(a);for(var u=0;u<e;u++){for(var l=~~(u*n),p=0,d=l,f;d<~~(l+n);d+=~~(n/10)||1)f=s[d],f>p?p=f:-f>p&&(p=f);(0===a||Math.abs(p)>r[u])&&(r[u]=p)}}return r}}},{key:"reverseBuffer",value:function(){if(this.buffer){var e=this._lastPos/Jn.sampleRate,t=this.getVolume();this.setVolume(0,.001);for(var n=this.buffer.numberOfChannels,o=0;o<n;o++)this.buffer.getChannelData(o).reverse();this.reversed=!this.reversed,this.isPlaying()&&e&&this.jump(this.duration()-e),this.setVolume(t,.001)}else throw"SoundFile is not done loading"}},{key:"onended",value:function(e){return this._onended=e,this}},{key:"add",value:function(){}},{key:"dispose",value:function(){var e=Un.audiocontext.currentTime,t=Un.soundArray.indexOf(this);if(Un.soundArray.splice(t,1),this.stop(e),this.buffer&&this.bufferSourceNode){for(var n=0;n<this.bufferSourceNodes.length-1;n++)if(null!==this.bufferSourceNodes[n]){this.bufferSourceNodes[n].disconnect();try{this.bufferSourceNodes[n].stop(e)}catch(t){console.warn("no buffer source node to dispose")}this.bufferSourceNodes[n]=null}if(this.isPlaying()){try{this._counterNode.stop(e)}catch(t){console.log(t)}this._counterNode=null}}this.output&&(this.output.disconnect(),this.output=null),this.panner&&(this.panner.disconnect(),this.panner=null)}},{key:"connect",value:function(e){e?e.hasOwnProperty("input")?this.panner.connect(e.input):this.panner.connect(e):this.panner.connect(Un.input)}},{key:"disconnect",value:function(){this.panner&&this.panner.disconnect()}},{key:"getLevel",value:function(){console.warn("p5.SoundFile.getLevel has been removed from the library. Use p5.Amplitude instead")}},{key:"setPath",value:function(e,t){var n=p5.prototype._checkFileFormats(e);this.url=n,this.load(t)}},{key:"setBuffer",value:function(e){var t=e.length,n=e[0].length,o=Jn.createBuffer(t,n,Jn.sampleRate);e[0]instanceof Float32Array||(e[0]=new Float32Array(e[0]));for(var r=0,a;r<t;r++)a=o.getChannelData(r),a.set(e[r]);this.buffer=o,this.panner.inputChannels(t)}},{key:"_initCounterNode",value:function(){var e=this,t=this,n=Jn.currentTime,o=Jn.createBufferSource(),r=d(256);return t._workletNode&&(t._workletNode.disconnect(),delete t._workletNode),t._workletNode=new AudioWorkletNode(Jn,Ln.a.soundFileProcessor,{processorOptions:{bufferSize:r}}),t._workletNode.port.onmessage=function(n){if("position"===n.data.name){if(0===n.data.position)return;e._lastPos=n.data.position,e._onTimeUpdate(t._lastPos)}},o.buffer=Kn(t.buffer),o.playbackRate.setValueAtTime(t.playbackRate,n),o.connect(t._workletNode),t._workletNode.connect(p5.soundOut._silentNode),o}},{key:"_initSourceNode",value:function(){var e=Jn.createBufferSource();return e.buffer=this.buffer,e.playbackRate.value=this.playbackRate,e.connect(this.output),e}},{key:"processPeaks",value:function(){console.warn("processPeaks is deprecated")}},{key:"addCue",value:function(e,t,n){var o=this._cueIDCounter++,r=new eo(t,e,o,n);return this._cues.push(r),o}},{key:"removeCue",value:function(e){for(var t=this._cues.length,n=0,o;n<t;n++)if(o=this._cues[n],o.id===e){this._cues.splice(n,1);break}0===this._cues.length}},{key:"clearCues",value:function(){this._cues=[]}},{key:"_onTimeUpdate",value:function(e){for(var t=e/this.buffer.sampleRate,n=this._cues.length,o=0;o<n;o++){var r=this._cues[o],a=r.time,s=r.val,u=this._prevUpdateTime||0;u<=a&&a<=t&&r.callback(s)}this._prevUpdateTime=t}},{key:"save",value:function(e){p5.prototype.saveSound(this,e,"wav")}},{key:"getBlob",value:function(){var e=l(this.buffer);return new Blob([e],{type:"audio/wav"})}}]),e}(),no=function(){function e(t){x(this,e),this.bufferSize=d(2048),this.audiocontext=Un.audiocontext,this._workletNode=new AudioWorkletNode(this.audiocontext,Ln.a.amplitudeProcessor,{outputChannelCount:[1],parameterData:{smoothing:t||0},processorOptions:{normalize:!1,smoothing:t||0,numInputChannels:2,bufferSize:this.bufferSize}}),this._workletNode.port.onmessage=function(e){"amplitude"===e.data.name&&(this.volume=e.data.volume,this.volNorm=e.data.volNorm,this.stereoVol=e.data.stereoVol,this.stereoVolNorm=e.data.stereoVolNorm)}.bind(this),this.input=this._workletNode,this.output=this.audiocontext.createGain(),this.volume=0,this.volNorm=0,this.stereoVol=[0,0],this.stereoVolNorm=[0,0],this.normalize=!1,this._workletNode.connect(this.output),this.output.gain.value=0,this.output.connect(this.audiocontext.destination),Un.meter.connect(this._workletNode),Un.soundArray.push(this)}return S(e,[{key:"setInput",value:function(e,t){Un.meter.disconnect(),t&&(this._workletNode.parameters.get("smoothing").value=t),null==e?(console.log("Amplitude input source is not ready! Connecting to main output instead"),Un.meter.connect(this._workletNode)):e?(e.connect(this._workletNode),this._workletNode.disconnect(),this._workletNode.connect(this.output)):Un.meter.connect(this._workletNode)}},{key:"connect",value:function(e){e?e.hasOwnProperty("input")?this.output.connect(e.input):this.output.connect(e):this.output.connect(this.panner.connect(Un.input))}},{key:"disconnect",value:function(){this.output&&this.output.disconnect()}},{key:"getLevel",value:function(e){return"undefined"==typeof e?this.normalize?this.volNorm:this.volume:this.normalize?this.stereoVolNorm[e]:this.stereoVol[e]}},{key:"toggleNormalize",value:function(e){this.normalize="boolean"==typeof e?e:!this.normalize,this._workletNode.port.postMessage({name:"toggleNormalize",normalize:this.normalize})}},{key:"smooth",value:function(e){0<=e&&1>e?this._workletNode.port.postMessage({name:"smoothing",smoothing:e}):console.log("Error: smoothing must be between 0 and 1")}},{key:"dispose",value:function(){var e=Un.soundArray.indexOf(this);Un.soundArray.splice(e,1),this.input&&(this.input.disconnect(),delete this.input),this.output&&(this.output.disconnect(),delete this.output),this._workletNode.disconnect(),delete this._workletNode}}]),e}(),oo=no,ro=function(){function e(t,n){P(this,e),this.input=this.analyser=Un.audiocontext.createAnalyser(),Object.defineProperties(this,{bins:{get:function(){return this.analyser.fftSize/2},set:function(e){this.analyser.fftSize=2*e},configurable:!0,enumerable:!0},smoothing:{get:function(){return this.analyser.smoothingTimeConstant},set:function(e){this.analyser.smoothingTimeConstant=e},configurable:!0,enumerable:!0}}),this.smooth(t),this.bins=n||1024,Un.fftMeter.connect(this.analyser),this.freqDomain=new Uint8Array(this.analyser.frequencyBinCount),this.timeDomain=new Uint8Array(this.analyser.frequencyBinCount),this.bass=[20,140],this.lowMid=[140,400],this.mid=[400,2600],this.highMid=[2600,5200],this.treble=[5200,14e3],Un.soundArray.push(this)}return w(e,[{key:"setInput",value:function(e){e?(e.output?e.output.connect(this.analyser):e.connect&&e.connect(this.analyser),Un.fftMeter.disconnect()):Un.fftMeter.connect(this.analyser)}},{key:"waveform",value:function(){for(var e=[],t=0,n,o;t<arguments.length;t++)"number"==typeof arguments[t]&&(n=arguments[t],this.analyser.fftSize=2*n),"string"==typeof arguments[t]&&(o=arguments[t]);if(o&&!p5.prototype._isSafari())return q(this,this.timeDomain),this.analyser.getFloatTimeDomainData(this.timeDomain),this.timeDomain;R(this,this.timeDomain),this.analyser.getByteTimeDomainData(this.timeDomain);for(var r=0,a;r<this.timeDomain.length;r++)a=p5.prototype.map(this.timeDomain[r],0,255,-1,1),e.push(a);return e}},{key:"analyze",value:function(){for(var e=0,t;e<arguments.length;e++)"number"==typeof arguments[e]&&(this.bins=arguments[e],this.analyser.fftSize=2*this.bins),"string"==typeof arguments[e]&&(t=arguments[e]);if(t&&"db"===t.toLowerCase())return C(this),this.analyser.getFloatFrequencyData(this.freqDomain),this.freqDomain;O(this,this.freqDomain),this.analyser.getByteFrequencyData(this.freqDomain);var n=Array.apply([],this.freqDomain);return n}},{key:"getEnergy",value:function(e,t){var n=Un.audiocontext.sampleRate/2;if("bass"===e?(e=this.bass[0],t=this.bass[1]):"lowMid"===e?(e=this.lowMid[0],t=this.lowMid[1]):"mid"===e?(e=this.mid[0],t=this.mid[1]):"highMid"===e?(e=this.highMid[0],t=this.highMid[1]):"treble"===e&&(e=this.treble[0],t=this.treble[1]),"number"!=typeof e)throw"invalid input for getEnergy()";else{if(!t){var o=Math.round(e/n*this.freqDomain.length);return this.freqDomain[o]}if(e&&t){if(e>t){var r=t;t=e,e=r}for(var a=Math.round(e/n*this.freqDomain.length),s=Math.round(t/n*this.freqDomain.length),u=0,l=0,p=a;p<=s;p++)u+=this.freqDomain[p],l+=1;var c=u/l;return c}throw"invalid input for getEnergy()"}}},{key:"getFreq",value:function(e,t){console.log("getFreq() is deprecated. Please use getEnergy() instead.");var n=this.getEnergy(e,t);return n}},{key:"getCentroid",value:function(){for(var e=Un.audiocontext.sampleRate/2,t=0,n=0,o=0;o<this.freqDomain.length;o++)t+=o*this.freqDomain[o],n+=this.freqDomain[o];var r=0;0!==n&&(r=t/n);var a=r*(e/this.freqDomain.length);return a}},{key:"smooth",value:function(e){return"undefined"!=typeof e&&(this.smoothing=e),this.smoothing}},{key:"dispose",value:function(){var e=Un.soundArray.indexOf(this);Un.soundArray.splice(e,1),this.analyser&&(this.analyser.disconnect(),delete this.analyser)}},{key:"linAverages",value:function(e){for(var t=e||16,n=this.freqDomain,o=n.length,r=Math.floor(o/t),a=Array(t),i=0,s=0;s<o;s++)a[i]=void 0===a[i]?n[s]:(a[i]+n[s])/2,s%r==r-1&&i++;return a}},{key:"logAverages",value:function e(t){for(var n=Un.audiocontext.sampleRate/2,o=this.freqDomain,r=o.length,e=Array(t.length),a=0,i=0,s;i<r;i++)s=Math.round(i*n/this.freqDomain.length),s>t[a].hi&&a++,e[a]=void 0===e[a]?o[i]:(e[a]+o[i])/2;return e}},{key:"getOctaveBands",value:function(e,t){var n=e||3,o=t||15.625,r=[],a={lo:o/Math.pow(2,1/(2*n)),ctr:o,hi:o*Math.pow(2,1/(2*n))};r.push(a);for(var i=Un.audiocontext.sampleRate/2,s;a.hi<i;)s={},s.lo=a.hi,s.ctr=a.ctr*Math.pow(2,1/n),s.hi=s.ctr*Math.pow(2,1/(2*n)),r.push(s),a=s;return r}}]),e}(),ao=n(4),io=n.n(ao),so=n(1),uo=n.n(so),lo=n(8),po=n.n(lo),co=function(){function e(t,n){if(I(this,e),"string"==typeof t){var o=n;n=t,t=o}if("number"==typeof n){var r=n;n=t,t=r}this.started=!1,this.phaseAmount=void 0,this.oscillator=Un.audiocontext.createOscillator(),this.f=t||440,this.oscillator.type=n||"sine",this.oscillator.frequency.setValueAtTime(this.f,Un.audiocontext.currentTime),this.output=Un.audiocontext.createGain(),this._freqMods=[],this.output.gain.value=.5,this.output.gain.setValueAtTime(.5,Un.audiocontext.currentTime),this.oscillator.connect(this.output),this.panPosition=0,this.connection=Un.input,this.panner=new $n(this.output,this.connection,1),this.mathOps=[this.output],Un.soundArray.push(this),this.fade=this.amp}return U(e,[{key:"start",value:function(e,t){if(this.started){var n=Un.audiocontext.currentTime;this.stop(n)}if(!this.started){var o=t||this.f,r=this.oscillator.type;for(var a in this.oscillator&&(this.oscillator.disconnect(),delete this.oscillator),this.oscillator=Un.audiocontext.createOscillator(),this.oscillator.frequency.value=Math.abs(o),this.oscillator.type=r,this.oscillator.connect(this.output),e=e||0,this.oscillator.start(e+Un.audiocontext.currentTime),this.freqNode=this.oscillator.frequency,this._freqMods)"undefined"!=typeof this._freqMods[a].connect&&this._freqMods[a].connect(this.oscillator.frequency);this.started=!0}}},{key:"stop",value:function(e){if(this.started){var t=Un.audiocontext.currentTime;this.oscillator.stop((e||0)+t),this.started=!1}}},{key:"amp",value:function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0,n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:0;if("number"==typeof e){var o=Un.audiocontext.currentTime;this.output.gain.linearRampToValueAtTime(e,o+n+t)}else if(e)e.connect(this.output.gain);else return this.output.gain}},{key:"getAmp",value:function(){return this.output.gain.value}},{key:"freq",value:function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0,n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:0;if("number"==typeof e&&!isNaN(e)){this.f=e;var o=Un.audiocontext.currentTime;0===t?this.oscillator.frequency.setValueAtTime(e,n+o):0<e?this.oscillator.frequency.exponentialRampToValueAtTime(e,n+t+o):this.oscillator.frequency.linearRampToValueAtTime(e,n+t+o),this.phaseAmount&&this.phase(this.phaseAmount)}else if(e)e.output&&(e=e.output),e.connect(this.oscillator.frequency),this._freqMods.push(e);else return this.oscillator.frequency}},{key:"getFreq",value:function(){return this.oscillator.frequency.value}},{key:"setType",value:function(e){this.oscillator.type=e}},{key:"getType",value:function(){return this.oscillator.type}},{key:"connect",value:function(e){e?e.hasOwnProperty("input")?(this.panner.connect(e.input),this.connection=e.input):(this.panner.connect(e),this.connection=e):this.panner.connect(Un.input)}},{key:"disconnect",value:function(){this.output&&this.output.disconnect(),this.panner&&(this.panner.disconnect(),this.output&&this.output.connect(this.panner)),this.oscMods=[]}},{key:"pan",value:function(e,t){this.panPosition=e,this.panner.pan(e,t)}},{key:"getPan",value:function(){return this.panPosition}},{key:"dispose",value:function(){var e=Un.soundArray.indexOf(this);if(Un.soundArray.splice(e,1),this.oscillator){var t=Un.audiocontext.currentTime;this.stop(t),this.disconnect(),this.panner=null,this.oscillator=null}this.osc2&&this.osc2.dispose()}},{key:"phase",value:function(e){var t=p5.prototype.map(e,0,1,0,1/this.f),n=Un.audiocontext.currentTime;this.phaseAmount=e,this.dNode||(this.dNode=Un.audiocontext.createDelay(),this.oscillator.disconnect(),this.oscillator.connect(this.dNode),this.dNode.connect(this.output)),this.dNode.delayTime.setValueAtTime(t,n)}},{key:"add",value:function e(t){var e=new io.a(t),n=this.mathOps.length-1,o=this.output;return G(this,e,n,o,io.a)}},{key:"mult",value:function e(t){var e=new uo.a(t),n=this.mathOps.length-1,o=this.output;return G(this,e,n,o,uo.a)}},{key:"scale",value:function e(t,n,o,r){var a,i;4===arguments.length?(a=p5.prototype.map(o,t,n,0,1)-.5,i=p5.prototype.map(r,t,n,0,1)-.5):(a=arguments[0],i=arguments[1]);var e=new po.a(a,i),s=this.mathOps.length-1,u=this.output;return G(this,e,s,u,po.a)}}]),e}(),fo=function(e){function t(e){return I(this,t),B(this,E(t).call(this,e,"sine"))}return F(t,e),t}(co),mo=function(e){function t(e){return I(this,t),B(this,E(t).call(this,e,"triangle"))}return F(t,e),t}(co),yo=function(e){function t(e){return I(this,t),B(this,E(t).call(this,e,"sawtooth"))}return F(t,e),t}(co),ho=function(e){function t(e){return I(this,t),B(this,E(t).call(this,e,"square"))}return F(t,e),t}(co),_o=co,go=n(7),vo=n.n(go);p5.Envelope=function(e,t,n,o,r,a){this.aTime=e||.1,this.aLevel=t||1,this.dTime=n||.5,this.dLevel=o||0,this.rTime=r||0,this.rLevel=a||0,this._rampHighPercentage=.98,this._rampLowPercentage=.02,this.output=Un.audiocontext.createGain(),this.control=new vo.a,this._init(),this.control.connect(this.output),this.connection=null,this.mathOps=[this.control],this.isExponential=!1,this.sourceToClear=null,this.wasTriggered=!1,Un.soundArray.push(this)},p5.Envelope.prototype._init=function(){var e=Un.audiocontext.currentTime;this.control.setTargetAtTime(1e-5,e,.001),this._setRampAD(this.aTime,this.dTime)},p5.Envelope.prototype.set=function(e,t,n,o,r,a){this.aTime=e,this.aLevel=t,this.dTime=n||0,this.dLevel=o||0,this.rTime=r||0,this.rLevel=a||0,this._setRampAD(e,n)},p5.Envelope.prototype.setADSR=function(e,t,n,o){this.aTime=e,this.dTime=t||0,this.sPercent=n||0,this.dLevel="undefined"==typeof n?0:n*(this.aLevel-this.rLevel)+this.rLevel,this.rTime=o||0,this._setRampAD(e,t)},p5.Envelope.prototype.setRange=function(e,t){this.aLevel=e||1,this.rLevel=t||0},p5.Envelope.prototype._setRampAD=function(e,t){this._rampAttackTime=this.checkExpInput(e),this._rampDecayTime=this.checkExpInput(t);var n=1;n=Math.log(1/this.checkExpInput(1-this._rampHighPercentage)),this._rampAttackTC=e/this.checkExpInput(n),n=Math.log(1/this._rampLowPercentage),this._rampDecayTC=t/this.checkExpInput(n)},p5.Envelope.prototype.setRampPercentages=function(e,t){this._rampHighPercentage=this.checkExpInput(e),this._rampLowPercentage=this.checkExpInput(t);var n=1;n=Math.log(1/this.checkExpInput(1-this._rampHighPercentage)),this._rampAttackTC=this._rampAttackTime/this.checkExpInput(n),n=Math.log(1/this._rampLowPercentage),this._rampDecayTC=this._rampDecayTime/this.checkExpInput(n)},p5.Envelope.prototype.setInput=function(){for(var e=0;e<arguments.length;e++)this.connect(arguments[e])},p5.Envelope.prototype.setExp=function(e){this.isExponential=e},p5.Envelope.prototype.checkExpInput=function(e){return 0>=e&&(e=1e-8),e},p5.Envelope.prototype.play=function(e,t,n){var o=t||0;e&&this.connection!==e&&this.connect(e),this.triggerAttack(e,o),this.triggerRelease(e,o+this.aTime+this.dTime+~~n)},p5.Envelope.prototype.triggerAttack=function(e,n){var o=Un.audiocontext.currentTime,r=o+(n||0);this.lastAttack=r,this.wasTriggered=!0,e&&this.connection!==e&&this.connect(e);var a=this.control.getValueAtTime(r);!0===this.isExponential?this.control.exponentialRampToValueAtTime(this.checkExpInput(a),r):this.control.linearRampToValueAtTime(a,r),r+=this.aTime,!0===this.isExponential?(this.control.exponentialRampToValueAtTime(this.checkExpInput(this.aLevel),r),a=this.checkExpInput(this.control.getValueAtTime(r)),this.control.cancelScheduledValues(r),this.control.exponentialRampToValueAtTime(a,r)):(this.control.linearRampToValueAtTime(this.aLevel,r),a=this.control.getValueAtTime(r),this.control.cancelScheduledValues(r),this.control.linearRampToValueAtTime(a,r)),r+=this.dTime,!0===this.isExponential?(this.control.exponentialRampToValueAtTime(this.checkExpInput(this.dLevel),r),a=this.checkExpInput(this.control.getValueAtTime(r)),this.control.cancelScheduledValues(r),this.control.exponentialRampToValueAtTime(a,r)):(this.control.linearRampToValueAtTime(this.dLevel,r),a=this.control.getValueAtTime(r),this.control.cancelScheduledValues(r),this.control.linearRampToValueAtTime(a,r))},p5.Envelope.prototype.triggerRelease=function(e,n){if(this.wasTriggered){var o=Un.audiocontext.currentTime,r=o+(n||0);e&&this.connection!==e&&this.connect(e);var a=this.control.getValueAtTime(r);!0===this.isExponential?this.control.exponentialRampToValueAtTime(this.checkExpInput(a),r):this.control.linearRampToValueAtTime(a,r),r+=this.rTime,!0===this.isExponential?(this.control.exponentialRampToValueAtTime(this.checkExpInput(this.rLevel),r),a=this.checkExpInput(this.control.getValueAtTime(r)),this.control.cancelScheduledValues(r),this.control.exponentialRampToValueAtTime(a,r)):(this.control.linearRampToValueAtTime(this.rLevel,r),a=this.control.getValueAtTime(r),this.control.cancelScheduledValues(r),this.control.linearRampToValueAtTime(a,r)),this.wasTriggered=!1}},p5.Envelope.prototype.ramp=function(e,n,o,r){var a=Un.audiocontext.currentTime,i=a+(n||0),s=this.checkExpInput(o),u="undefined"==typeof r?void 0:this.checkExpInput(r);e&&this.connection!==e&&this.connect(e);var l=this.checkExpInput(this.control.getValueAtTime(i));s>l?(this.control.setTargetAtTime(s,i,this._rampAttackTC),i+=this._rampAttackTime):s<l&&(this.control.setTargetAtTime(s,i,this._rampDecayTC),i+=this._rampDecayTime);void 0===u||(u>s?this.control.setTargetAtTime(u,i,this._rampAttackTC):u<s&&this.control.setTargetAtTime(u,i,this._rampDecayTC))},p5.Envelope.prototype.connect=function(e){this.connection=e,(e instanceof p5.Oscillator||e instanceof p5.SoundFile||e instanceof p5.AudioIn||e instanceof p5.Reverb||e instanceof p5.Noise||e instanceof p5.Filter||e instanceof p5.Delay)&&(e=e.output.gain),e instanceof AudioParam&&e.setValueAtTime(0,Un.audiocontext.currentTime),this.output.connect(e)},p5.Envelope.prototype.disconnect=function(){this.output&&this.output.disconnect()},p5.Envelope.prototype.add=function(e){var t=new io.a(e),n=this.mathOps.length,o=this.output;return p5.prototype._mathChain(this,t,n,o,io.a)},p5.Envelope.prototype.mult=function(e){var t=new uo.a(e),n=this.mathOps.length,o=this.output;return p5.prototype._mathChain(this,t,n,o,uo.a)},p5.Envelope.prototype.scale=function(e,t,n,o){var r=new po.a(e,t,n,o),a=this.mathOps.length,i=this.output;return p5.prototype._mathChain(this,r,a,i,po.a)},p5.Envelope.prototype.dispose=function(){var e=Un.soundArray.indexOf(this);Un.soundArray.splice(e,1),this.disconnect(),this.control&&(this.control.dispose(),this.control=null);for(var t=1;t<this.mathOps.length;t++)this.mathOps[t].dispose()},p5.Env=function(e,t,n,o,r,a){console.warn("WARNING: p5.Env is now deprecated and may be removed in future versions. Please use the new p5.Envelope instead."),p5.Envelope.call(this,e,t,n,o,r,a)},p5.Env.prototype=Object.create(p5.Envelope.prototype);var bo=p5.Envelope,To=function(){for(var e=2*Un.audiocontext.sampleRate,t=Un.audiocontext.createBuffer(1,e,Un.audiocontext.sampleRate),n=t.getChannelData(0),o=0;o<e;o++)n[o]=2*Math.random()-1;return t.type="white",t}(),xo=function(){var e=2*Un.audiocontext.sampleRate,t=Un.audiocontext.createBuffer(1,e,Un.audiocontext.sampleRate),n=t.getChannelData(0),o,r,a,s,u,l,p;o=r=a=s=u=l=p=0;for(var c=0,d;c<e;c++)d=2*Math.random()-1,o=.99886*o+.0555179*d,r=.99332*r+.0750759*d,a=.969*a+.153852*d,s=.8665*s+.3104856*d,u=.55*u+.5329522*d,l=-.7616*l-.016898*d,n[c]=o+r+a+s+u+l+p+.5362*d,n[c]*=.11,p=.115926*d;return t.type="pink",t}(),ko=function(){for(var e=2*Un.audiocontext.sampleRate,t=Un.audiocontext.createBuffer(1,e,Un.audiocontext.sampleRate),n=t.getChannelData(0),o=0,r=0,a;r<e;r++)a=2*Math.random()-1,n[r]=(o+.02*a)/1.02,o=n[r],n[r]*=3.5;return t.type="brown",t}(),So=function(e){function t(e){var n;j(this,t),n=Z(this,Y(t).call(this));var o;return delete n.f,delete n.freq,delete n.oscillator,o="brown"===e?ko:"pink"===e?xo:To,n.buffer=o,n}return H(t,e),W(t,[{key:"setType",value:function(e){if(this.buffer="white"===e?To:"pink"===e?xo:"brown"===e?ko:To,this.started){var t=Un.audiocontext.currentTime;this.stop(t),this.start(t+.01)}}},{key:"getType",value:function(){return this.buffer.type}},{key:"start",value:function(){this.started&&this.stop(),this.noise=Un.audiocontext.createBufferSource(),this.noise.buffer=this.buffer,this.noise.loop=!0,this.noise.connect(this.output);var e=Un.audiocontext.currentTime;this.noise.start(e),this.started=!0}},{key:"stop",value:function(){var e=Un.audiocontext.currentTime;this.noise&&(this.noise.stop(e),this.started=!1)}},{key:"dispose",value:function(){var e=Un.audiocontext.currentTime,t=Un.soundArray.indexOf(this);Un.soundArray.splice(t,1),this.noise&&(this.noise.disconnect(),this.stop(e)),this.output&&this.output.disconnect(),this.panner&&this.panner.disconnect(),this.output=null,this.panner=null,this.buffer=null,this.noise=null}}]),t}(_o),Po=n(2),Ao=n.n(Po),wo=function(e){function t(e,n){var o;J(this,t),o=te(this,oe(t).call(this,e,"sawtooth")),o.w=n||0,o.osc2=new yo(e),o.dNode=Un.audiocontext.createDelay(),o.dcOffset=ie(),o.dcGain=Un.audiocontext.createGain(),o.dcOffset.connect(o.dcGain),o.dcGain.connect(o.output),o.f=e||440;var r=o.w/o.oscillator.frequency.value;return o.dNode.delayTime.value=r,o.dcGain.gain.value=1.7*(.5-o.w),o.osc2.disconnect(),o.osc2.panner.disconnect(),o.osc2.amp(-1),o.osc2.output.connect(o.dNode),o.dNode.connect(o.output),o.output.gain.value=1,o.output.connect(o.panner),o}return re(t,e),ee(t,[{key:"width",value:function(e){if("number"==typeof e){if(1>=e&&0<=e){this.w=e;var t=this.w/this.oscillator.frequency.value;this.dNode.delayTime.value=t}this.dcGain.gain.value=1.7*(.5-this.w)}else{e.connect(this.dNode.delayTime);var n=new Ao.a(-.5);e.connect(n);var o=new uo.a(-1),r=new uo.a(1.7);n=n.connect(o).connect(r),n.connect(this.dcGain.gain)}}},{key:"start",value:function(e,n){var o=Un.audiocontext.currentTime,r=n||0;if(!this.started){var t=e||this.f,a=this.oscillator.type;this.oscillator=Un.audiocontext.createOscillator(),this.oscillator.frequency.setValueAtTime(t,o),this.oscillator.type=a,this.oscillator.connect(this.output),this.oscillator.start(r+o),this.osc2.oscillator=Un.audiocontext.createOscillator(),this.osc2.oscillator.frequency.setValueAtTime(t,r+o),this.osc2.oscillator.type=a,this.osc2.oscillator.connect(this.osc2.output),this.osc2.start(r+o),this.freqNode=[this.oscillator.frequency,this.osc2.oscillator.frequency],this.dcOffset=ie(),this.dcOffset.connect(this.dcGain),this.dcOffset.start(r+o),void 0!==this.mods&&void 0!==this.mods.frequency&&(this.mods.frequency.connect(this.freqNode[0]),this.mods.frequency.connect(this.freqNode[1])),this.started=!0,this.osc2.started=!0}}},{key:"stop",value:function(e){if(this.started){var n=e||0,t=Un.audiocontext.currentTime;this.oscillator.stop(n+t),this.osc2.oscillator&&this.osc2.oscillator.stop(n+t),this.dcOffset.stop(n+t),this.started=!1,this.osc2.started=!1}}},{key:"freq",value:function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0,n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:0;if("number"==typeof e){this.f=e;var o=Un.audiocontext.currentTime,r=this.oscillator.frequency.value;this.oscillator.frequency.cancelScheduledValues(o),this.oscillator.frequency.setValueAtTime(r,o+n),this.oscillator.frequency.exponentialRampToValueAtTime(e,n+t+o),this.osc2.oscillator.frequency.cancelScheduledValues(o),this.osc2.oscillator.frequency.setValueAtTime(r,o+n),this.osc2.oscillator.frequency.exponentialRampToValueAtTime(e,n+t+o),this.freqMod&&(this.freqMod.output.disconnect(),this.freqMod=null)}else e.output&&(e.output.disconnect(),e.output.connect(this.oscillator.frequency),e.output.connect(this.osc2.oscillator.frequency),this.freqMod=e)}}]),t}(_o);Un.inputSources=[];var Co=function(){function e(t){se(this,e),this.input=Un.audiocontext.createGain(),this.output=Un.audiocontext.createGain(),this.stream=null,this.mediaStream=null,this.currentSource=null,this.enabled=!1,this.amplitude=new oo,this.output.connect(this.amplitude.input),window.MediaStreamTrack&&window.navigator.mediaDevices&&window.navigator.mediaDevices.getUserMedia||(t?t():window.alert("This browser does not support MediaStreamTrack and mediaDevices")),Un.soundArray.push(this)}return le(e,[{key:"start",value:function(e,t){var n=this;this.stream&&this.stop();var o=Un.inputSources[n.currentSource],r={audio:{sampleRate:Un.audiocontext.sampleRate,echoCancellation:!1}};Un.inputSources[this.currentSource]&&(r.audio.deviceId=o.deviceId),window.navigator.mediaDevices.getUserMedia(r).then(function(t){n.stream=t,n.enabled=!0,n.mediaStream=Un.audiocontext.createMediaStreamSource(t),n.mediaStream.connect(n.output),n.amplitude.setInput(n.output),e&&e()})["catch"](function(e){t?t(e):console.error(e)})}},{key:"stop",value:function(){this.stream&&(this.stream.getTracks().forEach(function(e){e.stop()}),this.mediaStream.disconnect(),delete this.mediaStream,delete this.stream)}},{key:"connect",value:function(e){e?e.hasOwnProperty("input")?this.output.connect(e.input):e.hasOwnProperty("analyser")?this.output.connect(e.analyser):this.output.connect(e):this.output.connect(Un.input)}},{key:"disconnect",value:function(){this.output&&(this.output.disconnect(),this.output.connect(this.amplitude.input))}},{key:"getLevel",value:function(e){return e&&(this.amplitude.smoothing=e),this.amplitude.getLevel()}},{key:"amp",value:function(e,n){if(n){var t=this.output.gain.value;this.output.gain.cancelScheduledValues(Un.audiocontext.currentTime),this.output.gain.setValueAtTime(t,Un.audiocontext.currentTime),this.output.gain.linearRampToValueAtTime(e,(n||0)+Un.audiocontext.currentTime)}else this.output.gain.cancelScheduledValues(Un.audiocontext.currentTime),this.output.gain.setValueAtTime(e,Un.audiocontext.currentTime)}},{key:"getSources",value:function(e,t){return new Promise(function(n,o){window.navigator.mediaDevices.enumerateDevices().then(function(t){Un.inputSources=t.filter(function(e){return"audioinput"===e.kind}),n(Un.inputSources),e&&e(Un.inputSources)})["catch"](function(e){o(e),t?t(e):console.error("This browser does not support MediaStreamTrack.getSources()")})})}},{key:"setSource",value:function(e){0<Un.inputSources.length&&e<Un.inputSources.length?(this.currentSource=e,console.log("set source to ",Un.inputSources[this.currentSource])):console.log("unable to set input source"),this.stream&&this.stream.active&&this.start()}},{key:"dispose",value:function(){var e=Un.soundArray.indexOf(this);Un.soundArray.splice(e,1),this.stop(),this.output&&this.output.disconnect(),this.amplitude&&this.amplitude.disconnect(),delete this.amplitude,delete this.output}}]),e}(),Oo=n(23),qo=n.n(Oo),Ro=function(){function e(){pe(this,e),this.ac=Un.audiocontext,this.input=this.ac.createGain(),this.output=this.ac.createGain(),this._drywet=new qo.a(1),this.wet=this.ac.createGain(),this.input.connect(this._drywet.a),this.wet.connect(this._drywet.b),this._drywet.connect(this.output),this.connect(),Un.soundArray.push(this)}return de(e,[{key:"amp",value:function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0,n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:0,o=Un.audiocontext.currentTime,r=o+n,a=this.output.gain.value;this.output.gain.cancelScheduledValues(o),this.output.gain.linearRampToValueAtTime(a,r+.001),this.output.gain.linearRampToValueAtTime(e,r+t+.001)}},{key:"chain",value:function(){if(0<arguments.length){this.connect(arguments[0]);for(var e=1;e<arguments.length;e+=1)arguments[e-1].connect(arguments[e])}return this}},{key:"drywet",value:function(e){return"undefined"!=typeof e&&(this._drywet.fade.value=e),this._drywet.fade.value}},{key:"connect",value:function(e){var t=e||p5.soundOut.input;this.output.connect(t.input?t.input:t)}},{key:"disconnect",value:function(){this.output&&this.output.disconnect()}},{key:"dispose",value:function(){var e=Un.soundArray.indexOf(this);Un.soundArray.splice(e,1),this.input&&(this.input.disconnect(),delete this.input),this.output&&(this.output.disconnect(),delete this.output),this._drywet&&(this._drywet.disconnect(),delete this._drywet),this.wet&&(this.wet.disconnect(),delete this.wet),this.ac=void 0}}]),e}(),No=Ro,Bo=function(e){function t(e){var n;return me(this,t),n=_e(this,Te(t).call(this)),n.biquad=n.ac.createBiquadFilter(),n.input.connect(n.biquad),n.biquad.connect(n.wet),e&&n.setType(e),n._on=!0,n._untoggledType=n.biquad.type,n}return xe(t,e),he(t,[{key:"process",value:function(e,t,n,o){e.connect(this.input),this.set(t,n,o)}},{key:"set",value:function(e,t,n){e&&this.freq(e,n),t&&this.res(t,n)}},{key:"freq",value:function(e,n){var o=n||0;return 0>=e&&(e=1),"number"==typeof e?(this.biquad.frequency.cancelScheduledValues(this.ac.currentTime+.01+o),this.biquad.frequency.exponentialRampToValueAtTime(e,this.ac.currentTime+.02+o)):e&&e.connect(this.biquad.frequency),this.biquad.frequency.value}},{key:"res",value:function(e,n){var o=n||0;return"number"==typeof e?(this.biquad.Q.value=e,this.biquad.Q.cancelScheduledValues(this.ac.currentTime+.01+o),this.biquad.Q.linearRampToValueAtTime(e,this.ac.currentTime+.02+o)):e&&e.connect(this.biquad.Q),this.biquad.Q.value}},{key:"gain",value:function(e,n){var o=n||0;return"number"==typeof e?(this.biquad.gain.value=e,this.biquad.gain.cancelScheduledValues(this.ac.currentTime+.01+o),this.biquad.gain.linearRampToValueAtTime(e,this.ac.currentTime+.02+o)):e&&e.connect(this.biquad.gain),this.biquad.gain.value}},{key:"toggle",value:function(){return this._on=!this._on,!0===this._on?this.biquad.type=this._untoggledType:!1===this._on&&(this.biquad.type="allpass"),this._on}},{key:"setType",value:function(e){this.biquad.type=e,this._untoggledType=this.biquad.type}},{key:"dispose",value:function(){ve(Te(t.prototype),"dispose",this).call(this),this.biquad&&(this.biquad.disconnect(),delete this.biquad)}}]),t}(No),Vo=function(e){function t(){return me(this,t),_e(this,Te(t).call(this,"lowpass"))}return xe(t,e),t}(Bo),Eo=function(e){function t(){return me(this,t),_e(this,Te(t).call(this,"highpass"))}return xe(t,e),t}(Bo),Fo=function(e){function t(){return me(this,t),_e(this,Te(t).call(this,"bandpass"))}return xe(t,e),t}(Bo),Do=Bo,Io=function(e){function t(e,n){var o;return Pe(this,t),o=Ce(this,qe(t).call(this,"peaking")),o.disconnect(),o.set(e,n),o.biquad.gain.value=0,delete o.input,delete o.output,delete o._drywet,delete o.wet,o}return Re(t,e),we(t,[{key:"amp",value:function(){console.warn("`amp()` is not available for p5.EQ bands. Use `.gain()`")}},{key:"drywet",value:function(){console.warn("`drywet()` is not available for p5.EQ bands.")}},{key:"connect",value:function(e){var t=e||p5.soundOut.input;this.biquad?this.biquad.connect(t.input?t.input:t):this.output.connect(t.input?t.input:t)}},{key:"disconnect",value:function(){this.biquad&&this.biquad.disconnect()}},{key:"dispose",value:function(){var e=Un.soundArray.indexOf(this);Un.soundArray.splice(e,1),this.disconnect(),delete this.biquad}}]),t}(Do),Mo=function(e){function t(e){var n;Ve(this,t),n=De(this,Ge(t).call(this)),e=3===e||8===e?e:3;var o;o=3===e?Math.pow(2,3):2,n.bands=[];for(var r=0,a,s;r<e;r++)r==e-1?(a=21e3,s=.01):0===r?(a=100,s=.1):1===r?(a=3===e?360*o:360,s=1):(a=n.bands[r-1].freq()*o,s=1),n.bands[r]=n._newBand(a,s),0<r?n.bands[r-1].connect(n.bands[r].biquad):n.input.connect(n.bands[r].biquad);return n.bands[e-1].connect(n.output),n}return Le(t,e),Fe(t,[{key:"process",value:function(e){e.connect(this.input)}},{key:"set",value:function(){if(arguments.length===2*this.bands.length)for(var e=0;e<arguments.length;e+=2)this.bands[e/2].freq(arguments[e]),this.bands[e/2].gain(arguments[e+1]);else console.error("Argument mismatch. .set() should be called with "+2*this.bands.length+" arguments. (one frequency and gain value pair for each band of the eq)")}},{key:"_newBand",value:function(e,t){return new Io(e,t)}},{key:"dispose",value:function(){if(Me(Ge(t.prototype),"dispose",this).call(this),this.bands){for(;0<this.bands.length;)delete this.bands.pop().dispose();delete this.bands}}}]),t}(No),Uo=function(){function e(){ze(this,e),this.ac=Un.audiocontext,this.listener=this.ac.listener}return Ze(e,[{key:"process",value:function(e){e.connect(this.input)}},{key:"position",value:function(e,t,n,o){return this.positionX(e,o),this.positionY(t,o),this.positionZ(n,o),[this.listener.positionX.value,this.listener.positionY.value,this.listener.positionZ.value]}},{key:"positionX",value:function(e,n){var o=n||0;return"number"==typeof e?(this.listener.positionX.value=e,this.listener.positionX.cancelScheduledValues(this.ac.currentTime+.01+o),this.listener.positionX.linearRampToValueAtTime(e,this.ac.currentTime+.02+o)):e&&e.connect(this.listener.positionX),this.listener.positionX.value}},{key:"positionY",value:function(e,n){var o=n||0;return"number"==typeof e?(this.listener.positionY.value=e,this.listener.positionY.cancelScheduledValues(this.ac.currentTime+.01+o),this.listener.positionY.linearRampToValueAtTime(e,this.ac.currentTime+.02+o)):e&&e.connect(this.listener.positionY),this.listener.positionY.value}},{key:"positionZ",value:function(e,n){var o=n||0;return"number"==typeof e?(this.listener.positionZ.value=e,this.listener.positionZ.cancelScheduledValues(this.ac.currentTime+.01+o),this.listener.positionZ.linearRampToValueAtTime(e,this.ac.currentTime+.02+o)):e&&e.connect(this.listener.positionZ),this.listener.positionZ.value}},{key:"orient",value:function(e,t,n,o,r,a,i){return 3===arguments.length||4===arguments.length?(i=arguments[3],this.orientForward(e,t,n,i)):(6===arguments.length||7===arguments)&&(this.orientForward(e,t,n),this.orientUp(o,r,a,i)),[this.listener.forwardX.value,this.listener.forwardY.value,this.listener.forwardZ.value,this.listener.upX.value,this.listener.upY.value,this.listener.upZ.value]}},{key:"orientForward",value:function(e,t,n,o){return this.forwardX(e,o),this.forwardY(t,o),this.forwardZ(n,o),[this.listener.forwardX,this.listener.forwardY,this.listener.forwardZ]}},{key:"orientUp",value:function(e,t,n,o){return this.upX(e,o),this.upY(t,o),this.upZ(n,o),[this.listener.upX,this.listener.upY,this.listener.upZ]}},{key:"forwardX",value:function(e,n){var o=n||0;return"number"==typeof e?(this.listener.forwardX.value=e,this.listener.forwardX.cancelScheduledValues(this.ac.currentTime+.01+o),this.listener.forwardX.linearRampToValueAtTime(e,this.ac.currentTime+.02+o)):e&&e.connect(this.listener.forwardX),this.listener.forwardX.value}},{key:"forwardY",value:function(e,n){var o=n||0;return"number"==typeof e?(this.listener.forwardY.value=e,this.listener.forwardY.cancelScheduledValues(this.ac.currentTime+.01+o),this.listener.forwardY.linearRampToValueAtTime(e,this.ac.currentTime+.02+o)):e&&e.connect(this.listener.forwardY),this.listener.forwardY.value}},{key:"forwardZ",value:function(e,n){var o=n||0;return"number"==typeof e?(this.listener.forwardZ.value=e,this.listener.forwardZ.cancelScheduledValues(this.ac.currentTime+.01+o),this.listener.forwardZ.linearRampToValueAtTime(e,this.ac.currentTime+.02+o)):e&&e.connect(this.listener.forwardZ),this.listener.forwardZ.value}},{key:"upX",value:function(e,n){var o=n||0;return"number"==typeof e?(this.listener.upX.value=e,this.listener.upX.cancelScheduledValues(this.ac.currentTime+.01+o),this.listener.upX.linearRampToValueAtTime(e,this.ac.currentTime+.02+o)):e&&e.connect(this.listener.upX),this.listener.upX.value}},{key:"upY",value:function(e,n){var o=n||0;return"number"==typeof e?(this.listener.upY.value=e,this.listener.upY.cancelScheduledValues(this.ac.currentTime+.01+o),this.listener.upY.linearRampToValueAtTime(e,this.ac.currentTime+.02+o)):e&&e.connect(this.listener.upY),this.listener.upY.value}},{key:"upZ",value:function(e,n){var o=n||0;return"number"==typeof e?(this.listener.upZ.value=e,this.listener.upZ.cancelScheduledValues(this.ac.currentTime+.01+o),this.listener.upZ.linearRampToValueAtTime(e,this.ac.currentTime+.02+o)):e&&e.connect(this.listener.upZ),this.listener.upZ.value}}]),e}(),Go=function(e){function t(){var e;return Ye(this,t),e=$e(this,tt(t).call(this)),e.panner=e.ac.createPanner(),e.panner.panningModel="HRTF",e.panner.distanceModel="linear",e.panner.connect(e.output),e.input.connect(e.panner),e}return nt(t,e),Qe(t,[{key:"process",value:function(e){e.connect(this.input)}},{key:"set",value:function(e,t,n,o){return this.positionX(e,o),this.positionY(t,o),this.positionZ(n,o),[this.panner.positionX.value,this.panner.positionY.value,this.panner.positionZ.value]}},{key:"positionX",value:function(e,n){var o=n||0;return"number"==typeof e?(this.panner.positionX.value=e,this.panner.positionX.cancelScheduledValues(this.ac.currentTime+.01+o),this.panner.positionX.linearRampToValueAtTime(e,this.ac.currentTime+.02+o)):e&&e.connect(this.panner.positionX),this.panner.positionX.value}},{key:"positionY",value:function(e,n){var o=n||0;return"number"==typeof e?(this.panner.positionY.value=e,this.panner.positionY.cancelScheduledValues(this.ac.currentTime+.01+o),this.panner.positionY.linearRampToValueAtTime(e,this.ac.currentTime+.02+o)):e&&e.connect(this.panner.positionY),this.panner.positionY.value}},{key:"positionZ",value:function(e,n){var o=n||0;return"number"==typeof e?(this.panner.positionZ.value=e,this.panner.positionZ.cancelScheduledValues(this.ac.currentTime+.01+o),this.panner.positionZ.linearRampToValueAtTime(e,this.ac.currentTime+.02+o)):e&&e.connect(this.panner.positionZ),this.panner.positionZ.value}},{key:"orient",value:function(e,t,n,o){return this.orientX(e,o),this.orientY(t,o),this.orientZ(n,o),[this.panner.orientationX.value,this.panner.orientationY.value,this.panner.orientationZ.value]}},{key:"orientX",value:function(e,n){var o=n||0;return"number"==typeof e?(this.panner.orientationX.value=e,this.panner.orientationX.cancelScheduledValues(this.ac.currentTime+.01+o),this.panner.orientationX.linearRampToValueAtTime(e,this.ac.currentTime+.02+o)):e&&e.connect(this.panner.orientationX),this.panner.orientationX.value}},{key:"orientY",value:function(e,n){var o=n||0;return"number"==typeof e?(this.panner.orientationY.value=e,this.panner.orientationY.cancelScheduledValues(this.ac.currentTime+.01+o),this.panner.orientationY.linearRampToValueAtTime(e,this.ac.currentTime+.02+o)):e&&e.connect(this.panner.orientationY),this.panner.orientationY.value}},{key:"orientZ",value:function(e,n){var o=n||0;return"number"==typeof e?(this.panner.orientationZ.value=e,this.panner.orientationZ.cancelScheduledValues(this.ac.currentTime+.01+o),this.panner.orientationZ.linearRampToValueAtTime(e,this.ac.currentTime+.02+o)):e&&e.connect(this.panner.orientationZ),this.panner.orientationZ.value}},{key:"setFalloff",value:function(e,t){this.maxDist(e),this.rolloff(t)}},{key:"maxDist",value:function(e){return"number"==typeof e&&(this.panner.maxDistance=e),this.panner.maxDistance}},{key:"rolloff",value:function(e){return"number"==typeof e&&(this.panner.rolloffFactor=e),this.panner.rolloffFactor}},{key:"dispose",value:function(){Ke(tt(t.prototype),"dispose",this).call(this),this.panner&&(this.panner.disconnect(),delete this.panner)}}]),t}(No),Lo=function(e){function t(){var e;return at(this,t),e=ut(this,dt(t).call(this)),e._split=e.ac.createChannelSplitter(2),e._merge=e.ac.createChannelMerger(2),e._leftGain=e.ac.createGain(),e._rightGain=e.ac.createGain(),e.leftDelay=e.ac.createDelay(),e.rightDelay=e.ac.createDelay(),e._leftFilter=new Do,e._rightFilter=new Do,e._leftFilter.disconnect(),e._rightFilter.disconnect(),e._leftFilter.biquad.frequency.setValueAtTime(1200,e.ac.currentTime),e._rightFilter.biquad.frequency.setValueAtTime(1200,e.ac.currentTime),e._leftFilter.biquad.Q.setValueAtTime(.3,e.ac.currentTime),e._rightFilter.biquad.Q.setValueAtTime(.3,e.ac.currentTime),e.input.connect(e._split),e.leftDelay.connect(e._leftGain),e.rightDelay.connect(e._rightGain),e._leftGain.connect(e._leftFilter.input),e._rightGain.connect(e._rightFilter.input),e._merge.connect(e.wet),e._leftFilter.biquad.gain.setValueAtTime(1,e.ac.currentTime),e._rightFilter.biquad.gain.setValueAtTime(1,e.ac.currentTime),e.setType(0),e._maxDelay=e.leftDelay.delayTime.maxValue,e.feedback(.5),e}return ft(t,e),st(t,[{key:"process",value:function(e,t,n,o){var r=n||0,a=t||0;if(1<=r)throw new Error("Feedback value will force a positive feedback loop.");if(a>=this._maxDelay)throw new Error("Delay Time exceeds maximum delay time of "+this._maxDelay+" second.");e.connect(this.input),this.leftDelay.delayTime.setValueAtTime(a,this.ac.currentTime),this.rightDelay.delayTime.setValueAtTime(a,this.ac.currentTime),this._leftGain.gain.value=r,this._rightGain.gain.value=r,o&&(this._leftFilter.freq(o),this._rightFilter.freq(o))}},{key:"delayTime",value:function(e){"number"==typeof e?(this.leftDelay.delayTime.cancelScheduledValues(this.ac.currentTime),this.rightDelay.delayTime.cancelScheduledValues(this.ac.currentTime),this.leftDelay.delayTime.linearRampToValueAtTime(e,this.ac.currentTime),this.rightDelay.delayTime.linearRampToValueAtTime(e,this.ac.currentTime)):(e.connect(this.leftDelay.delayTime),e.connect(this.rightDelay.delayTime))}},{key:"feedback",value:function(e){if(e&&"number"!=typeof e)e.connect(this._leftGain.gain),e.connect(this._rightGain.gain);else if(1<=e)throw new Error("Feedback value will force a positive feedback loop.");else"number"==typeof e&&(this._leftGain.gain.value=e,this._rightGain.gain.value=e);return this._leftGain.gain.value}},{key:"filter",value:function(e,t){this._leftFilter.set(e,t),this._rightFilter.set(e,t)}},{key:"setType",value:function(e){1===e&&(e="pingPong"),this._split.disconnect(),this._leftFilter.disconnect(),this._rightFilter.disconnect(),this._split.connect(this.leftDelay,0),this._split.connect(this.rightDelay,1),"pingPong"===e?(this._rightFilter.setType(this._leftFilter.biquad.type),this._leftFilter.output.connect(this._merge,0,0),this._rightFilter.output.connect(this._merge,0,1),this._leftFilter.output.connect(this.rightDelay),this._rightFilter.output.connect(this.leftDelay)):(this._leftFilter.output.connect(this._merge,0,0),this._rightFilter.output.connect(this._merge,0,1),this._leftFilter.output.connect(this.leftDelay),this._rightFilter.output.connect(this.rightDelay))}},{key:"dispose",value:function(){pt(dt(t.prototype),"dispose",this).call(this),this._split.disconnect(),this._leftFilter.dispose(),this._rightFilter.dispose(),this._merge.disconnect(),this._leftGain.disconnect(),this._rightGain.disconnect(),this.leftDelay.disconnect(),this.rightDelay.disconnect(),this._split=void 0,this._leftFilter=void 0,this._rightFilter=void 0,this._merge=void 0,this._leftGain=void 0,this._rightGain=void 0,this.leftDelay=void 0,this.rightDelay=void 0}}]),t}(No),jo=function(e){function t(){var e;return ht(this,t),e=vt(this,kt(t).call(this)),e._initConvolverNode(),e.input.gain.value=.5,e._seconds=3,e._decay=2,e._reverse=!1,e._buildImpulse(),e}return St(t,e),gt(t,[{key:"_initConvolverNode",value:function(){this.convolverNode=this.ac.createConvolver(),this.input.connect(this.convolverNode),this.convolverNode.connect(this.wet)}},{key:"_teardownConvolverNode",value:function(){this.convolverNode&&(this.convolverNode.disconnect(),delete this.convolverNode)}},{key:"_setBuffer",value:function(e){this._teardownConvolverNode(),this._initConvolverNode(),this.convolverNode.buffer=e}},{key:"process",value:function(e,t,n,o){e.connect(this.input);var r=!1;t&&(this._seconds=t,r=!0),n&&(this._decay=n),o&&(this._reverse=o),r&&this._buildImpulse()}},{key:"set",value:function(e,t,n){var o=!1;e&&(this._seconds=e,o=!0),t&&(this._decay=t),n&&(this._reverse=n),o&&this._buildImpulse()}},{key:"_buildImpulse",value:function(){var e=this.ac.sampleRate,t=e*this._seconds,o=this._decay,r=this.ac.createBuffer(2,t,e),a=r.getChannelData(0),s=r.getChannelData(1),u,l;for(l=0;l<t;l++)u=this._reverse?t-l:l,a[l]=(2*Math.random()-1)*Math.pow(1-u/t,o),s[l]=(2*Math.random()-1)*Math.pow(1-u/t,o);this._setBuffer(r)}},{key:"dispose",value:function(){Tt(kt(t.prototype),"dispose",this).call(this),this._teardownConvolverNode()}}]),t}(No),zo=function(e){function t(e,n,o){var r;return ht(this,t),r=vt(this,kt(t).call(this)),r._initConvolverNode(),r.input.gain.value=.5,e?(r.impulses=[],r._loadBuffer(e,n,o)):(r._seconds=3,r._decay=2,r._reverse=!1,r._buildImpulse()),r.impulses=[],r.set=null,r}return St(t,e),gt(t,[{key:"_loadBuffer",value:function(e,t,n){var o=p5.prototype._checkFileFormats(e),r=this,a=new Error().stack,i=Object(In.b)(),s=new XMLHttpRequest;s.open("GET",o,!0),s.responseType="arraybuffer",s.onload=function(){if(200===s.status)i.decodeAudioData(s.response,function(e){var n={},a=o.split("/");n.name=a[a.length-1],n.audioBuffer=e,r.impulses.push(n),r._setBuffer(n.audioBuffer),t&&t(n)},function(){var e=new jn("decodeAudioData",a,r.url),t="AudioContext error at decodeAudioData for "+r.url;n?(e.msg=t,n(e)):console.error(t+"\n The error stack trace includes: \n"+e.stack)});else{var e=new jn("loadConvolver",a,r.url),u="Unable to load "+r.url+". The request status was: "+s.status+" ("+s.statusText+")";n?(e.message=u,n(e)):console.error(u+"\n The error stack trace includes: \n"+e.stack)}},s.onerror=function(){var e=new jn("loadConvolver",a,r.url),t="There was no response from the server at "+r.url+". Check the url and internet connectivity.";n?(e.message=t,n(e)):console.error(t+"\n The error stack trace includes: \n"+e.stack)},s.send()}},{key:"process",value:function(e){e.connect(this.input)}},{key:"addImpulse",value:function(e,t,n){-1<window.location.origin.indexOf("file://")&&"undefined"===window.cordova&&alert("This sketch may require a server to load external files. Please see http://bit.ly/1qcInwS"),this._loadBuffer(e,t,n)}},{key:"resetImpulse",value:function(e,t,n){-1<window.location.origin.indexOf("file://")&&"undefined"===window.cordova&&alert("This sketch may require a server to load external files. Please see http://bit.ly/1qcInwS"),this.impulses=[],this._loadBuffer(e,t,n)}},{key:"toggleImpulse",value:function(e){if("number"==typeof e&&e<this.impulses.length&&this._setBuffer(this.impulses[e].audioBuffer),"string"==typeof e)for(var t=0;t<this.impulses.length;t++)if(this.impulses[t].name===e){this._setBuffer(this.impulses[t].audioBuffer);break}}},{key:"dispose",value:function(){for(var e in Tt(kt(t.prototype),"dispose",this).call(this),this.impulses)this.impulses[e]&&(this.impulses[e]=null)}}]),t}(jo),Wo=n(11),Zo=n.n(Wo),Xo=function(){function e(){At(this,e),this.clock=new Zo.a({callback:this.ontick.bind(this)}),this.syncedParts=[],this.bpm=120,this._init(),this.prevTick=0,this.tatumTime=0,this.tickCallback=function(){}}return Ct(e,[{key:"ontick",value:function(e){var t=e-this.prevTick,n=e-Un.audiocontext.currentTime;if(!(-.02>=t-this.tatumTime)){this.prevTick=e;var o=this;this.syncedParts.forEach(function(e){e.isPlaying&&(e.incrementStep(n),e.phrases.forEach(function(e){var t=e.sequence,r=o.metroTicks%t.length;0!==t[r]&&(o.metroTicks<t.length||!e.looping)&&e.callback(n,t[r])}))}),this.metroTicks+=1,this.tickCallback(n)}}},{key:"setBPM",value:function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0,n=60/(e*this.tatums),o=Un.audiocontext.currentTime;this.tatumTime=n,this.clock.frequency.setValueAtTime(this.clock.frequency.value,o),this.clock.frequency.linearRampToValueAtTime(e,o+t),this.bpm=e}},{key:"getBPM",value:function(){return 60*(this.clock.getRate()/this.tatums)}},{key:"_init",value:function(){this.metroTicks=0}},{key:"resetSync",value:function(e){this.syncedParts=[e]}},{key:"pushSync",value:function(e){this.syncedParts.push(e)}},{key:"start",value:function(e){var t=Un.audiocontext.currentTime;this.clock.start(t+(e||0)),this.setBPM(this.bpm)}},{key:"stop",value:function(e){var t=Un.audiocontext.currentTime;this.clock.stop(t+(e||0))}},{key:"beatLength",value:function(e){this.tatums=1/e/4}}]),e}(),Yo=Xo,Ho=120;p5.prototype.setBPM=function(e,t){for(var n in Ho=e,Un.parts)Un.parts[n]&&Un.parts[n].setBPM(e,t)};var Qo=function e(t,n,o){Rt(this,e),this.phraseStep=0,this.name=t,this.callback=n,this.sequence=o},$o=function(){function e(t,n){Rt(this,e),this.length=t||0,this.partStep=0,this.phrases=[],this.isPlaying=!1,this.noLoop(),this.tatums=n||.0625,this.metro=new Yo,this.metro._init(),this.metro.beatLength(this.tatums),this.metro.setBPM(Ho),Un.parts.push(this),this.callback=function(){}}return qt(e,[{key:"setBPM",value:function(e,t){this.metro.setBPM(e,t)}},{key:"getBPM",value:function(){return this.metro.getBPM()}},{key:"start",value:function(e){if(!this.isPlaying){this.isPlaying=!0,this.metro.resetSync(this);this.metro.start(e||0)}}},{key:"loop",value:function(e){this.looping=!0,this.onended=function(){this.partStep=0};this.start(e||0)}},{key:"noLoop",value:function(){this.looping=!1,this.onended=function(){this.stop()}}},{key:"stop",value:function(e){this.partStep=0,this.pause(e)}},{key:"pause",value:function(e){this.isPlaying=!1;this.metro.stop(e||0)}},{key:"addPhrase",value:function(e,t,n){var o;if(3===arguments.length)o=new Qo(e,t,n);else if(arguments[0]instanceof Qo)o=arguments[0];else throw"invalid input. addPhrase accepts name, callback, array or a p5.Phrase";this.phrases.push(o),o.sequence.length>this.length&&(this.length=o.sequence.length)}},{key:"removePhrase",value:function(e){for(var t in this.phrases)this.phrases[t].name===e&&this.phrases.splice(t,1)}},{key:"getPhrase",value:function(e){for(var t in this.phrases)if(this.phrases[t].name===e)return this.phrases[t]}},{key:"replaceSequence",value:function(e,t){for(var n in this.phrases)this.phrases[n].name===e&&(this.phrases[n].sequence=t)}},{key:"incrementStep",value:function(e){this.partStep<this.length-1?(this.callback(e),this.partStep+=1):!this.looping&&this.partStep===this.length-1&&this.onended()}},{key:"onStep",value:function(e){this.callback=e}}]),e}(),Jo=function(){function e(){Rt(this,e),this.parts=[],this.currentPart=Array(arguments.length);var t=this;for(var n in arguments)this.parts[n]=arguments[n],this.parts[n].nextPart=this.parts[n+1],this.parts[n].onended=function(){t.resetPart(n),Nt(t)};this.looping=!1}return qt(e,[{key:"onended",value:function(){this.looping?this.parts[0].start():this.parts[this.parts.length-1].onended=function(){this.stop(),this.resetParts()},this.currentPart=0}},{key:"start",value:function(){this.parts[this.currentPart].start(),this.scoreStep=0}},{key:"stop",value:function(){this.parts[this.currentPart].stop(),this.currentPart=0,this.scoreStep=0}},{key:"pause",value:function(){this.parts[this.currentPart].stop()}},{key:"loop",value:function(){this.looping=!0,this.start()}},{key:"noLoop",value:function(){this.looping=!1}},{key:"resetParts",value:function(){var e=this;this.parts.forEach(function(t){e.resetParts[t]})}},{key:"resetPart",value:function(e){for(var t in this.parts[e].stop(),this.parts[e].partStep=0,this.parts[e].phrases)this.parts[e]&&(this.parts[e].phrases[t].phraseStep=0)}},{key:"setBPM",value:function(e,t){for(var n in this.parts)this.parts[n]&&this.parts[n].setBPM(e,t)}}]),e}(),Ko=function(){function e(t,n){Bt(this,e),Object.defineProperty(this,"bpm",{get:function(){return this._bpm},set:function(e){this.musicalTimeMode||console.warn("Changing the BPM in \"seconds\" mode has no effect. BPM is only relevant in musicalTimeMode when the interval is specified as a string (\"2n\", \"4n\", \"1m\"...etc)"),this._bpm=e,this._update()}}),Object.defineProperty(this,"timeSignature",{get:function(){return this._timeSignature},set:function(e){this.musicalTimeMode||console.warn("Changing the timeSignature in \"seconds\" mode has no effect. BPM is only relevant in musicalTimeMode when the interval is specified as a string (\"2n\", \"4n\", \"1m\"...etc)"),this._timeSignature=e,this._update()}}),Object.defineProperty(this,"interval",{get:function(){return this._interval},set:function(e){this.musicalTimeMode="number"!=typeof e,this._interval=e,this._update()}}),Object.defineProperty(this,"iterations",{get:function(){return this.clock.ticks}}),this.callback=t,this.musicalTimeMode="number"!=typeof this._interval,this._interval=n||1,this._timeSignature=4,this._bpm=60,this.isPlaying=!1,this.maxIterations=1/0;var o=this;this.clock=new Zo.a({callback:function(e){var t=e-Un.audiocontext.currentTime;0<t&&o.iterations<=o.maxIterations&&o.callback(t)},frequency:this._calcFreq()})}return Et(e,[{key:"start",value:function(e){var t=Un.audiocontext.currentTime;this.isPlaying||(this.clock.start(t+(e||0)),this.isPlaying=!0)}},{key:"stop",value:function(e){var t=Un.audiocontext.currentTime;this.isPlaying&&(this.clock.stop(t+(e||0)),this.isPlaying=!1)}},{key:"pause",value:function(e){var t=Un.audiocontext.currentTime;this.isPlaying&&(this.clock.pause(t+(e||0)),this.isPlaying=!1)}},{key:"syncedStart",value:function(e,n){var o=n||0,t=Un.audiocontext.currentTime;if(!e.isPlaying)e.clock.start(t+o),e.isPlaying=!0,this.clock.start(t+o),this.isPlaying=!0;else if(e.isPlaying){var r=e.clock._nextTick-Un.audiocontext.currentTime;this.clock.start(t+r),this.isPlaying=!0}}},{key:"_update",value:function(){this.clock.frequency.value=this._calcFreq()}},{key:"_calcFreq",value:function(){return"number"==typeof this._interval?(this.musicalTimeMode=!1,1/this._interval):"string"==typeof this._interval?(this.musicalTimeMode=!0,this._bpm/60/this._convertNotation(this._interval)*(this._timeSignature/4)):void 0}},{key:"_convertNotation",value:function(e){var t=e.slice(-1);switch(e=+e.slice(0,-1),t){case"m":return this._measure(e);case"n":return this._note(e);default:console.warn("Specified interval is not formatted correctly. See Tone.js timing reference for more info: https://github.com/Tonejs/Tone.js/wiki/Time");}}},{key:"_measure",value:function(e){return e*this._timeSignature}},{key:"_note",value:function(e){return this._timeSignature/e}}]),e}(),er=function(e){function t(){var e;return Dt(this,t),e=Ut(this,zt(t).call(this)),e.compressor=e.ac.createDynamicsCompressor(),e.input.connect(e.compressor),e.compressor.connect(e.wet),e}return Wt(t,e),Mt(t,[{key:"process",value:function(e,t,n,o,r,a){e.connect(this.input),this.set(t,n,o,r,a)}},{key:"set",value:function(e,t,n,o,r){"undefined"!=typeof e&&this.attack(e),"undefined"!=typeof t&&this.knee(t),"undefined"!=typeof n&&this.ratio(n),"undefined"!=typeof o&&this.threshold(o),"undefined"!=typeof r&&this.release(r)}},{key:"attack",value:function(e,n){var o=n||0;return"number"==typeof e?(this.compressor.attack.value=e,this.compressor.attack.cancelScheduledValues(this.ac.currentTime+.01+o),this.compressor.attack.linearRampToValueAtTime(e,this.ac.currentTime+.02+o)):"undefined"!=typeof e&&e.connect(this.compressor.attack),this.compressor.attack.value}},{key:"knee",value:function(e,n){var o=n||0;return"number"==typeof e?(this.compressor.knee.value=e,this.compressor.knee.cancelScheduledValues(this.ac.currentTime+.01+o),this.compressor.knee.linearRampToValueAtTime(e,this.ac.currentTime+.02+o)):"undefined"!=typeof e&&e.connect(this.compressor.knee),this.compressor.knee.value}},{key:"ratio",value:function(e,n){var o=n||0;return"number"==typeof e?(this.compressor.ratio.value=e,this.compressor.ratio.cancelScheduledValues(this.ac.currentTime+.01+o),this.compressor.ratio.linearRampToValueAtTime(e,this.ac.currentTime+.02+o)):"undefined"!=typeof e&&e.connect(this.compressor.ratio),this.compressor.ratio.value}},{key:"threshold",value:function(e,n){var o=n||0;return"number"==typeof e?(this.compressor.threshold.value=e,this.compressor.threshold.cancelScheduledValues(this.ac.currentTime+.01+o),this.compressor.threshold.linearRampToValueAtTime(e,this.ac.currentTime+.02+o)):"undefined"!=typeof e&&e.connect(this.compressor.threshold),this.compressor.threshold.value}},{key:"release",value:function(e,n){var o=n||0;return"number"==typeof e?(this.compressor.release.value=e,this.compressor.release.cancelScheduledValues(this.ac.currentTime+.01+o),this.compressor.release.linearRampToValueAtTime(e,this.ac.currentTime+.02+o)):"undefined"!=typeof number&&e.connect(this.compressor.release),this.compressor.release.value}},{key:"reduction",value:function(){return this.compressor.reduction.value}},{key:"dispose",value:function(){Lt(zt(t.prototype),"dispose",this).call(this),this.compressor&&(this.compressor.disconnect(),delete this.compressor)}}]),t}(No),tr=function(){function e(t,n,o,r){Xt(this,e),this.framesPerPeak=r||20,this.framesSinceLastPeak=0,this.decayRate=.95,this.threshold=o||.35,this.cutoff=0,this.cutoffMult=1.5,this.energy=0,this.penergy=0,this.currentValue=0,this.isDetected=!1,this.f1=t||40,this.f2=n||2e4,this._onPeak=function(){}}return Ht(e,[{key:"update",value:function(e){var t=this.energy=e.getEnergy(this.f1,this.f2)/255;t>this.cutoff&&t>this.threshold&&0<t-this.penergy?(this._onPeak(),this.isDetected=!0,this.cutoff=t*this.cutoffMult,this.framesSinceLastPeak=0):(this.isDetected=!1,this.framesSinceLastPeak<=this.framesPerPeak?this.framesSinceLastPeak++:(this.cutoff*=this.decayRate,this.cutoff=Math.max(this.cutoff,this.threshold))),this.currentValue=t,this.penergy=t}},{key:"onPeak",value:function(e,t){var n=this;n._onPeak=function(){e(n.energy,t)}}}]),e}(),nr=tr,or=Un.audiocontext,rr=function(){function e(){Qt(this,e),this.input=or.createGain(),this.output=or.createGain(),this._inputChannels=2,this._outputChannels=2;var t=this.bufferSize=d(1024);this._workletNode=new AudioWorkletNode(or,Ln.a.recorderProcessor,{outputChannelCount:[this._outputChannels],processorOptions:{numInputChannels:this._inputChannels,bufferSize:t}}),this._workletNode.port.onmessage=function(e){if("buffers"===e.data.name){var t=[new Float32Array(e.data.leftBuffer),new Float32Array(e.data.rightBuffer)];this._callback(t)}}.bind(this),this._callback=function(){},this._workletNode.connect(p5.soundOut._silentNode),this.setInput(),Un.soundArray.push(this)}return Jt(e,[{key:"setInput",value:function(e){this.input.disconnect(),this.input=null,this.input=or.createGain(),this.input.connect(this._workletNode),this.input.connect(this.output),e?e.connect(this.input):p5.soundOut.output.connect(this.input)}},{key:"record",value:function(e,t,n){this._workletNode.port.postMessage({name:"start",duration:t}),e&&n?this._callback=function(t){e.setBuffer(t),n()}:e&&(this._callback=function(t){e.setBuffer(t)})}},{key:"stop",value:function(){this._workletNode.port.postMessage({name:"stop"})}},{key:"dispose",value:function(){var e=Un.soundArray.indexOf(this);Un.soundArray.splice(e,1),this._callback=function(){},this.input&&this.input.disconnect(),this.input=null,this._workletNode=null}}]),e}(),ar=function(e){function t(e,n){var o;if(en(this,t),o=on(this,un(t).call(this)),"undefined"==typeof e&&(e=.25),"number"!=typeof e)throw new Error("amount must be a number");if("undefined"==typeof n&&(n="2x"),"string"!=typeof n)throw new Error("oversample must be a String");var r=p5.prototype.map(e,0,1,0,2e3);return o.waveShaperNode=o.ac.createWaveShaper(),o.amount=r,o.waveShaperNode.curve=cn(r),o.waveShaperNode.oversample=n,o.input.connect(o.waveShaperNode),o.waveShaperNode.connect(o.wet),o}return ln(t,e),nn(t,[{key:"process",value:function(e,t,n){e.connect(this.input),this.set(t,n)}},{key:"set",value:function(e,t){if(e){var n=p5.prototype.map(e,0,1,0,2e3);this.amount=n,this.waveShaperNode.curve=cn(n)}t&&(this.waveShaperNode.oversample=t)}},{key:"getAmount",value:function(){return this.amount}},{key:"getOversample",value:function(){return this.waveShaperNode.oversample}},{key:"dispose",value:function(){an(un(t.prototype),"dispose",this).call(this),this.waveShaperNode&&(this.waveShaperNode.disconnect(),this.waveShaperNode=null)}}]),t}(No),ir=function(){function e(){dn(this,e),this.ac=Un.audiocontext,this.input=this.ac.createGain(),this.output=this.ac.createGain(),this.input.gain.value=.5,this.input.connect(this.output),Un.soundArray.push(this)}return mn(e,[{key:"setInput",value:function(e){e.connect(this.input)}},{key:"connect",value:function(e){var t=e||p5.soundOut.input;this.output.connect(t.input?t.input:t)}},{key:"disconnect",value:function(){this.output&&this.output.disconnect()}},{key:"amp",value:function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0,n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:0,o=Un.audiocontext.currentTime,r=this.output.gain.value;this.output.gain.cancelScheduledValues(o),this.output.gain.linearRampToValueAtTime(r,o+n),this.output.gain.linearRampToValueAtTime(e,o+n+t)}},{key:"dispose",value:function(){var e=Un.soundArray.indexOf(this);Un.soundArray.splice(e,1),this.output&&(this.output.disconnect(),delete this.output),this.input&&(this.input.disconnect(),delete this.input)}}]),e}(),sr=function(){function e(){yn(this,e),this.ac=Un.audiocontext,this.output=this.ac.createGain(),this.connect(),Un.soundArray.push(this)}return _n(e,[{key:"play",value:function(){}},{key:"triggerAttack",value:function(){}},{key:"triggerRelease",value:function(){}},{key:"amp",value:function(){}},{key:"connect",value:function(e){var t=e||Un.input;this.output.connect(t.input?t.input:t)}},{key:"disconnect",value:function(){this.output.disconnect()}},{key:"dispose",value:function(){this.output&&(this.output.disconnect(),delete this.output)}}]),e}(),ur=sr,lr=function(e){function t(){var e;return vn(this,t),e=xn(this,An(t).call(this)),e.oscillator=new _o,e.env=new bo,e.env.setRange(1,0),e.env.setExp(!0),e.setADSR(.02,.25,.05,.35),e.oscillator.disconnect(),e.oscillator.connect(e.output),e.env.disconnect(),e.env.setInput(e.output.gain),e.oscillator.output.gain.value=1,e.oscillator.start(),e.connect(),Un.soundArray.push(kn(e)),Object.defineProperties(kn(e),{attack:{get:function(){return this.env.aTime},set:function(e){this.env.setADSR(e,this.env.dTime,this.env.sPercent,this.env.rTime)}},decay:{get:function(){return this.env.dTime},set:function(e){this.env.setADSR(this.env.aTime,e,this.env.sPercent,this.env.rTime)}},sustain:{get:function(){return this.env.sPercent},set:function(e){this.env.setADSR(this.env.aTime,this.env.dTime,e,this.env.rTime)}},release:{get:function(){return this.env.rTime},set:function(e){this.env.setADSR(this.env.aTime,this.env.dTime,this.env.sPercent,e)}}}),e}return wn(t,e),Tn(t,[{key:"play",value:function(e,t,n,o){this.triggerAttack(e,t,~~n),this.triggerRelease(~~n+(o||.15))}},{key:"triggerAttack",value:function(e,t){var n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:0,o=s(e);this.oscillator.freq(o,0,n),this.env.ramp(this.output.gain,n,t||.1)}},{key:"triggerRelease",value:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:0;this.env.ramp(this.output.gain,e,0)}},{key:"setADSR",value:function(e,t,n,o){this.env.setADSR(e,t,n,o)}},{key:"amp",value:function(e,t){return"undefined"!=typeof e&&this.oscillator.amp(e,t||0),this.oscillator.amp().value}},{key:"connect",value:function(e){var t=e||Un.input;this.output.connect(t.input?t.input:t)}},{key:"disconnect",value:function(){this.output&&this.output.disconnect()}},{key:"dispose",value:function(){Sn(An(t.prototype),"dispose",this).call(this),this.env&&this.env.dispose(),this.oscillator&&this.oscillator.dispose()}}]),t}(ur),pr=function(){function e(t,n,o,r){On(this,e),this.isDetected=!1,this.freqLow=t,this.freqHigh=n,this.treshold=o,this.energy=0,this.penergy=0,this.sensitivity=500,this.callback=r}return Rn(e,[{key:"update",value:function(e,t){if(this.energy=e.getEnergy(this.freqLow,this.freqHigh)/255,!1===this.isDetected&&this.energy-this.penergy>this.treshold){this.isDetected=!0,this.callback?this.callback(this.energy):t&&t(this.energy);var n=this;setTimeout(function(){n.isDetected=!1},this.sensitivity)}this.penergy=this.energy}}]),e}(),cr=function(){function e(t,n){Nn(this,e),this.audiovoices=[],this.notes={},this._newest=0,this._oldest=0,this.maxVoices=n||8,this.AudioVoice=void 0===t?p5.MonoSynth:t,this._voicesInUse=new vo.a(0),this.output=Un.audiocontext.createGain(),this.connect(),this._allocateVoices(),Un.soundArray.push(this)}return Vn(e,[{key:"_allocateVoices",value:function(){for(var e=0;e<this.maxVoices;e++)this.audiovoices.push(new this.AudioVoice),this.audiovoices[e].disconnect(),this.audiovoices[e].connect(this.output)}},{key:"play",value:function(e,t,n){var o=3<arguments.length&&void 0!==arguments[3]?arguments[3]:1;this.noteAttack(e,t,n),this.noteRelease(e,n+o)}},{key:"noteADSR",value:function(e,t,n,o,a){var r=5<arguments.length&&void 0!==arguments[5]?arguments[5]:0,i=Un.audiocontext.currentTime;this.audiovoices[this.notes[e].getValueAtTime(i+r)].setADSR(t,n,o,a)}},{key:"setADSR",value:function(e,t,n,o){this.audiovoices.forEach(function(r){r.setADSR(e,t,n,o)})}},{key:"noteAttack",value:function(e,t){var n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:0,o=Un.audiocontext.currentTime+n,r=s(e),i=t||.1,u;this.notes[r]&&null!==this.notes[r].getValueAtTime(o)&&this.noteRelease(r,0),this._voicesInUse.getValueAtTime(o)<this.maxVoices?u=Math.max(~~this._voicesInUse.getValueAtTime(o),0):(u=this._oldest,oldestNote=a(this.audiovoices[this._oldest].oscillator.freq().value),this.noteRelease(oldestNote),this._oldest=(this._oldest+1)%(this.maxVoices-1)),this.notes[r]=new vo.a,this.notes[r].setValueAtTime(u,o);var l=null===this._voicesInUse._searchBefore(o)?0:this._voicesInUse._searchBefore(o).value;if(this._voicesInUse.setValueAtTime(l+1,o),this._updateAfter(o,1),this._newest=u,"number"==typeof i){var p=2*(1/this._voicesInUse.getValueAtTime(o));i=i>p?p:i}this.audiovoices[u].triggerAttack(r,i,n)}},{key:"_updateAfter",value:function(e,t){if(null!==this._voicesInUse._searchAfter(e)){this._voicesInUse._searchAfter(e).value+=t;var n=this._voicesInUse._searchAfter(e).time;this._updateAfter(n,t)}}},{key:"noteRelease",value:function(e,o){var r=Un.audiocontext.currentTime,a=o||0,i=r+a;if(!e){for(var t in this.audiovoices.forEach(function(e){e.triggerRelease(a)}),this._voicesInUse.setValueAtTime(0,i),this.notes)this.notes[t].dispose(),delete this.notes[t];return}var n=s(e);if(!this.notes[n]||null===this.notes[n].getValueAtTime(i))console.warn("Cannot release a note that is not already playing");else{var u=Math.max(~~this._voicesInUse.getValueAtTime(i).value,1);this._voicesInUse.setValueAtTime(u-1,i),0<u&&this._updateAfter(i,-1),this.audiovoices[this.notes[n].getValueAtTime(i)].triggerRelease(a),this.notes[n].dispose(),delete this.notes[n],this._newest=0===this._newest?0:(this._newest-1)%(this.maxVoices-1)}}},{key:"connect",value:function(e){var t=e||Un.input;this.output.connect(t.input?t.input:t)}},{key:"disconnect",value:function(){this.output&&this.output.disconnect()}},{key:"dispose",value:function(){this.audiovoices.forEach(function(e){e.dispose()}),this.output&&(this.output.disconnect(),delete this.output)}}]),e}();p5.prototype.getAudioContext=In.b,p5.prototype.userStartAudio=In.c,p5.prototype.sampleRate=function(){return Un.audiocontext.sampleRate},p5.prototype.freqToMidi=a,p5.prototype.midiToFreq=i,p5.prototype.noteToFreq=s,p5.prototype.soundFormats=function(){Un.extensions=[];for(var e=0;e<arguments.length;e++)if(arguments[e]=arguments[e].toLowerCase(),-1<["mp3","wav","ogg","m4a","aac"].indexOf(arguments[e]))Un.extensions.push(arguments[e]);else throw arguments[e]+" is not a valid sound format!"},p5.prototype.disposeSound=function(){for(var e=0;e<Un.soundArray.length;e++)Un.soundArray[e].dispose()},p5.prototype._checkFileFormats=u,p5.prototype._mathChain=function(e,t,n,o,r){for(var a in e.mathOps)e.mathOps[a]instanceof r&&(e.mathOps[a].dispose(),n=a,n<e.mathOps.length-1&&(o=e.mathOps[a+1]));return e.mathOps[n-1].disconnect(),e.mathOps[n-1].connect(t),t.connect(o),e.mathOps[n]=t,e},p5.prototype.convertToWav=l,p5.prototype.interleave=p,p5.prototype.writeUTFBytes=c,p5.prototype.safeBufferSize=d,p5.prototype.saveSound=function(e,t){var n=l(e.buffer);p5.prototype.writeFile([n],t,"wav")},p5.prototype.registerMethod("remove",p5.prototype.disposeSound),p5.Panner=$n,p5.SoundFile=to,p5.prototype.loadSound=function(e,t,n,o){-1<window.location.origin.indexOf("file://")&&"undefined"===window.cordova&&window.alert("This sketch may require a server to load external files. Please see http://bit.ly/1qcInwS");var r=this,a=new to(e,function(){"function"==typeof t&&t.apply(r,arguments),"function"==typeof r._decrementPreload&&r._decrementPreload()},n,o);return a},p5.prototype.registerPreloadMethod("loadSound",p5.prototype),p5.Amplitude=oo,p5.FFT=ro,p5.Oscillator=_o,p5.SinOsc=fo,p5.TriOsc=mo,p5.SawOsc=yo,p5.SqrOsc=ho,p5.Noise=So,p5.Pulse=wo,p5.AudioIn=Co,p5.Effect=No,p5.Filter=Do,p5.LowPass=Vo,p5.HighPass=Eo,p5.BandPass=Fo,p5.EQ=Mo,p5.listener3D=Uo,p5.Panner3D=Go,p5.Delay=Lo,p5.Reverb=jo,p5.Convolver=zo,p5.prototype.createConvolver=function(e,t,n){-1<window.location.origin.indexOf("file://")&&"undefined"===window.cordova&&alert("This sketch may require a server to load external files. Please see http://bit.ly/1qcInwS");var o=this,r=new zo(e,function(e){"function"==typeof t&&t(e),"function"==typeof o._decrementPreload&&o._decrementPreload()},n);return r.impulses=[],r},p5.prototype.registerPreloadMethod("createConvolver",p5.prototype),p5.Metro=Yo,p5.Phrase=Qo,p5.Part=$o,p5.Score=Jo,p5.SoundLoop=Ko,p5.Compressor=er,p5.peakDetect=nr,p5.SoundRecorder=rr,p5.Distortion=ar,p5.Gain=ir,p5.AudioVoice=ur,p5.MonoSynth=lr,p5.OnsetDetect=pr,p5.PolySynth=cr,p5.PeakDetect=nr,p5.Signal=function e(){En(this,e),console.warn("p5.Signal is deprecated , Use Tone.js Signal instead ")}}]);